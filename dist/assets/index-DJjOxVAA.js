function xk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var f4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function t2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _5={exports:{}},vm={},v5={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ad=Symbol.for("react.element"),Nk=Symbol.for("react.portal"),Dk=Symbol.for("react.fragment"),Ok=Symbol.for("react.strict_mode"),Mk=Symbol.for("react.profiler"),Lk=Symbol.for("react.provider"),bk=Symbol.for("react.context"),Fk=Symbol.for("react.forward_ref"),Vk=Symbol.for("react.suspense"),Uk=Symbol.for("react.memo"),zk=Symbol.for("react.lazy"),p4=Symbol.iterator;function Bk(t){return t===null||typeof t!="object"?null:(t=p4&&t[p4]||t["@@iterator"],typeof t=="function"?t:null)}var y5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w5=Object.assign,E5={};function Yu(t,e,n){this.props=t,this.context=e,this.refs=E5,this.updater=n||y5}Yu.prototype.isReactComponent={};Yu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function S5(){}S5.prototype=Yu.prototype;function n2(t,e,n){this.props=t,this.context=e,this.refs=E5,this.updater=n||y5}var r2=n2.prototype=new S5;r2.constructor=n2;w5(r2,Yu.prototype);r2.isPureReactComponent=!0;var g4=Array.isArray,T5=Object.prototype.hasOwnProperty,i2={current:null},C5={key:!0,ref:!0,__self:!0,__source:!0};function I5(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)T5.call(e,r)&&!C5.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var c=Array(u),h=0;h<u;h++)c[h]=arguments[h+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Ad,type:t,key:s,ref:o,props:i,_owner:i2.current}}function jk(t,e){return{$$typeof:Ad,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function s2(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ad}function Gk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var m4=/\/+/g;function av(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Gk(""+t.key):e.toString(36)}function Vp(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ad:case Nk:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+av(o,0):r,g4(i)?(n="",t!=null&&(n=t.replace(m4,"$&/")+"/"),Vp(i,e,n,"",function(h){return h})):i!=null&&(s2(i)&&(i=jk(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(m4,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",g4(t))for(var u=0;u<t.length;u++){s=t[u];var c=r+av(s,u);o+=Vp(s,e,n,c,i)}else if(c=Bk(t),typeof c=="function")for(t=c.call(t),u=0;!(s=t.next()).done;)s=s.value,c=r+av(s,u++),o+=Vp(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ap(t,e,n){if(t==null)return t;var r=[],i=0;return Vp(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Wk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pr={current:null},Up={transition:null},Hk={ReactCurrentDispatcher:pr,ReactCurrentBatchConfig:Up,ReactCurrentOwner:i2};function P5(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:ap,forEach:function(t,e,n){ap(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ap(t,function(){e++}),e},toArray:function(t){return ap(t,function(e){return e})||[]},only:function(t){if(!s2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};We.Component=Yu;We.Fragment=Dk;We.Profiler=Mk;We.PureComponent=n2;We.StrictMode=Ok;We.Suspense=Vk;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hk;We.act=P5;We.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=w5({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=i2.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)T5.call(e,c)&&!C5.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:Ad,type:t.type,key:i,ref:s,props:r,_owner:o}};We.createContext=function(t){return t={$$typeof:bk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Lk,_context:t},t.Consumer=t};We.createElement=I5;We.createFactory=function(t){var e=I5.bind(null,t);return e.type=t,e};We.createRef=function(){return{current:null}};We.forwardRef=function(t){return{$$typeof:Fk,render:t}};We.isValidElement=s2;We.lazy=function(t){return{$$typeof:zk,_payload:{_status:-1,_result:t},_init:Wk}};We.memo=function(t,e){return{$$typeof:Uk,type:t,compare:e===void 0?null:e}};We.startTransition=function(t){var e=Up.transition;Up.transition={};try{t()}finally{Up.transition=e}};We.unstable_act=P5;We.useCallback=function(t,e){return pr.current.useCallback(t,e)};We.useContext=function(t){return pr.current.useContext(t)};We.useDebugValue=function(){};We.useDeferredValue=function(t){return pr.current.useDeferredValue(t)};We.useEffect=function(t,e){return pr.current.useEffect(t,e)};We.useId=function(){return pr.current.useId()};We.useImperativeHandle=function(t,e,n){return pr.current.useImperativeHandle(t,e,n)};We.useInsertionEffect=function(t,e){return pr.current.useInsertionEffect(t,e)};We.useLayoutEffect=function(t,e){return pr.current.useLayoutEffect(t,e)};We.useMemo=function(t,e){return pr.current.useMemo(t,e)};We.useReducer=function(t,e,n){return pr.current.useReducer(t,e,n)};We.useRef=function(t){return pr.current.useRef(t)};We.useState=function(t){return pr.current.useState(t)};We.useSyncExternalStore=function(t,e,n){return pr.current.useSyncExternalStore(t,e,n)};We.useTransition=function(){return pr.current.useTransition()};We.version="18.3.1";v5.exports=We;var X=v5.exports;const Ln=t2(X),$k=xk({__proto__:null,default:Ln},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qk=X,Kk=Symbol.for("react.element"),Qk=Symbol.for("react.fragment"),Yk=Object.prototype.hasOwnProperty,Xk=qk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jk={key:!0,ref:!0,__self:!0,__source:!0};function R5(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Yk.call(e,r)&&!Jk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Kk,type:t,key:s,ref:o,props:i,_owner:Xk.current}}vm.Fragment=Qk;vm.jsx=R5;vm.jsxs=R5;_5.exports=vm;var K=_5.exports,uy={},k5={exports:{}},Ur={},A5={exports:{}},x5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(J,ue){var te=J.length;J.push(ue);e:for(;0<te;){var le=te-1>>>1,_e=J[le];if(0<i(_e,ue))J[le]=ue,J[te]=_e,te=le;else break e}}function n(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var ue=J[0],te=J.pop();if(te!==ue){J[0]=te;e:for(var le=0,_e=J.length,Ce=_e>>>1;le<Ce;){var Le=2*(le+1)-1,yt=J[Le],ut=Le+1,B=J[ut];if(0>i(yt,te))ut<_e&&0>i(B,yt)?(J[le]=B,J[ut]=te,le=ut):(J[le]=yt,J[Le]=te,le=Le);else if(ut<_e&&0>i(B,te))J[le]=B,J[ut]=te,le=ut;else break e}}return ue}function i(J,ue){var te=J.sortIndex-ue.sortIndex;return te!==0?te:J.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var c=[],h=[],p=1,m=null,_=3,E=!1,S=!1,P=!1,N=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(J){for(var ue=n(h);ue!==null;){if(ue.callback===null)r(h);else if(ue.startTime<=J)r(h),ue.sortIndex=ue.expirationTime,e(c,ue);else break;ue=n(h)}}function A(J){if(P=!1,w(J),!S)if(n(c)!==null)S=!0,Te(V);else{var ue=n(h);ue!==null&&Pe(A,ue.startTime-J)}}function V(J,ue){S=!1,P&&(P=!1,R(C),C=-1),E=!0;var te=_;try{for(w(ue),m=n(c);m!==null&&(!(m.expirationTime>ue)||J&&!M());){var le=m.callback;if(typeof le=="function"){m.callback=null,_=m.priorityLevel;var _e=le(m.expirationTime<=ue);ue=t.unstable_now(),typeof _e=="function"?m.callback=_e:m===n(c)&&r(c),w(ue)}else r(c);m=n(c)}if(m!==null)var Ce=!0;else{var Le=n(h);Le!==null&&Pe(A,Le.startTime-ue),Ce=!1}return Ce}finally{m=null,_=te,E=!1}}var U=!1,O=null,C=-1,D=5,x=-1;function M(){return!(t.unstable_now()-x<D)}function z(){if(O!==null){var J=t.unstable_now();x=J;var ue=!0;try{ue=O(!0,J)}finally{ue?b():(U=!1,O=null)}}else U=!1}var b;if(typeof k=="function")b=function(){k(z)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ye=oe.port2;oe.port1.onmessage=z,b=function(){ye.postMessage(null)}}else b=function(){N(z,0)};function Te(J){O=J,U||(U=!0,b())}function Pe(J,ue){C=N(function(){J(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(J){J.callback=null},t.unstable_continueExecution=function(){S||E||(S=!0,Te(V))},t.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<J?Math.floor(1e3/J):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(J){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var te=_;_=ue;try{return J()}finally{_=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(J,ue){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var te=_;_=J;try{return ue()}finally{_=te}},t.unstable_scheduleCallback=function(J,ue,te){var le=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?le+te:le):te=le,J){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=te+_e,J={id:p++,callback:ue,priorityLevel:J,startTime:te,expirationTime:_e,sortIndex:-1},te>le?(J.sortIndex=te,e(h,J),n(c)===null&&J===n(h)&&(P?(R(C),C=-1):P=!0,Pe(A,te-le))):(J.sortIndex=_e,e(c,J),S||E||(S=!0,Te(V))),J},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(J){var ue=_;return function(){var te=_;_=ue;try{return J.apply(this,arguments)}finally{_=te}}}})(x5);A5.exports=x5;var Ih=A5.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zk=X,Vr=Ih;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var N5=new Set,Hh={};function al(t,e){Iu(t,e),Iu(t+"Capture",e)}function Iu(t,e){for(Hh[t]=e,t=0;t<e.length;t++)N5.add(e[t])}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cy=Object.prototype.hasOwnProperty,eA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_4={},v4={};function tA(t){return cy.call(v4,t)?!0:cy.call(_4,t)?!1:eA.test(t)?v4[t]=!0:(_4[t]=!0,!1)}function nA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function rA(t,e,n,r){if(e===null||typeof e>"u"||nA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gr(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var zn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zn[t]=new gr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zn[e]=new gr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zn[t]=new gr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zn[t]=new gr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zn[t]=new gr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zn[t]=new gr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zn[t]=new gr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zn[t]=new gr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zn[t]=new gr(t,5,!1,t.toLowerCase(),null,!1,!1)});var o2=/[\-:]([a-z])/g;function a2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(o2,a2);zn[e]=new gr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(o2,a2);zn[e]=new gr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(o2,a2);zn[e]=new gr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zn[t]=new gr(t,1,!1,t.toLowerCase(),null,!1,!1)});zn.xlinkHref=new gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zn[t]=new gr(t,1,!1,t.toLowerCase(),null,!0,!0)});function l2(t,e,n,r){var i=zn.hasOwnProperty(e)?zn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(rA(e,n,i,r)&&(n=null),r||i===null?tA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Qs=Zk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lp=Symbol.for("react.element"),Zl=Symbol.for("react.portal"),eu=Symbol.for("react.fragment"),u2=Symbol.for("react.strict_mode"),hy=Symbol.for("react.profiler"),D5=Symbol.for("react.provider"),O5=Symbol.for("react.context"),c2=Symbol.for("react.forward_ref"),dy=Symbol.for("react.suspense"),fy=Symbol.for("react.suspense_list"),h2=Symbol.for("react.memo"),wo=Symbol.for("react.lazy"),M5=Symbol.for("react.offscreen"),y4=Symbol.iterator;function Zc(t){return t===null||typeof t!="object"?null:(t=y4&&t[y4]||t["@@iterator"],typeof t=="function"?t:null)}var Mt=Object.assign,lv;function gh(t){if(lv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);lv=e&&e[1]||""}return`
`+lv+t}var uv=!1;function cv(t,e){if(!t||uv)return"";uv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,u=s.length-1;1<=o&&0<=u&&i[o]!==s[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==s[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==s[u]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=u);break}}}finally{uv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?gh(t):""}function iA(t){switch(t.tag){case 5:return gh(t.type);case 16:return gh("Lazy");case 13:return gh("Suspense");case 19:return gh("SuspenseList");case 0:case 2:case 15:return t=cv(t.type,!1),t;case 11:return t=cv(t.type.render,!1),t;case 1:return t=cv(t.type,!0),t;default:return""}}function py(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case eu:return"Fragment";case Zl:return"Portal";case hy:return"Profiler";case u2:return"StrictMode";case dy:return"Suspense";case fy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case O5:return(t.displayName||"Context")+".Consumer";case D5:return(t._context.displayName||"Context")+".Provider";case c2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case h2:return e=t.displayName||null,e!==null?e:py(t.type)||"Memo";case wo:e=t._payload,t=t._init;try{return py(t(e))}catch{}}return null}function sA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return py(e);case 8:return e===u2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function L5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function oA(t){var e=L5(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function up(t){t._valueTracker||(t._valueTracker=oA(t))}function b5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=L5(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function lg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gy(t,e){var n=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function w4(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=qo(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function F5(t,e){e=e.checked,e!=null&&l2(t,"checked",e,!1)}function my(t,e){F5(t,e);var n=qo(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_y(t,e.type,n):e.hasOwnProperty("defaultValue")&&_y(t,e.type,qo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function E4(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _y(t,e,n){(e!=="number"||lg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var mh=Array.isArray;function du(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+qo(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function vy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function S4(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(mh(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qo(n)}}function V5(t,e){var n=qo(e.value),r=qo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function T4(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function U5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?U5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var cp,z5=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(cp=cp||document.createElement("div"),cp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $h(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ph={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aA=["Webkit","ms","Moz","O"];Object.keys(Ph).forEach(function(t){aA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ph[e]=Ph[t]})});function B5(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ph.hasOwnProperty(t)&&Ph[t]?(""+e).trim():e+"px"}function j5(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=B5(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var lA=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wy(t,e){if(e){if(lA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function Ey(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sy=null;function d2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ty=null,fu=null,pu=null;function C4(t){if(t=Dd(t)){if(typeof Ty!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=Tm(e),Ty(t.stateNode,t.type,e))}}function G5(t){fu?pu?pu.push(t):pu=[t]:fu=t}function W5(){if(fu){var t=fu,e=pu;if(pu=fu=null,C4(t),e)for(t=0;t<e.length;t++)C4(e[t])}}function H5(t,e){return t(e)}function $5(){}var hv=!1;function q5(t,e,n){if(hv)return t(e,n);hv=!0;try{return H5(t,e,n)}finally{hv=!1,(fu!==null||pu!==null)&&($5(),W5())}}function qh(t,e){var n=t.stateNode;if(n===null)return null;var r=Tm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var Cy=!1;if(zs)try{var eh={};Object.defineProperty(eh,"passive",{get:function(){Cy=!0}}),window.addEventListener("test",eh,eh),window.removeEventListener("test",eh,eh)}catch{Cy=!1}function uA(t,e,n,r,i,s,o,u,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Rh=!1,ug=null,cg=!1,Iy=null,cA={onError:function(t){Rh=!0,ug=t}};function hA(t,e,n,r,i,s,o,u,c){Rh=!1,ug=null,uA.apply(cA,arguments)}function dA(t,e,n,r,i,s,o,u,c){if(hA.apply(this,arguments),Rh){if(Rh){var h=ug;Rh=!1,ug=null}else throw Error(ne(198));cg||(cg=!0,Iy=h)}}function ll(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function K5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function I4(t){if(ll(t)!==t)throw Error(ne(188))}function fA(t){var e=t.alternate;if(!e){if(e=ll(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return I4(i),t;if(s===r)return I4(i),e;s=s.sibling}throw Error(ne(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=s;break}if(u===r){o=!0,r=i,n=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===n){o=!0,n=s,r=i;break}if(u===r){o=!0,r=s,n=i;break}u=u.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function Q5(t){return t=fA(t),t!==null?Y5(t):null}function Y5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Y5(t);if(e!==null)return e;t=t.sibling}return null}var X5=Vr.unstable_scheduleCallback,P4=Vr.unstable_cancelCallback,pA=Vr.unstable_shouldYield,gA=Vr.unstable_requestPaint,Ht=Vr.unstable_now,mA=Vr.unstable_getCurrentPriorityLevel,f2=Vr.unstable_ImmediatePriority,J5=Vr.unstable_UserBlockingPriority,hg=Vr.unstable_NormalPriority,_A=Vr.unstable_LowPriority,Z5=Vr.unstable_IdlePriority,ym=null,Qi=null;function vA(t){if(Qi&&typeof Qi.onCommitFiberRoot=="function")try{Qi.onCommitFiberRoot(ym,t,void 0,(t.current.flags&128)===128)}catch{}}var Si=Math.clz32?Math.clz32:EA,yA=Math.log,wA=Math.LN2;function EA(t){return t>>>=0,t===0?32:31-(yA(t)/wA|0)|0}var hp=64,dp=4194304;function _h(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dg(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=_h(u):(s&=o,s!==0&&(r=_h(s)))}else o=n&~i,o!==0?r=_h(o):s!==0&&(r=_h(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Si(e),i=1<<n,r|=t[n],e&=~i;return r}function SA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Si(s),u=1<<o,c=i[o];c===-1?(!(u&n)||u&r)&&(i[o]=SA(u,e)):c<=e&&(t.expiredLanes|=u),s&=~u}}function Py(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function eI(){var t=hp;return hp<<=1,!(hp&4194240)&&(hp=64),t}function dv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Si(e),t[e]=n}function CA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Si(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function p2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Si(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ct=0;function tI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nI,g2,rI,iI,sI,Ry=!1,fp=[],Oo=null,Mo=null,Lo=null,Kh=new Map,Qh=new Map,So=[],IA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function R4(t,e){switch(t){case"focusin":case"focusout":Oo=null;break;case"dragenter":case"dragleave":Mo=null;break;case"mouseover":case"mouseout":Lo=null;break;case"pointerover":case"pointerout":Kh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(e.pointerId)}}function th(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Dd(e),e!==null&&g2(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function PA(t,e,n,r,i){switch(e){case"focusin":return Oo=th(Oo,t,e,n,r,i),!0;case"dragenter":return Mo=th(Mo,t,e,n,r,i),!0;case"mouseover":return Lo=th(Lo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Kh.set(s,th(Kh.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Qh.set(s,th(Qh.get(s)||null,t,e,n,r,i)),!0}return!1}function oI(t){var e=ba(t.target);if(e!==null){var n=ll(e);if(n!==null){if(e=n.tag,e===13){if(e=K5(n),e!==null){t.blockedOn=e,sI(t.priority,function(){rI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function zp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ky(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Sy=r,n.target.dispatchEvent(r),Sy=null}else return e=Dd(n),e!==null&&g2(e),t.blockedOn=n,!1;e.shift()}return!0}function k4(t,e,n){zp(t)&&n.delete(e)}function RA(){Ry=!1,Oo!==null&&zp(Oo)&&(Oo=null),Mo!==null&&zp(Mo)&&(Mo=null),Lo!==null&&zp(Lo)&&(Lo=null),Kh.forEach(k4),Qh.forEach(k4)}function nh(t,e){t.blockedOn===e&&(t.blockedOn=null,Ry||(Ry=!0,Vr.unstable_scheduleCallback(Vr.unstable_NormalPriority,RA)))}function Yh(t){function e(i){return nh(i,t)}if(0<fp.length){nh(fp[0],t);for(var n=1;n<fp.length;n++){var r=fp[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Oo!==null&&nh(Oo,t),Mo!==null&&nh(Mo,t),Lo!==null&&nh(Lo,t),Kh.forEach(e),Qh.forEach(e),n=0;n<So.length;n++)r=So[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<So.length&&(n=So[0],n.blockedOn===null);)oI(n),n.blockedOn===null&&So.shift()}var gu=Qs.ReactCurrentBatchConfig,fg=!0;function kA(t,e,n,r){var i=ct,s=gu.transition;gu.transition=null;try{ct=1,m2(t,e,n,r)}finally{ct=i,gu.transition=s}}function AA(t,e,n,r){var i=ct,s=gu.transition;gu.transition=null;try{ct=4,m2(t,e,n,r)}finally{ct=i,gu.transition=s}}function m2(t,e,n,r){if(fg){var i=ky(t,e,n,r);if(i===null)Sv(t,e,r,pg,n),R4(t,r);else if(PA(i,t,e,n,r))r.stopPropagation();else if(R4(t,r),e&4&&-1<IA.indexOf(t)){for(;i!==null;){var s=Dd(i);if(s!==null&&nI(s),s=ky(t,e,n,r),s===null&&Sv(t,e,r,pg,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Sv(t,e,r,null,n)}}var pg=null;function ky(t,e,n,r){if(pg=null,t=d2(r),t=ba(t),t!==null)if(e=ll(t),e===null)t=null;else if(n=e.tag,n===13){if(t=K5(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pg=t,null}function aI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mA()){case f2:return 1;case J5:return 4;case hg:case _A:return 16;case Z5:return 536870912;default:return 16}default:return 16}}var Ro=null,_2=null,Bp=null;function lI(){if(Bp)return Bp;var t,e=_2,n=e.length,r,i="value"in Ro?Ro.value:Ro.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Bp=i.slice(t,1<r?1-r:void 0)}function jp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function pp(){return!0}function A4(){return!1}function zr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?pp:A4,this.isPropagationStopped=A4,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pp)},persist:function(){},isPersistent:pp}),e}var Xu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},v2=zr(Xu),Nd=Mt({},Xu,{view:0,detail:0}),xA=zr(Nd),fv,pv,rh,wm=Mt({},Nd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==rh&&(rh&&t.type==="mousemove"?(fv=t.screenX-rh.screenX,pv=t.screenY-rh.screenY):pv=fv=0,rh=t),fv)},movementY:function(t){return"movementY"in t?t.movementY:pv}}),x4=zr(wm),NA=Mt({},wm,{dataTransfer:0}),DA=zr(NA),OA=Mt({},Nd,{relatedTarget:0}),gv=zr(OA),MA=Mt({},Xu,{animationName:0,elapsedTime:0,pseudoElement:0}),LA=zr(MA),bA=Mt({},Xu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),FA=zr(bA),VA=Mt({},Xu,{data:0}),N4=zr(VA),UA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=BA[t])?!!e[t]:!1}function y2(){return jA}var GA=Mt({},Nd,{key:function(t){if(t.key){var e=UA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=jp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y2,charCode:function(t){return t.type==="keypress"?jp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WA=zr(GA),HA=Mt({},wm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D4=zr(HA),$A=Mt({},Nd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y2}),qA=zr($A),KA=Mt({},Xu,{propertyName:0,elapsedTime:0,pseudoElement:0}),QA=zr(KA),YA=Mt({},wm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),XA=zr(YA),JA=[9,13,27,32],w2=zs&&"CompositionEvent"in window,kh=null;zs&&"documentMode"in document&&(kh=document.documentMode);var ZA=zs&&"TextEvent"in window&&!kh,uI=zs&&(!w2||kh&&8<kh&&11>=kh),O4=" ",M4=!1;function cI(t,e){switch(t){case"keyup":return JA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var tu=!1;function ex(t,e){switch(t){case"compositionend":return hI(e);case"keypress":return e.which!==32?null:(M4=!0,O4);case"textInput":return t=e.data,t===O4&&M4?null:t;default:return null}}function tx(t,e){if(tu)return t==="compositionend"||!w2&&cI(t,e)?(t=lI(),Bp=_2=Ro=null,tu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uI&&e.locale!=="ko"?null:e.data;default:return null}}var nx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function L4(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nx[t.type]:e==="textarea"}function dI(t,e,n,r){G5(r),e=gg(e,"onChange"),0<e.length&&(n=new v2("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ah=null,Xh=null;function rx(t){TI(t,0)}function Em(t){var e=iu(t);if(b5(e))return t}function ix(t,e){if(t==="change")return e}var fI=!1;if(zs){var mv;if(zs){var _v="oninput"in document;if(!_v){var b4=document.createElement("div");b4.setAttribute("oninput","return;"),_v=typeof b4.oninput=="function"}mv=_v}else mv=!1;fI=mv&&(!document.documentMode||9<document.documentMode)}function F4(){Ah&&(Ah.detachEvent("onpropertychange",pI),Xh=Ah=null)}function pI(t){if(t.propertyName==="value"&&Em(Xh)){var e=[];dI(e,Xh,t,d2(t)),q5(rx,e)}}function sx(t,e,n){t==="focusin"?(F4(),Ah=e,Xh=n,Ah.attachEvent("onpropertychange",pI)):t==="focusout"&&F4()}function ox(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Em(Xh)}function ax(t,e){if(t==="click")return Em(e)}function lx(t,e){if(t==="input"||t==="change")return Em(e)}function ux(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ri=typeof Object.is=="function"?Object.is:ux;function Jh(t,e){if(Ri(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!cy.call(e,i)||!Ri(t[i],e[i]))return!1}return!0}function V4(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function U4(t,e){var n=V4(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=V4(n)}}function gI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mI(){for(var t=window,e=lg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=lg(t.document)}return e}function E2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function cx(t){var e=mI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&gI(n.ownerDocument.documentElement,n)){if(r!==null&&E2(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=U4(n,s);var o=U4(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hx=zs&&"documentMode"in document&&11>=document.documentMode,nu=null,Ay=null,xh=null,xy=!1;function z4(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xy||nu==null||nu!==lg(r)||(r=nu,"selectionStart"in r&&E2(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xh&&Jh(xh,r)||(xh=r,r=gg(Ay,"onSelect"),0<r.length&&(e=new v2("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=nu)))}function gp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ru={animationend:gp("Animation","AnimationEnd"),animationiteration:gp("Animation","AnimationIteration"),animationstart:gp("Animation","AnimationStart"),transitionend:gp("Transition","TransitionEnd")},vv={},_I={};zs&&(_I=document.createElement("div").style,"AnimationEvent"in window||(delete ru.animationend.animation,delete ru.animationiteration.animation,delete ru.animationstart.animation),"TransitionEvent"in window||delete ru.transitionend.transition);function Sm(t){if(vv[t])return vv[t];if(!ru[t])return t;var e=ru[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in _I)return vv[t]=e[n];return t}var vI=Sm("animationend"),yI=Sm("animationiteration"),wI=Sm("animationstart"),EI=Sm("transitionend"),SI=new Map,B4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function na(t,e){SI.set(t,e),al(e,[t])}for(var yv=0;yv<B4.length;yv++){var wv=B4[yv],dx=wv.toLowerCase(),fx=wv[0].toUpperCase()+wv.slice(1);na(dx,"on"+fx)}na(vI,"onAnimationEnd");na(yI,"onAnimationIteration");na(wI,"onAnimationStart");na("dblclick","onDoubleClick");na("focusin","onFocus");na("focusout","onBlur");na(EI,"onTransitionEnd");Iu("onMouseEnter",["mouseout","mouseover"]);Iu("onMouseLeave",["mouseout","mouseover"]);Iu("onPointerEnter",["pointerout","pointerover"]);Iu("onPointerLeave",["pointerout","pointerover"]);al("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));al("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));al("onBeforeInput",["compositionend","keypress","textInput","paste"]);al("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));al("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));al("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),px=new Set("cancel close invalid load scroll toggle".split(" ").concat(vh));function j4(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,dA(r,e,void 0,t),t.currentTarget=null}function TI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var u=r[o],c=u.instance,h=u.currentTarget;if(u=u.listener,c!==s&&i.isPropagationStopped())break e;j4(i,u,h),s=c}else for(o=0;o<r.length;o++){if(u=r[o],c=u.instance,h=u.currentTarget,u=u.listener,c!==s&&i.isPropagationStopped())break e;j4(i,u,h),s=c}}}if(cg)throw t=Iy,cg=!1,Iy=null,t}function Ct(t,e){var n=e[Ly];n===void 0&&(n=e[Ly]=new Set);var r=t+"__bubble";n.has(r)||(CI(e,t,2,!1),n.add(r))}function Ev(t,e,n){var r=0;e&&(r|=4),CI(n,t,r,e)}var mp="_reactListening"+Math.random().toString(36).slice(2);function Zh(t){if(!t[mp]){t[mp]=!0,N5.forEach(function(n){n!=="selectionchange"&&(px.has(n)||Ev(n,!1,t),Ev(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[mp]||(e[mp]=!0,Ev("selectionchange",!1,e))}}function CI(t,e,n,r){switch(aI(e)){case 1:var i=kA;break;case 4:i=AA;break;default:i=m2}n=i.bind(null,e,n,t),i=void 0,!Cy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Sv(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;u!==null;){if(o=ba(u),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}u=u.parentNode}}r=r.return}q5(function(){var h=s,p=d2(n),m=[];e:{var _=SI.get(t);if(_!==void 0){var E=v2,S=t;switch(t){case"keypress":if(jp(n)===0)break e;case"keydown":case"keyup":E=WA;break;case"focusin":S="focus",E=gv;break;case"focusout":S="blur",E=gv;break;case"beforeblur":case"afterblur":E=gv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=x4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=DA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=qA;break;case vI:case yI:case wI:E=LA;break;case EI:E=QA;break;case"scroll":E=xA;break;case"wheel":E=XA;break;case"copy":case"cut":case"paste":E=FA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=D4}var P=(e&4)!==0,N=!P&&t==="scroll",R=P?_!==null?_+"Capture":null:_;P=[];for(var k=h,w;k!==null;){w=k;var A=w.stateNode;if(w.tag===5&&A!==null&&(w=A,R!==null&&(A=qh(k,R),A!=null&&P.push(ed(k,A,w)))),N)break;k=k.return}0<P.length&&(_=new E(_,S,null,n,p),m.push({event:_,listeners:P}))}}if(!(e&7)){e:{if(_=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",_&&n!==Sy&&(S=n.relatedTarget||n.fromElement)&&(ba(S)||S[Bs]))break e;if((E||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,E?(S=n.relatedTarget||n.toElement,E=h,S=S?ba(S):null,S!==null&&(N=ll(S),S!==N||S.tag!==5&&S.tag!==6)&&(S=null)):(E=null,S=h),E!==S)){if(P=x4,A="onMouseLeave",R="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(P=D4,A="onPointerLeave",R="onPointerEnter",k="pointer"),N=E==null?_:iu(E),w=S==null?_:iu(S),_=new P(A,k+"leave",E,n,p),_.target=N,_.relatedTarget=w,A=null,ba(p)===h&&(P=new P(R,k+"enter",S,n,p),P.target=w,P.relatedTarget=N,A=P),N=A,E&&S)t:{for(P=E,R=S,k=0,w=P;w;w=Hl(w))k++;for(w=0,A=R;A;A=Hl(A))w++;for(;0<k-w;)P=Hl(P),k--;for(;0<w-k;)R=Hl(R),w--;for(;k--;){if(P===R||R!==null&&P===R.alternate)break t;P=Hl(P),R=Hl(R)}P=null}else P=null;E!==null&&G4(m,_,E,P,!1),S!==null&&N!==null&&G4(m,N,S,P,!0)}}e:{if(_=h?iu(h):window,E=_.nodeName&&_.nodeName.toLowerCase(),E==="select"||E==="input"&&_.type==="file")var V=ix;else if(L4(_))if(fI)V=lx;else{V=ox;var U=sx}else(E=_.nodeName)&&E.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(V=ax);if(V&&(V=V(t,h))){dI(m,V,n,p);break e}U&&U(t,_,h),t==="focusout"&&(U=_._wrapperState)&&U.controlled&&_.type==="number"&&_y(_,"number",_.value)}switch(U=h?iu(h):window,t){case"focusin":(L4(U)||U.contentEditable==="true")&&(nu=U,Ay=h,xh=null);break;case"focusout":xh=Ay=nu=null;break;case"mousedown":xy=!0;break;case"contextmenu":case"mouseup":case"dragend":xy=!1,z4(m,n,p);break;case"selectionchange":if(hx)break;case"keydown":case"keyup":z4(m,n,p)}var O;if(w2)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else tu?cI(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(uI&&n.locale!=="ko"&&(tu||C!=="onCompositionStart"?C==="onCompositionEnd"&&tu&&(O=lI()):(Ro=p,_2="value"in Ro?Ro.value:Ro.textContent,tu=!0)),U=gg(h,C),0<U.length&&(C=new N4(C,t,null,n,p),m.push({event:C,listeners:U}),O?C.data=O:(O=hI(n),O!==null&&(C.data=O)))),(O=ZA?ex(t,n):tx(t,n))&&(h=gg(h,"onBeforeInput"),0<h.length&&(p=new N4("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=O))}TI(m,e)})}function ed(t,e,n){return{instance:t,listener:e,currentTarget:n}}function gg(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=qh(t,n),s!=null&&r.unshift(ed(t,s,i)),s=qh(t,e),s!=null&&r.push(ed(t,s,i))),t=t.return}return r}function Hl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function G4(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var u=n,c=u.alternate,h=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&h!==null&&(u=h,i?(c=qh(n,s),c!=null&&o.unshift(ed(n,c,u))):i||(c=qh(n,s),c!=null&&o.push(ed(n,c,u)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var gx=/\r\n?/g,mx=/\u0000|\uFFFD/g;function W4(t){return(typeof t=="string"?t:""+t).replace(gx,`
`).replace(mx,"")}function _p(t,e,n){if(e=W4(e),W4(t)!==e&&n)throw Error(ne(425))}function mg(){}var Ny=null,Dy=null;function Oy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var My=typeof setTimeout=="function"?setTimeout:void 0,_x=typeof clearTimeout=="function"?clearTimeout:void 0,H4=typeof Promise=="function"?Promise:void 0,vx=typeof queueMicrotask=="function"?queueMicrotask:typeof H4<"u"?function(t){return H4.resolve(null).then(t).catch(yx)}:My;function yx(t){setTimeout(function(){throw t})}function Tv(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Yh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Yh(e)}function bo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ju=Math.random().toString(36).slice(2),qi="__reactFiber$"+Ju,td="__reactProps$"+Ju,Bs="__reactContainer$"+Ju,Ly="__reactEvents$"+Ju,wx="__reactListeners$"+Ju,Ex="__reactHandles$"+Ju;function ba(t){var e=t[qi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Bs]||n[qi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$4(t);t!==null;){if(n=t[qi])return n;t=$4(t)}return e}t=n,n=t.parentNode}return null}function Dd(t){return t=t[qi]||t[Bs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function iu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function Tm(t){return t[td]||null}var by=[],su=-1;function ra(t){return{current:t}}function Pt(t){0>su||(t.current=by[su],by[su]=null,su--)}function St(t,e){su++,by[su]=t.current,t.current=e}var Ko={},rr=ra(Ko),Ar=ra(!1),$a=Ko;function Pu(t,e){var n=t.type.contextTypes;if(!n)return Ko;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function xr(t){return t=t.childContextTypes,t!=null}function _g(){Pt(Ar),Pt(rr)}function q4(t,e,n){if(rr.current!==Ko)throw Error(ne(168));St(rr,e),St(Ar,n)}function II(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ne(108,sA(t)||"Unknown",i));return Mt({},n,r)}function vg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ko,$a=rr.current,St(rr,t),St(Ar,Ar.current),!0}function K4(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=II(t,e,$a),r.__reactInternalMemoizedMergedChildContext=t,Pt(Ar),Pt(rr),St(rr,t)):Pt(Ar),St(Ar,n)}var Ps=null,Cm=!1,Cv=!1;function PI(t){Ps===null?Ps=[t]:Ps.push(t)}function Sx(t){Cm=!0,PI(t)}function ia(){if(!Cv&&Ps!==null){Cv=!0;var t=0,e=ct;try{var n=Ps;for(ct=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ps=null,Cm=!1}catch(i){throw Ps!==null&&(Ps=Ps.slice(t+1)),X5(f2,ia),i}finally{ct=e,Cv=!1}}return null}var ou=[],au=0,yg=null,wg=0,Xr=[],Jr=0,qa=null,ks=1,As="";function Da(t,e){ou[au++]=wg,ou[au++]=yg,yg=t,wg=e}function RI(t,e,n){Xr[Jr++]=ks,Xr[Jr++]=As,Xr[Jr++]=qa,qa=t;var r=ks;t=As;var i=32-Si(r)-1;r&=~(1<<i),n+=1;var s=32-Si(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ks=1<<32-Si(e)+i|n<<i|r,As=s+t}else ks=1<<s|n<<i|r,As=t}function S2(t){t.return!==null&&(Da(t,1),RI(t,1,0))}function T2(t){for(;t===yg;)yg=ou[--au],ou[au]=null,wg=ou[--au],ou[au]=null;for(;t===qa;)qa=Xr[--Jr],Xr[Jr]=null,As=Xr[--Jr],Xr[Jr]=null,ks=Xr[--Jr],Xr[Jr]=null}var br=null,Lr=null,kt=!1,vi=null;function kI(t,e){var n=ei(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Q4(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,br=t,Lr=bo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,br=t,Lr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qa!==null?{id:ks,overflow:As}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ei(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,br=t,Lr=null,!0):!1;default:return!1}}function Fy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Vy(t){if(kt){var e=Lr;if(e){var n=e;if(!Q4(t,e)){if(Fy(t))throw Error(ne(418));e=bo(n.nextSibling);var r=br;e&&Q4(t,e)?kI(r,n):(t.flags=t.flags&-4097|2,kt=!1,br=t)}}else{if(Fy(t))throw Error(ne(418));t.flags=t.flags&-4097|2,kt=!1,br=t}}}function Y4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;br=t}function vp(t){if(t!==br)return!1;if(!kt)return Y4(t),kt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Oy(t.type,t.memoizedProps)),e&&(e=Lr)){if(Fy(t))throw AI(),Error(ne(418));for(;e;)kI(t,e),e=bo(e.nextSibling)}if(Y4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Lr=bo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Lr=null}}else Lr=br?bo(t.stateNode.nextSibling):null;return!0}function AI(){for(var t=Lr;t;)t=bo(t.nextSibling)}function Ru(){Lr=br=null,kt=!1}function C2(t){vi===null?vi=[t]:vi.push(t)}var Tx=Qs.ReactCurrentBatchConfig;function ih(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var u=i.refs;o===null?delete u[s]:u[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function yp(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function X4(t){var e=t._init;return e(t._payload)}function xI(t){function e(R,k){if(t){var w=R.deletions;w===null?(R.deletions=[k],R.flags|=16):w.push(k)}}function n(R,k){if(!t)return null;for(;k!==null;)e(R,k),k=k.sibling;return null}function r(R,k){for(R=new Map;k!==null;)k.key!==null?R.set(k.key,k):R.set(k.index,k),k=k.sibling;return R}function i(R,k){return R=zo(R,k),R.index=0,R.sibling=null,R}function s(R,k,w){return R.index=w,t?(w=R.alternate,w!==null?(w=w.index,w<k?(R.flags|=2,k):w):(R.flags|=2,k)):(R.flags|=1048576,k)}function o(R){return t&&R.alternate===null&&(R.flags|=2),R}function u(R,k,w,A){return k===null||k.tag!==6?(k=Nv(w,R.mode,A),k.return=R,k):(k=i(k,w),k.return=R,k)}function c(R,k,w,A){var V=w.type;return V===eu?p(R,k,w.props.children,A,w.key):k!==null&&(k.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===wo&&X4(V)===k.type)?(A=i(k,w.props),A.ref=ih(R,k,w),A.return=R,A):(A=Qp(w.type,w.key,w.props,null,R.mode,A),A.ref=ih(R,k,w),A.return=R,A)}function h(R,k,w,A){return k===null||k.tag!==4||k.stateNode.containerInfo!==w.containerInfo||k.stateNode.implementation!==w.implementation?(k=Dv(w,R.mode,A),k.return=R,k):(k=i(k,w.children||[]),k.return=R,k)}function p(R,k,w,A,V){return k===null||k.tag!==7?(k=Ga(w,R.mode,A,V),k.return=R,k):(k=i(k,w),k.return=R,k)}function m(R,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Nv(""+k,R.mode,w),k.return=R,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case lp:return w=Qp(k.type,k.key,k.props,null,R.mode,w),w.ref=ih(R,null,k),w.return=R,w;case Zl:return k=Dv(k,R.mode,w),k.return=R,k;case wo:var A=k._init;return m(R,A(k._payload),w)}if(mh(k)||Zc(k))return k=Ga(k,R.mode,w,null),k.return=R,k;yp(R,k)}return null}function _(R,k,w,A){var V=k!==null?k.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return V!==null?null:u(R,k,""+w,A);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case lp:return w.key===V?c(R,k,w,A):null;case Zl:return w.key===V?h(R,k,w,A):null;case wo:return V=w._init,_(R,k,V(w._payload),A)}if(mh(w)||Zc(w))return V!==null?null:p(R,k,w,A,null);yp(R,w)}return null}function E(R,k,w,A,V){if(typeof A=="string"&&A!==""||typeof A=="number")return R=R.get(w)||null,u(k,R,""+A,V);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case lp:return R=R.get(A.key===null?w:A.key)||null,c(k,R,A,V);case Zl:return R=R.get(A.key===null?w:A.key)||null,h(k,R,A,V);case wo:var U=A._init;return E(R,k,w,U(A._payload),V)}if(mh(A)||Zc(A))return R=R.get(w)||null,p(k,R,A,V,null);yp(k,A)}return null}function S(R,k,w,A){for(var V=null,U=null,O=k,C=k=0,D=null;O!==null&&C<w.length;C++){O.index>C?(D=O,O=null):D=O.sibling;var x=_(R,O,w[C],A);if(x===null){O===null&&(O=D);break}t&&O&&x.alternate===null&&e(R,O),k=s(x,k,C),U===null?V=x:U.sibling=x,U=x,O=D}if(C===w.length)return n(R,O),kt&&Da(R,C),V;if(O===null){for(;C<w.length;C++)O=m(R,w[C],A),O!==null&&(k=s(O,k,C),U===null?V=O:U.sibling=O,U=O);return kt&&Da(R,C),V}for(O=r(R,O);C<w.length;C++)D=E(O,R,C,w[C],A),D!==null&&(t&&D.alternate!==null&&O.delete(D.key===null?C:D.key),k=s(D,k,C),U===null?V=D:U.sibling=D,U=D);return t&&O.forEach(function(M){return e(R,M)}),kt&&Da(R,C),V}function P(R,k,w,A){var V=Zc(w);if(typeof V!="function")throw Error(ne(150));if(w=V.call(w),w==null)throw Error(ne(151));for(var U=V=null,O=k,C=k=0,D=null,x=w.next();O!==null&&!x.done;C++,x=w.next()){O.index>C?(D=O,O=null):D=O.sibling;var M=_(R,O,x.value,A);if(M===null){O===null&&(O=D);break}t&&O&&M.alternate===null&&e(R,O),k=s(M,k,C),U===null?V=M:U.sibling=M,U=M,O=D}if(x.done)return n(R,O),kt&&Da(R,C),V;if(O===null){for(;!x.done;C++,x=w.next())x=m(R,x.value,A),x!==null&&(k=s(x,k,C),U===null?V=x:U.sibling=x,U=x);return kt&&Da(R,C),V}for(O=r(R,O);!x.done;C++,x=w.next())x=E(O,R,C,x.value,A),x!==null&&(t&&x.alternate!==null&&O.delete(x.key===null?C:x.key),k=s(x,k,C),U===null?V=x:U.sibling=x,U=x);return t&&O.forEach(function(z){return e(R,z)}),kt&&Da(R,C),V}function N(R,k,w,A){if(typeof w=="object"&&w!==null&&w.type===eu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case lp:e:{for(var V=w.key,U=k;U!==null;){if(U.key===V){if(V=w.type,V===eu){if(U.tag===7){n(R,U.sibling),k=i(U,w.props.children),k.return=R,R=k;break e}}else if(U.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===wo&&X4(V)===U.type){n(R,U.sibling),k=i(U,w.props),k.ref=ih(R,U,w),k.return=R,R=k;break e}n(R,U);break}else e(R,U);U=U.sibling}w.type===eu?(k=Ga(w.props.children,R.mode,A,w.key),k.return=R,R=k):(A=Qp(w.type,w.key,w.props,null,R.mode,A),A.ref=ih(R,k,w),A.return=R,R=A)}return o(R);case Zl:e:{for(U=w.key;k!==null;){if(k.key===U)if(k.tag===4&&k.stateNode.containerInfo===w.containerInfo&&k.stateNode.implementation===w.implementation){n(R,k.sibling),k=i(k,w.children||[]),k.return=R,R=k;break e}else{n(R,k);break}else e(R,k);k=k.sibling}k=Dv(w,R.mode,A),k.return=R,R=k}return o(R);case wo:return U=w._init,N(R,k,U(w._payload),A)}if(mh(w))return S(R,k,w,A);if(Zc(w))return P(R,k,w,A);yp(R,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,k!==null&&k.tag===6?(n(R,k.sibling),k=i(k,w),k.return=R,R=k):(n(R,k),k=Nv(w,R.mode,A),k.return=R,R=k),o(R)):n(R,k)}return N}var ku=xI(!0),NI=xI(!1),Eg=ra(null),Sg=null,lu=null,I2=null;function P2(){I2=lu=Sg=null}function R2(t){var e=Eg.current;Pt(Eg),t._currentValue=e}function Uy(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function mu(t,e){Sg=t,I2=lu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pr=!0),t.firstContext=null)}function ri(t){var e=t._currentValue;if(I2!==t)if(t={context:t,memoizedValue:e,next:null},lu===null){if(Sg===null)throw Error(ne(308));lu=t,Sg.dependencies={lanes:0,firstContext:t}}else lu=lu.next=t;return e}var Fa=null;function k2(t){Fa===null?Fa=[t]:Fa.push(t)}function DI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,k2(e)):(n.next=i.next,i.next=n),e.interleaved=n,js(t,r)}function js(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Eo=!1;function A2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function OI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ls(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,tt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,js(t,n)}return i=r.interleaved,i===null?(e.next=e,k2(r)):(e.next=i.next,i.next=e),r.interleaved=e,js(t,n)}function Gp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,p2(t,n)}}function J4(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tg(t,e,n,r){var i=t.updateQueue;Eo=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var p=t.alternate;p!==null&&(p=p.updateQueue,u=p.lastBaseUpdate,u!==o&&(u===null?p.firstBaseUpdate=h:u.next=h,p.lastBaseUpdate=c))}if(s!==null){var m=i.baseState;o=0,p=h=c=null,u=s;do{var _=u.lane,E=u.eventTime;if((r&_)===_){p!==null&&(p=p.next={eventTime:E,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var S=t,P=u;switch(_=e,E=n,P.tag){case 1:if(S=P.payload,typeof S=="function"){m=S.call(E,m,_);break e}m=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=P.payload,_=typeof S=="function"?S.call(E,m,_):S,_==null)break e;m=Mt({},m,_);break e;case 2:Eo=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,_=i.effects,_===null?i.effects=[u]:_.push(u))}else E={eventTime:E,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},p===null?(h=p=E,c=m):p=p.next=E,o|=_;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;_=u,u=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(p===null&&(c=m),i.baseState=c,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Qa|=o,t.lanes=o,t.memoizedState=m}}function Z4(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ne(191,i));i.call(r)}}}var Od={},Yi=ra(Od),nd=ra(Od),rd=ra(Od);function Va(t){if(t===Od)throw Error(ne(174));return t}function x2(t,e){switch(St(rd,e),St(nd,t),St(Yi,Od),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:yy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=yy(e,t)}Pt(Yi),St(Yi,e)}function Au(){Pt(Yi),Pt(nd),Pt(rd)}function MI(t){Va(rd.current);var e=Va(Yi.current),n=yy(e,t.type);e!==n&&(St(nd,t),St(Yi,n))}function N2(t){nd.current===t&&(Pt(Yi),Pt(nd))}var Dt=ra(0);function Cg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Iv=[];function D2(){for(var t=0;t<Iv.length;t++)Iv[t]._workInProgressVersionPrimary=null;Iv.length=0}var Wp=Qs.ReactCurrentDispatcher,Pv=Qs.ReactCurrentBatchConfig,Ka=0,Ot=null,an=null,En=null,Ig=!1,Nh=!1,id=0,Cx=0;function Xn(){throw Error(ne(321))}function O2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ri(t[n],e[n]))return!1;return!0}function M2(t,e,n,r,i,s){if(Ka=s,Ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wp.current=t===null||t.memoizedState===null?kx:Ax,t=n(r,i),Nh){s=0;do{if(Nh=!1,id=0,25<=s)throw Error(ne(301));s+=1,En=an=null,e.updateQueue=null,Wp.current=xx,t=n(r,i)}while(Nh)}if(Wp.current=Pg,e=an!==null&&an.next!==null,Ka=0,En=an=Ot=null,Ig=!1,e)throw Error(ne(300));return t}function L2(){var t=id!==0;return id=0,t}function $i(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Ot.memoizedState=En=t:En=En.next=t,En}function ii(){if(an===null){var t=Ot.alternate;t=t!==null?t.memoizedState:null}else t=an.next;var e=En===null?Ot.memoizedState:En.next;if(e!==null)En=e,an=t;else{if(t===null)throw Error(ne(310));an=t,t={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},En===null?Ot.memoizedState=En=t:En=En.next=t}return En}function sd(t,e){return typeof e=="function"?e(t):e}function Rv(t){var e=ii(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=an,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=o=null,c=null,h=s;do{var p=h.lane;if((Ka&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(u=c=m,o=r):c=c.next=m,Ot.lanes|=p,Qa|=p}h=h.next}while(h!==null&&h!==s);c===null?o=r:c.next=u,Ri(r,e.memoizedState)||(Pr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ot.lanes|=s,Qa|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function kv(t){var e=ii(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ri(s,e.memoizedState)||(Pr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function LI(){}function bI(t,e){var n=Ot,r=ii(),i=e(),s=!Ri(r.memoizedState,i);if(s&&(r.memoizedState=i,Pr=!0),r=r.queue,b2(UI.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||En!==null&&En.memoizedState.tag&1){if(n.flags|=2048,od(9,VI.bind(null,n,r,i,e),void 0,null),In===null)throw Error(ne(349));Ka&30||FI(n,e,i)}return i}function FI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function VI(t,e,n,r){e.value=n,e.getSnapshot=r,zI(e)&&BI(t)}function UI(t,e,n){return n(function(){zI(e)&&BI(t)})}function zI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ri(t,n)}catch{return!0}}function BI(t){var e=js(t,1);e!==null&&Ti(e,t,1,-1)}function eT(t){var e=$i();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sd,lastRenderedState:t},e.queue=t,t=t.dispatch=Rx.bind(null,Ot,t),[e.memoizedState,t]}function od(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function jI(){return ii().memoizedState}function Hp(t,e,n,r){var i=$i();Ot.flags|=t,i.memoizedState=od(1|e,n,void 0,r===void 0?null:r)}function Im(t,e,n,r){var i=ii();r=r===void 0?null:r;var s=void 0;if(an!==null){var o=an.memoizedState;if(s=o.destroy,r!==null&&O2(r,o.deps)){i.memoizedState=od(e,n,s,r);return}}Ot.flags|=t,i.memoizedState=od(1|e,n,s,r)}function tT(t,e){return Hp(8390656,8,t,e)}function b2(t,e){return Im(2048,8,t,e)}function GI(t,e){return Im(4,2,t,e)}function WI(t,e){return Im(4,4,t,e)}function HI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $I(t,e,n){return n=n!=null?n.concat([t]):null,Im(4,4,HI.bind(null,e,t),n)}function F2(){}function qI(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&O2(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function KI(t,e){var n=ii();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&O2(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function QI(t,e,n){return Ka&21?(Ri(n,e)||(n=eI(),Ot.lanes|=n,Qa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pr=!0),t.memoizedState=n)}function Ix(t,e){var n=ct;ct=n!==0&&4>n?n:4,t(!0);var r=Pv.transition;Pv.transition={};try{t(!1),e()}finally{ct=n,Pv.transition=r}}function YI(){return ii().memoizedState}function Px(t,e,n){var r=Uo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},XI(t))JI(e,n);else if(n=DI(t,e,n,r),n!==null){var i=dr();Ti(n,t,r,i),ZI(n,e,r)}}function Rx(t,e,n){var r=Uo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(XI(t))JI(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,u=s(o,n);if(i.hasEagerState=!0,i.eagerState=u,Ri(u,o)){var c=e.interleaved;c===null?(i.next=i,k2(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=DI(t,e,i,r),n!==null&&(i=dr(),Ti(n,t,r,i),ZI(n,e,r))}}function XI(t){var e=t.alternate;return t===Ot||e!==null&&e===Ot}function JI(t,e){Nh=Ig=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ZI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,p2(t,n)}}var Pg={readContext:ri,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},kx={readContext:ri,useCallback:function(t,e){return $i().memoizedState=[t,e===void 0?null:e],t},useContext:ri,useEffect:tT,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Hp(4194308,4,HI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Hp(4194308,4,t,e)},useInsertionEffect:function(t,e){return Hp(4,2,t,e)},useMemo:function(t,e){var n=$i();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=$i();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Px.bind(null,Ot,t),[r.memoizedState,t]},useRef:function(t){var e=$i();return t={current:t},e.memoizedState=t},useState:eT,useDebugValue:F2,useDeferredValue:function(t){return $i().memoizedState=t},useTransition:function(){var t=eT(!1),e=t[0];return t=Ix.bind(null,t[1]),$i().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ot,i=$i();if(kt){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),In===null)throw Error(ne(349));Ka&30||FI(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,tT(UI.bind(null,r,s,t),[t]),r.flags|=2048,od(9,VI.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=$i(),e=In.identifierPrefix;if(kt){var n=As,r=ks;n=(r&~(1<<32-Si(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=id++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Cx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Ax={readContext:ri,useCallback:qI,useContext:ri,useEffect:b2,useImperativeHandle:$I,useInsertionEffect:GI,useLayoutEffect:WI,useMemo:KI,useReducer:Rv,useRef:jI,useState:function(){return Rv(sd)},useDebugValue:F2,useDeferredValue:function(t){var e=ii();return QI(e,an.memoizedState,t)},useTransition:function(){var t=Rv(sd)[0],e=ii().memoizedState;return[t,e]},useMutableSource:LI,useSyncExternalStore:bI,useId:YI,unstable_isNewReconciler:!1},xx={readContext:ri,useCallback:qI,useContext:ri,useEffect:b2,useImperativeHandle:$I,useInsertionEffect:GI,useLayoutEffect:WI,useMemo:KI,useReducer:kv,useRef:jI,useState:function(){return kv(sd)},useDebugValue:F2,useDeferredValue:function(t){var e=ii();return an===null?e.memoizedState=t:QI(e,an.memoizedState,t)},useTransition:function(){var t=kv(sd)[0],e=ii().memoizedState;return[t,e]},useMutableSource:LI,useSyncExternalStore:bI,useId:YI,unstable_isNewReconciler:!1};function mi(t,e){if(t&&t.defaultProps){e=Mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zy(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Pm={isMounted:function(t){return(t=t._reactInternals)?ll(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=dr(),i=Uo(t),s=Ls(r,i);s.payload=e,n!=null&&(s.callback=n),e=Fo(t,s,i),e!==null&&(Ti(e,t,i,r),Gp(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=dr(),i=Uo(t),s=Ls(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Fo(t,s,i),e!==null&&(Ti(e,t,i,r),Gp(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=dr(),r=Uo(t),i=Ls(n,r);i.tag=2,e!=null&&(i.callback=e),e=Fo(t,i,r),e!==null&&(Ti(e,t,r,n),Gp(e,t,r))}};function nT(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Jh(n,r)||!Jh(i,s):!0}function e6(t,e,n){var r=!1,i=Ko,s=e.contextType;return typeof s=="object"&&s!==null?s=ri(s):(i=xr(e)?$a:rr.current,r=e.contextTypes,s=(r=r!=null)?Pu(t,i):Ko),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function rT(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Pm.enqueueReplaceState(e,e.state,null)}function By(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},A2(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ri(s):(s=xr(e)?$a:rr.current,i.context=Pu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(zy(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Pm.enqueueReplaceState(i,i.state,null),Tg(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function xu(t,e){try{var n="",r=e;do n+=iA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Av(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function jy(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Nx=typeof WeakMap=="function"?WeakMap:Map;function t6(t,e,n){n=Ls(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){kg||(kg=!0,Jy=r),jy(t,e)},n}function n6(t,e,n){n=Ls(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){jy(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){jy(t,e),typeof r!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function iT(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Nx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Hx.bind(null,t,e,n),e.then(t,t))}function sT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function oT(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ls(-1,1),e.tag=2,Fo(n,e,1))),n.lanes|=1),t)}var Dx=Qs.ReactCurrentOwner,Pr=!1;function hr(t,e,n,r){e.child=t===null?NI(e,null,n,r):ku(e,t.child,n,r)}function aT(t,e,n,r,i){n=n.render;var s=e.ref;return mu(e,i),r=M2(t,e,n,r,s,i),n=L2(),t!==null&&!Pr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gs(t,e,i)):(kt&&n&&S2(e),e.flags|=1,hr(t,e,r,i),e.child)}function lT(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!H2(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,r6(t,e,s,r,i)):(t=Qp(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Jh,n(o,r)&&t.ref===e.ref)return Gs(t,e,i)}return e.flags|=1,t=zo(s,r),t.ref=e.ref,t.return=e,e.child=t}function r6(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Jh(s,r)&&t.ref===e.ref)if(Pr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Pr=!0);else return e.lanes=t.lanes,Gs(t,e,i)}return Gy(t,e,n,r,i)}function i6(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(cu,Or),Or|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,St(cu,Or),Or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,St(cu,Or),Or|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,St(cu,Or),Or|=r;return hr(t,e,i,n),e.child}function s6(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Gy(t,e,n,r,i){var s=xr(n)?$a:rr.current;return s=Pu(e,s),mu(e,i),n=M2(t,e,n,r,s,i),r=L2(),t!==null&&!Pr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gs(t,e,i)):(kt&&r&&S2(e),e.flags|=1,hr(t,e,n,i),e.child)}function uT(t,e,n,r,i){if(xr(n)){var s=!0;vg(e)}else s=!1;if(mu(e,i),e.stateNode===null)$p(t,e),e6(e,n,r),By(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,u=e.memoizedProps;o.props=u;var c=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=ri(h):(h=xr(n)?$a:rr.current,h=Pu(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||c!==h)&&rT(e,o,r,h),Eo=!1;var _=e.memoizedState;o.state=_,Tg(e,r,o,i),c=e.memoizedState,u!==r||_!==c||Ar.current||Eo?(typeof p=="function"&&(zy(e,n,p,r),c=e.memoizedState),(u=Eo||nT(e,n,u,r,_,c,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=h,r=u):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,OI(t,e),u=e.memoizedProps,h=e.type===e.elementType?u:mi(e.type,u),o.props=h,m=e.pendingProps,_=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ri(c):(c=xr(n)?$a:rr.current,c=Pu(e,c));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==m||_!==c)&&rT(e,o,r,c),Eo=!1,_=e.memoizedState,o.state=_,Tg(e,r,o,i);var S=e.memoizedState;u!==m||_!==S||Ar.current||Eo?(typeof E=="function"&&(zy(e,n,E,r),S=e.memoizedState),(h=Eo||nT(e,n,h,r,_,S,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=c,r=h):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),r=!1)}return Wy(t,e,n,r,s,i)}function Wy(t,e,n,r,i,s){s6(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&K4(e,n,!1),Gs(t,e,s);r=e.stateNode,Dx.current=e;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ku(e,t.child,null,s),e.child=ku(e,null,u,s)):hr(t,e,u,s),e.memoizedState=r.state,i&&K4(e,n,!0),e.child}function o6(t){var e=t.stateNode;e.pendingContext?q4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&q4(t,e.context,!1),x2(t,e.containerInfo)}function cT(t,e,n,r,i){return Ru(),C2(i),e.flags|=256,hr(t,e,n,r),e.child}var Hy={dehydrated:null,treeContext:null,retryLane:0};function $y(t){return{baseLanes:t,cachePool:null,transitions:null}}function a6(t,e,n){var r=e.pendingProps,i=Dt.current,s=!1,o=(e.flags&128)!==0,u;if((u=o)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),St(Dt,i&1),t===null)return Vy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Am(o,r,0,null),t=Ga(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=$y(n),e.memoizedState=Hy,t):V2(e,o));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return Ox(t,e,o,r,u,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=zo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=zo(u,s):(s=Ga(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?$y(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Hy,r}return s=t.child,t=s.sibling,r=zo(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function V2(t,e){return e=Am({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wp(t,e,n,r){return r!==null&&C2(r),ku(e,t.child,null,n),t=V2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Ox(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Av(Error(ne(422))),wp(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Am({mode:"visible",children:r.children},i,0,null),s=Ga(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ku(e,t.child,null,o),e.child.memoizedState=$y(o),e.memoizedState=Hy,s);if(!(e.mode&1))return wp(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(ne(419)),r=Av(s,r,void 0),wp(t,e,o,r)}if(u=(o&t.childLanes)!==0,Pr||u){if(r=In,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,js(t,i),Ti(r,t,i,-1))}return W2(),r=Av(Error(ne(421))),wp(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=$x.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Lr=bo(i.nextSibling),br=e,kt=!0,vi=null,t!==null&&(Xr[Jr++]=ks,Xr[Jr++]=As,Xr[Jr++]=qa,ks=t.id,As=t.overflow,qa=e),e=V2(e,r.children),e.flags|=4096,e)}function hT(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Uy(t.return,e,n)}function xv(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function l6(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(hr(t,e,r.children,n),r=Dt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&hT(t,n,e);else if(t.tag===19)hT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(St(Dt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Cg(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),xv(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Cg(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}xv(e,!0,n,null,s);break;case"together":xv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $p(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=zo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=zo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Mx(t,e,n){switch(e.tag){case 3:o6(e),Ru();break;case 5:MI(e);break;case 1:xr(e.type)&&vg(e);break;case 4:x2(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;St(Eg,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(St(Dt,Dt.current&1),e.flags|=128,null):n&e.child.childLanes?a6(t,e,n):(St(Dt,Dt.current&1),t=Gs(t,e,n),t!==null?t.sibling:null);St(Dt,Dt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return l6(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),St(Dt,Dt.current),r)break;return null;case 22:case 23:return e.lanes=0,i6(t,e,n)}return Gs(t,e,n)}var u6,qy,c6,h6;u6=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qy=function(){};c6=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Va(Yi.current);var s=null;switch(n){case"input":i=gy(t,i),r=gy(t,r),s=[];break;case"select":i=Mt({},i,{value:void 0}),r=Mt({},r,{value:void 0}),s=[];break;case"textarea":i=vy(t,i),r=vy(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=mg)}wy(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var u=i[h];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Hh.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var c=r[h];if(u=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&c!==u&&(c!=null||u!=null))if(h==="style")if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Hh.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Ct("scroll",t),s||u===c||(s=[])):(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};h6=function(t,e,n,r){n!==r&&(e.flags|=4)};function sh(t,e){if(!kt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Jn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Lx(t,e,n){var r=e.pendingProps;switch(T2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jn(e),null;case 1:return xr(e.type)&&_g(),Jn(e),null;case 3:return r=e.stateNode,Au(),Pt(Ar),Pt(rr),D2(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vi!==null&&(t1(vi),vi=null))),qy(t,e),Jn(e),null;case 5:N2(e);var i=Va(rd.current);if(n=e.type,t!==null&&e.stateNode!=null)c6(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return Jn(e),null}if(t=Va(Yi.current),vp(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[qi]=e,r[td]=s,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",r),Ct("close",r);break;case"iframe":case"object":case"embed":Ct("load",r);break;case"video":case"audio":for(i=0;i<vh.length;i++)Ct(vh[i],r);break;case"source":Ct("error",r);break;case"img":case"image":case"link":Ct("error",r),Ct("load",r);break;case"details":Ct("toggle",r);break;case"input":w4(r,s),Ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ct("invalid",r);break;case"textarea":S4(r,s),Ct("invalid",r)}wy(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&_p(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&_p(r.textContent,u,t),i=["children",""+u]):Hh.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&Ct("scroll",r)}switch(n){case"input":up(r),E4(r,s,!0);break;case"textarea":up(r),T4(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=mg)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=U5(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[qi]=e,t[td]=r,u6(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ey(n,r),n){case"dialog":Ct("cancel",t),Ct("close",t),i=r;break;case"iframe":case"object":case"embed":Ct("load",t),i=r;break;case"video":case"audio":for(i=0;i<vh.length;i++)Ct(vh[i],t);i=r;break;case"source":Ct("error",t),i=r;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),i=r;break;case"details":Ct("toggle",t),i=r;break;case"input":w4(t,r),i=gy(t,r),Ct("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Mt({},r,{value:void 0}),Ct("invalid",t);break;case"textarea":S4(t,r),i=vy(t,r),Ct("invalid",t);break;default:i=r}wy(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var c=u[s];s==="style"?j5(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&z5(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&$h(t,c):typeof c=="number"&&$h(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Hh.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ct("scroll",t):c!=null&&l2(t,s,c,o))}switch(n){case"input":up(t),E4(t,r,!1);break;case"textarea":up(t),T4(t);break;case"option":r.value!=null&&t.setAttribute("value",""+qo(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?du(t,!!r.multiple,s,!1):r.defaultValue!=null&&du(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=mg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jn(e),null;case 6:if(t&&e.stateNode!=null)h6(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Va(rd.current),Va(Yi.current),vp(e)){if(r=e.stateNode,n=e.memoizedProps,r[qi]=e,(s=r.nodeValue!==n)&&(t=br,t!==null))switch(t.tag){case 3:_p(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&_p(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qi]=e,e.stateNode=r}return Jn(e),null;case 13:if(Pt(Dt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(kt&&Lr!==null&&e.mode&1&&!(e.flags&128))AI(),Ru(),e.flags|=98560,s=!1;else if(s=vp(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ne(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ne(317));s[qi]=e}else Ru(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jn(e),s=!1}else vi!==null&&(t1(vi),vi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?ln===0&&(ln=3):W2())),e.updateQueue!==null&&(e.flags|=4),Jn(e),null);case 4:return Au(),qy(t,e),t===null&&Zh(e.stateNode.containerInfo),Jn(e),null;case 10:return R2(e.type._context),Jn(e),null;case 17:return xr(e.type)&&_g(),Jn(e),null;case 19:if(Pt(Dt),s=e.memoizedState,s===null)return Jn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)sh(s,!1);else{if(ln!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Cg(t),o!==null){for(e.flags|=128,sh(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return St(Dt,Dt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ht()>Nu&&(e.flags|=128,r=!0,sh(s,!1),e.lanes=4194304)}else{if(!r)if(t=Cg(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),sh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!kt)return Jn(e),null}else 2*Ht()-s.renderingStartTime>Nu&&n!==1073741824&&(e.flags|=128,r=!0,sh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ht(),e.sibling=null,n=Dt.current,St(Dt,r?n&1|2:n&1),e):(Jn(e),null);case 22:case 23:return G2(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Or&1073741824&&(Jn(e),e.subtreeFlags&6&&(e.flags|=8192)):Jn(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function bx(t,e){switch(T2(e),e.tag){case 1:return xr(e.type)&&_g(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Au(),Pt(Ar),Pt(rr),D2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return N2(e),null;case 13:if(Pt(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));Ru()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pt(Dt),null;case 4:return Au(),null;case 10:return R2(e.type._context),null;case 22:case 23:return G2(),null;case 24:return null;default:return null}}var Ep=!1,tr=!1,Fx=typeof WeakSet=="function"?WeakSet:Set,pe=null;function uu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){bt(t,e,r)}else n.current=null}function Ky(t,e,n){try{n()}catch(r){bt(t,e,r)}}var dT=!1;function Vx(t,e){if(Ny=fg,t=mI(),E2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,u=-1,c=-1,h=0,p=0,m=t,_=null;t:for(;;){for(var E;m!==n||i!==0&&m.nodeType!==3||(u=o+i),m!==s||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(E=m.firstChild)!==null;)_=m,m=E;for(;;){if(m===t)break t;if(_===n&&++h===i&&(u=o),_===s&&++p===r&&(c=o),(E=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=E}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dy={focusedElem:t,selectionRange:n},fg=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var P=S.memoizedProps,N=S.memoizedState,R=e.stateNode,k=R.getSnapshotBeforeUpdate(e.elementType===e.type?P:mi(e.type,P),N);R.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(A){bt(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return S=dT,dT=!1,S}function Dh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ky(e,n,s)}i=i.next}while(i!==r)}}function Rm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Qy(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function d6(t){var e=t.alternate;e!==null&&(t.alternate=null,d6(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qi],delete e[td],delete e[Ly],delete e[wx],delete e[Ex])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function f6(t){return t.tag===5||t.tag===3||t.tag===4}function fT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||f6(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=mg));else if(r!==4&&(t=t.child,t!==null))for(Yy(t,e,n),t=t.sibling;t!==null;)Yy(t,e,n),t=t.sibling}function Xy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Xy(t,e,n),t=t.sibling;t!==null;)Xy(t,e,n),t=t.sibling}var Mn=null,_i=!1;function _o(t,e,n){for(n=n.child;n!==null;)p6(t,e,n),n=n.sibling}function p6(t,e,n){if(Qi&&typeof Qi.onCommitFiberUnmount=="function")try{Qi.onCommitFiberUnmount(ym,n)}catch{}switch(n.tag){case 5:tr||uu(n,e);case 6:var r=Mn,i=_i;Mn=null,_o(t,e,n),Mn=r,_i=i,Mn!==null&&(_i?(t=Mn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mn.removeChild(n.stateNode));break;case 18:Mn!==null&&(_i?(t=Mn,n=n.stateNode,t.nodeType===8?Tv(t.parentNode,n):t.nodeType===1&&Tv(t,n),Yh(t)):Tv(Mn,n.stateNode));break;case 4:r=Mn,i=_i,Mn=n.stateNode.containerInfo,_i=!0,_o(t,e,n),Mn=r,_i=i;break;case 0:case 11:case 14:case 15:if(!tr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ky(n,e,o),i=i.next}while(i!==r)}_o(t,e,n);break;case 1:if(!tr&&(uu(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){bt(n,e,u)}_o(t,e,n);break;case 21:_o(t,e,n);break;case 22:n.mode&1?(tr=(r=tr)||n.memoizedState!==null,_o(t,e,n),tr=r):_o(t,e,n);break;default:_o(t,e,n)}}function pT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Fx),e.forEach(function(r){var i=qx.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function pi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,u=o;e:for(;u!==null;){switch(u.tag){case 5:Mn=u.stateNode,_i=!1;break e;case 3:Mn=u.stateNode.containerInfo,_i=!0;break e;case 4:Mn=u.stateNode.containerInfo,_i=!0;break e}u=u.return}if(Mn===null)throw Error(ne(160));p6(s,o,i),Mn=null,_i=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(h){bt(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)g6(e,t),e=e.sibling}function g6(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pi(e,t),Hi(t),r&4){try{Dh(3,t,t.return),Rm(3,t)}catch(P){bt(t,t.return,P)}try{Dh(5,t,t.return)}catch(P){bt(t,t.return,P)}}break;case 1:pi(e,t),Hi(t),r&512&&n!==null&&uu(n,n.return);break;case 5:if(pi(e,t),Hi(t),r&512&&n!==null&&uu(n,n.return),t.flags&32){var i=t.stateNode;try{$h(i,"")}catch(P){bt(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&F5(i,s),Ey(u,o);var h=Ey(u,s);for(o=0;o<c.length;o+=2){var p=c[o],m=c[o+1];p==="style"?j5(i,m):p==="dangerouslySetInnerHTML"?z5(i,m):p==="children"?$h(i,m):l2(i,p,m,h)}switch(u){case"input":my(i,s);break;case"textarea":V5(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?du(i,!!s.multiple,E,!1):_!==!!s.multiple&&(s.defaultValue!=null?du(i,!!s.multiple,s.defaultValue,!0):du(i,!!s.multiple,s.multiple?[]:"",!1))}i[td]=s}catch(P){bt(t,t.return,P)}}break;case 6:if(pi(e,t),Hi(t),r&4){if(t.stateNode===null)throw Error(ne(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){bt(t,t.return,P)}}break;case 3:if(pi(e,t),Hi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yh(e.containerInfo)}catch(P){bt(t,t.return,P)}break;case 4:pi(e,t),Hi(t);break;case 13:pi(e,t),Hi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(B2=Ht())),r&4&&pT(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(tr=(h=tr)||p,pi(e,t),tr=h):pi(e,t),Hi(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(pe=t,p=t.child;p!==null;){for(m=pe=p;pe!==null;){switch(_=pe,E=_.child,_.tag){case 0:case 11:case 14:case 15:Dh(4,_,_.return);break;case 1:uu(_,_.return);var S=_.stateNode;if(typeof S.componentWillUnmount=="function"){r=_,n=_.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(P){bt(r,n,P)}}break;case 5:uu(_,_.return);break;case 22:if(_.memoizedState!==null){mT(m);continue}}E!==null?(E.return=_,pe=E):mT(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=B5("display",o))}catch(P){bt(t,t.return,P)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(P){bt(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:pi(e,t),Hi(t),r&4&&pT(t);break;case 21:break;default:pi(e,t),Hi(t)}}function Hi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(f6(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&($h(i,""),r.flags&=-33);var s=fT(t);Xy(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=fT(t);Yy(t,u,o);break;default:throw Error(ne(161))}}catch(c){bt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ux(t,e,n){pe=t,m6(t)}function m6(t,e,n){for(var r=(t.mode&1)!==0;pe!==null;){var i=pe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ep;if(!o){var u=i.alternate,c=u!==null&&u.memoizedState!==null||tr;u=Ep;var h=tr;if(Ep=o,(tr=c)&&!h)for(pe=i;pe!==null;)o=pe,c=o.child,o.tag===22&&o.memoizedState!==null?_T(i):c!==null?(c.return=o,pe=c):_T(i);for(;s!==null;)pe=s,m6(s),s=s.sibling;pe=i,Ep=u,tr=h}gT(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,pe=s):gT(t)}}function gT(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tr||Rm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!tr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:mi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Z4(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Z4(e,o,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&Yh(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}tr||e.flags&512&&Qy(e)}catch(_){bt(e,e.return,_)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function mT(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function _T(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Rm(4,e)}catch(c){bt(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){bt(e,i,c)}}var s=e.return;try{Qy(e)}catch(c){bt(e,s,c)}break;case 5:var o=e.return;try{Qy(e)}catch(c){bt(e,o,c)}}}catch(c){bt(e,e.return,c)}if(e===t){pe=null;break}var u=e.sibling;if(u!==null){u.return=e.return,pe=u;break}pe=e.return}}var zx=Math.ceil,Rg=Qs.ReactCurrentDispatcher,U2=Qs.ReactCurrentOwner,ni=Qs.ReactCurrentBatchConfig,tt=0,In=null,Jt=null,Vn=0,Or=0,cu=ra(0),ln=0,ad=null,Qa=0,km=0,z2=0,Oh=null,Ir=null,B2=0,Nu=1/0,Is=null,kg=!1,Jy=null,Vo=null,Sp=!1,ko=null,Ag=0,Mh=0,Zy=null,qp=-1,Kp=0;function dr(){return tt&6?Ht():qp!==-1?qp:qp=Ht()}function Uo(t){return t.mode&1?tt&2&&Vn!==0?Vn&-Vn:Tx.transition!==null?(Kp===0&&(Kp=eI()),Kp):(t=ct,t!==0||(t=window.event,t=t===void 0?16:aI(t.type)),t):1}function Ti(t,e,n,r){if(50<Mh)throw Mh=0,Zy=null,Error(ne(185));xd(t,n,r),(!(tt&2)||t!==In)&&(t===In&&(!(tt&2)&&(km|=n),ln===4&&To(t,Vn)),Nr(t,r),n===1&&tt===0&&!(e.mode&1)&&(Nu=Ht()+500,Cm&&ia()))}function Nr(t,e){var n=t.callbackNode;TA(t,e);var r=dg(t,t===In?Vn:0);if(r===0)n!==null&&P4(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&P4(n),e===1)t.tag===0?Sx(vT.bind(null,t)):PI(vT.bind(null,t)),vx(function(){!(tt&6)&&ia()}),n=null;else{switch(tI(r)){case 1:n=f2;break;case 4:n=J5;break;case 16:n=hg;break;case 536870912:n=Z5;break;default:n=hg}n=C6(n,_6.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function _6(t,e){if(qp=-1,Kp=0,tt&6)throw Error(ne(327));var n=t.callbackNode;if(_u()&&t.callbackNode!==n)return null;var r=dg(t,t===In?Vn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=xg(t,r);else{e=r;var i=tt;tt|=2;var s=y6();(In!==t||Vn!==e)&&(Is=null,Nu=Ht()+500,ja(t,e));do try{Gx();break}catch(u){v6(t,u)}while(!0);P2(),Rg.current=s,tt=i,Jt!==null?e=0:(In=null,Vn=0,e=ln)}if(e!==0){if(e===2&&(i=Py(t),i!==0&&(r=i,e=e1(t,i))),e===1)throw n=ad,ja(t,0),To(t,r),Nr(t,Ht()),n;if(e===6)To(t,r);else{if(i=t.current.alternate,!(r&30)&&!Bx(i)&&(e=xg(t,r),e===2&&(s=Py(t),s!==0&&(r=s,e=e1(t,s))),e===1))throw n=ad,ja(t,0),To(t,r),Nr(t,Ht()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:Oa(t,Ir,Is);break;case 3:if(To(t,r),(r&130023424)===r&&(e=B2+500-Ht(),10<e)){if(dg(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){dr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=My(Oa.bind(null,t,Ir,Is),e);break}Oa(t,Ir,Is);break;case 4:if(To(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Si(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zx(r/1960))-r,10<r){t.timeoutHandle=My(Oa.bind(null,t,Ir,Is),r);break}Oa(t,Ir,Is);break;case 5:Oa(t,Ir,Is);break;default:throw Error(ne(329))}}}return Nr(t,Ht()),t.callbackNode===n?_6.bind(null,t):null}function e1(t,e){var n=Oh;return t.current.memoizedState.isDehydrated&&(ja(t,e).flags|=256),t=xg(t,e),t!==2&&(e=Ir,Ir=n,e!==null&&t1(e)),t}function t1(t){Ir===null?Ir=t:Ir.push.apply(Ir,t)}function Bx(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ri(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function To(t,e){for(e&=~z2,e&=~km,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Si(e),r=1<<n;t[n]=-1,e&=~r}}function vT(t){if(tt&6)throw Error(ne(327));_u();var e=dg(t,0);if(!(e&1))return Nr(t,Ht()),null;var n=xg(t,e);if(t.tag!==0&&n===2){var r=Py(t);r!==0&&(e=r,n=e1(t,r))}if(n===1)throw n=ad,ja(t,0),To(t,e),Nr(t,Ht()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Oa(t,Ir,Is),Nr(t,Ht()),null}function j2(t,e){var n=tt;tt|=1;try{return t(e)}finally{tt=n,tt===0&&(Nu=Ht()+500,Cm&&ia())}}function Ya(t){ko!==null&&ko.tag===0&&!(tt&6)&&_u();var e=tt;tt|=1;var n=ni.transition,r=ct;try{if(ni.transition=null,ct=1,t)return t()}finally{ct=r,ni.transition=n,tt=e,!(tt&6)&&ia()}}function G2(){Or=cu.current,Pt(cu)}function ja(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_x(n)),Jt!==null)for(n=Jt.return;n!==null;){var r=n;switch(T2(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_g();break;case 3:Au(),Pt(Ar),Pt(rr),D2();break;case 5:N2(r);break;case 4:Au();break;case 13:Pt(Dt);break;case 19:Pt(Dt);break;case 10:R2(r.type._context);break;case 22:case 23:G2()}n=n.return}if(In=t,Jt=t=zo(t.current,null),Vn=Or=e,ln=0,ad=null,z2=km=Qa=0,Ir=Oh=null,Fa!==null){for(e=0;e<Fa.length;e++)if(n=Fa[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Fa=null}return t}function v6(t,e){do{var n=Jt;try{if(P2(),Wp.current=Pg,Ig){for(var r=Ot.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ig=!1}if(Ka=0,En=an=Ot=null,Nh=!1,id=0,U2.current=null,n===null||n.return===null){ln=1,ad=e,Jt=null;break}e:{var s=t,o=n.return,u=n,c=e;if(e=Vn,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=u,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=sT(o);if(E!==null){E.flags&=-257,oT(E,o,u,s,e),E.mode&1&&iT(s,h,e),e=E,c=h;var S=e.updateQueue;if(S===null){var P=new Set;P.add(c),e.updateQueue=P}else S.add(c);break e}else{if(!(e&1)){iT(s,h,e),W2();break e}c=Error(ne(426))}}else if(kt&&u.mode&1){var N=sT(o);if(N!==null){!(N.flags&65536)&&(N.flags|=256),oT(N,o,u,s,e),C2(xu(c,u));break e}}s=c=xu(c,u),ln!==4&&(ln=2),Oh===null?Oh=[s]:Oh.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var R=t6(s,c,e);J4(s,R);break e;case 1:u=c;var k=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Vo===null||!Vo.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var A=n6(s,u,e);J4(s,A);break e}}s=s.return}while(s!==null)}E6(n)}catch(V){e=V,Jt===n&&n!==null&&(Jt=n=n.return);continue}break}while(!0)}function y6(){var t=Rg.current;return Rg.current=Pg,t===null?Pg:t}function W2(){(ln===0||ln===3||ln===2)&&(ln=4),In===null||!(Qa&268435455)&&!(km&268435455)||To(In,Vn)}function xg(t,e){var n=tt;tt|=2;var r=y6();(In!==t||Vn!==e)&&(Is=null,ja(t,e));do try{jx();break}catch(i){v6(t,i)}while(!0);if(P2(),tt=n,Rg.current=r,Jt!==null)throw Error(ne(261));return In=null,Vn=0,ln}function jx(){for(;Jt!==null;)w6(Jt)}function Gx(){for(;Jt!==null&&!pA();)w6(Jt)}function w6(t){var e=T6(t.alternate,t,Or);t.memoizedProps=t.pendingProps,e===null?E6(t):Jt=e,U2.current=null}function E6(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=bx(n,e),n!==null){n.flags&=32767,Jt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ln=6,Jt=null;return}}else if(n=Lx(n,e,Or),n!==null){Jt=n;return}if(e=e.sibling,e!==null){Jt=e;return}Jt=e=t}while(e!==null);ln===0&&(ln=5)}function Oa(t,e,n){var r=ct,i=ni.transition;try{ni.transition=null,ct=1,Wx(t,e,n,r)}finally{ni.transition=i,ct=r}return null}function Wx(t,e,n,r){do _u();while(ko!==null);if(tt&6)throw Error(ne(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(CA(t,s),t===In&&(Jt=In=null,Vn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sp||(Sp=!0,C6(hg,function(){return _u(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ni.transition,ni.transition=null;var o=ct;ct=1;var u=tt;tt|=4,U2.current=null,Vx(t,n),g6(n,t),cx(Dy),fg=!!Ny,Dy=Ny=null,t.current=n,Ux(n),gA(),tt=u,ct=o,ni.transition=s}else t.current=n;if(Sp&&(Sp=!1,ko=t,Ag=i),s=t.pendingLanes,s===0&&(Vo=null),vA(n.stateNode),Nr(t,Ht()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(kg)throw kg=!1,t=Jy,Jy=null,t;return Ag&1&&t.tag!==0&&_u(),s=t.pendingLanes,s&1?t===Zy?Mh++:(Mh=0,Zy=t):Mh=0,ia(),null}function _u(){if(ko!==null){var t=tI(Ag),e=ni.transition,n=ct;try{if(ni.transition=null,ct=16>t?16:t,ko===null)var r=!1;else{if(t=ko,ko=null,Ag=0,tt&6)throw Error(ne(331));var i=tt;for(tt|=4,pe=t.current;pe!==null;){var s=pe,o=s.child;if(pe.flags&16){var u=s.deletions;if(u!==null){for(var c=0;c<u.length;c++){var h=u[c];for(pe=h;pe!==null;){var p=pe;switch(p.tag){case 0:case 11:case 15:Dh(8,p,s)}var m=p.child;if(m!==null)m.return=p,pe=m;else for(;pe!==null;){p=pe;var _=p.sibling,E=p.return;if(d6(p),p===h){pe=null;break}if(_!==null){_.return=E,pe=_;break}pe=E}}}var S=s.alternate;if(S!==null){var P=S.child;if(P!==null){S.child=null;do{var N=P.sibling;P.sibling=null,P=N}while(P!==null)}}pe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,pe=o;else e:for(;pe!==null;){if(s=pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Dh(9,s,s.return)}var R=s.sibling;if(R!==null){R.return=s.return,pe=R;break e}pe=s.return}}var k=t.current;for(pe=k;pe!==null;){o=pe;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,pe=w;else e:for(o=k;pe!==null;){if(u=pe,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Rm(9,u)}}catch(V){bt(u,u.return,V)}if(u===o){pe=null;break e}var A=u.sibling;if(A!==null){A.return=u.return,pe=A;break e}pe=u.return}}if(tt=i,ia(),Qi&&typeof Qi.onPostCommitFiberRoot=="function")try{Qi.onPostCommitFiberRoot(ym,t)}catch{}r=!0}return r}finally{ct=n,ni.transition=e}}return!1}function yT(t,e,n){e=xu(n,e),e=t6(t,e,1),t=Fo(t,e,1),e=dr(),t!==null&&(xd(t,1,e),Nr(t,e))}function bt(t,e,n){if(t.tag===3)yT(t,t,n);else for(;e!==null;){if(e.tag===3){yT(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vo===null||!Vo.has(r))){t=xu(n,t),t=n6(e,t,1),e=Fo(e,t,1),t=dr(),e!==null&&(xd(e,1,t),Nr(e,t));break}}e=e.return}}function Hx(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=dr(),t.pingedLanes|=t.suspendedLanes&n,In===t&&(Vn&n)===n&&(ln===4||ln===3&&(Vn&130023424)===Vn&&500>Ht()-B2?ja(t,0):z2|=n),Nr(t,e)}function S6(t,e){e===0&&(t.mode&1?(e=dp,dp<<=1,!(dp&130023424)&&(dp=4194304)):e=1);var n=dr();t=js(t,e),t!==null&&(xd(t,e,n),Nr(t,n))}function $x(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),S6(t,n)}function qx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),S6(t,n)}var T6;T6=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ar.current)Pr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Pr=!1,Mx(t,e,n);Pr=!!(t.flags&131072)}else Pr=!1,kt&&e.flags&1048576&&RI(e,wg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$p(t,e),t=e.pendingProps;var i=Pu(e,rr.current);mu(e,n),i=M2(null,e,r,t,i,n);var s=L2();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xr(r)?(s=!0,vg(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,A2(e),i.updater=Pm,e.stateNode=i,i._reactInternals=e,By(e,r,t,n),e=Wy(null,e,r,!0,s,n)):(e.tag=0,kt&&s&&S2(e),hr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch($p(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Qx(r),t=mi(r,t),i){case 0:e=Gy(null,e,r,t,n);break e;case 1:e=uT(null,e,r,t,n);break e;case 11:e=aT(null,e,r,t,n);break e;case 14:e=lT(null,e,r,mi(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),Gy(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),uT(t,e,r,i,n);case 3:e:{if(o6(e),t===null)throw Error(ne(387));r=e.pendingProps,s=e.memoizedState,i=s.element,OI(t,e),Tg(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=xu(Error(ne(423)),e),e=cT(t,e,r,n,i);break e}else if(r!==i){i=xu(Error(ne(424)),e),e=cT(t,e,r,n,i);break e}else for(Lr=bo(e.stateNode.containerInfo.firstChild),br=e,kt=!0,vi=null,n=NI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ru(),r===i){e=Gs(t,e,n);break e}hr(t,e,r,n)}e=e.child}return e;case 5:return MI(e),t===null&&Vy(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Oy(r,i)?o=null:s!==null&&Oy(r,s)&&(e.flags|=32),s6(t,e),hr(t,e,o,n),e.child;case 6:return t===null&&Vy(e),null;case 13:return a6(t,e,n);case 4:return x2(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ku(e,null,r,n):hr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),aT(t,e,r,i,n);case 7:return hr(t,e,e.pendingProps,n),e.child;case 8:return hr(t,e,e.pendingProps.children,n),e.child;case 12:return hr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,St(Eg,r._currentValue),r._currentValue=o,s!==null)if(Ri(s.value,o)){if(s.children===i.children&&!Ar.current){e=Gs(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var u=s.dependencies;if(u!==null){o=s.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=Ls(-1,n&-n),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Uy(s.return,n,e),u.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ne(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Uy(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}hr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,mu(e,n),i=ri(i),r=r(i),e.flags|=1,hr(t,e,r,n),e.child;case 14:return r=e.type,i=mi(r,e.pendingProps),i=mi(r.type,i),lT(t,e,r,i,n);case 15:return r6(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:mi(r,i),$p(t,e),e.tag=1,xr(r)?(t=!0,vg(e)):t=!1,mu(e,n),e6(e,r,i),By(e,r,i,n),Wy(null,e,r,!0,t,n);case 19:return l6(t,e,n);case 22:return i6(t,e,n)}throw Error(ne(156,e.tag))};function C6(t,e){return X5(t,e)}function Kx(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(t,e,n,r){return new Kx(t,e,n,r)}function H2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Qx(t){if(typeof t=="function")return H2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===c2)return 11;if(t===h2)return 14}return 2}function zo(t,e){var n=t.alternate;return n===null?(n=ei(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qp(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")H2(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case eu:return Ga(n.children,i,s,e);case u2:o=8,i|=8;break;case hy:return t=ei(12,n,e,i|2),t.elementType=hy,t.lanes=s,t;case dy:return t=ei(13,n,e,i),t.elementType=dy,t.lanes=s,t;case fy:return t=ei(19,n,e,i),t.elementType=fy,t.lanes=s,t;case M5:return Am(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case D5:o=10;break e;case O5:o=9;break e;case c2:o=11;break e;case h2:o=14;break e;case wo:o=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=ei(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ga(t,e,n,r){return t=ei(7,t,r,e),t.lanes=n,t}function Am(t,e,n,r){return t=ei(22,t,r,e),t.elementType=M5,t.lanes=n,t.stateNode={isHidden:!1},t}function Nv(t,e,n){return t=ei(6,t,null,e),t.lanes=n,t}function Dv(t,e,n){return e=ei(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Yx(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dv(0),this.expirationTimes=dv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dv(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $2(t,e,n,r,i,s,o,u,c){return t=new Yx(t,e,n,u,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ei(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},A2(s),t}function Xx(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function I6(t){if(!t)return Ko;t=t._reactInternals;e:{if(ll(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(xr(n))return II(t,n,e)}return e}function P6(t,e,n,r,i,s,o,u,c){return t=$2(n,r,!0,t,i,s,o,u,c),t.context=I6(null),n=t.current,r=dr(),i=Uo(n),s=Ls(r,i),s.callback=e??null,Fo(n,s,i),t.current.lanes=i,xd(t,i,r),Nr(t,r),t}function xm(t,e,n,r){var i=e.current,s=dr(),o=Uo(i);return n=I6(n),e.context===null?e.context=n:e.pendingContext=n,e=Ls(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Fo(i,e,o),t!==null&&(Ti(t,i,o,s),Gp(t,i,o)),o}function Ng(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function q2(t,e){wT(t,e),(t=t.alternate)&&wT(t,e)}function Jx(){return null}var R6=typeof reportError=="function"?reportError:function(t){console.error(t)};function K2(t){this._internalRoot=t}Nm.prototype.render=K2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));xm(t,e,null,null)};Nm.prototype.unmount=K2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ya(function(){xm(null,t,null,null)}),e[Bs]=null}};function Nm(t){this._internalRoot=t}Nm.prototype.unstable_scheduleHydration=function(t){if(t){var e=iI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<So.length&&e!==0&&e<So[n].priority;n++);So.splice(n,0,t),n===0&&oI(t)}};function Q2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ET(){}function Zx(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=Ng(o);s.call(h)}}var o=P6(e,r,t,0,null,!1,!1,"",ET);return t._reactRootContainer=o,t[Bs]=o.current,Zh(t.nodeType===8?t.parentNode:t),Ya(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var h=Ng(c);u.call(h)}}var c=$2(t,0,!1,null,null,!1,!1,"",ET);return t._reactRootContainer=c,t[Bs]=c.current,Zh(t.nodeType===8?t.parentNode:t),Ya(function(){xm(e,c,n,r)}),c}function Om(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var u=i;i=function(){var c=Ng(o);u.call(c)}}xm(e,o,t,i)}else o=Zx(n,e,t,i,r);return Ng(o)}nI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_h(e.pendingLanes);n!==0&&(p2(e,n|1),Nr(e,Ht()),!(tt&6)&&(Nu=Ht()+500,ia()))}break;case 13:Ya(function(){var r=js(t,1);if(r!==null){var i=dr();Ti(r,t,1,i)}}),q2(t,1)}};g2=function(t){if(t.tag===13){var e=js(t,134217728);if(e!==null){var n=dr();Ti(e,t,134217728,n)}q2(t,134217728)}};rI=function(t){if(t.tag===13){var e=Uo(t),n=js(t,e);if(n!==null){var r=dr();Ti(n,t,e,r)}q2(t,e)}};iI=function(){return ct};sI=function(t,e){var n=ct;try{return ct=t,e()}finally{ct=n}};Ty=function(t,e,n){switch(e){case"input":if(my(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Tm(r);if(!i)throw Error(ne(90));b5(r),my(r,i)}}}break;case"textarea":V5(t,n);break;case"select":e=n.value,e!=null&&du(t,!!n.multiple,e,!1)}};H5=j2;$5=Ya;var e7={usingClientEntryPoint:!1,Events:[Dd,iu,Tm,G5,W5,j2]},oh={findFiberByHostInstance:ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t7={bundleType:oh.bundleType,version:oh.version,rendererPackageName:oh.rendererPackageName,rendererConfig:oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Q5(t),t===null?null:t.stateNode},findFiberByHostInstance:oh.findFiberByHostInstance||Jx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tp.isDisabled&&Tp.supportsFiber)try{ym=Tp.inject(t7),Qi=Tp}catch{}}Ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e7;Ur.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q2(e))throw Error(ne(200));return Xx(t,e,null,n)};Ur.createRoot=function(t,e){if(!Q2(t))throw Error(ne(299));var n=!1,r="",i=R6;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=$2(t,1,!1,null,null,n,!1,r,i),t[Bs]=e.current,Zh(t.nodeType===8?t.parentNode:t),new K2(e)};Ur.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=Q5(e),t=t===null?null:t.stateNode,t};Ur.flushSync=function(t){return Ya(t)};Ur.hydrate=function(t,e,n){if(!Dm(e))throw Error(ne(200));return Om(null,t,e,!0,n)};Ur.hydrateRoot=function(t,e,n){if(!Q2(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=R6;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=P6(e,null,t,1,n??null,i,!1,s,o),t[Bs]=e.current,Zh(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Nm(e)};Ur.render=function(t,e,n){if(!Dm(e))throw Error(ne(200));return Om(null,t,e,!1,n)};Ur.unmountComponentAtNode=function(t){if(!Dm(t))throw Error(ne(40));return t._reactRootContainer?(Ya(function(){Om(null,null,t,!1,function(){t._reactRootContainer=null,t[Bs]=null})}),!0):!1};Ur.unstable_batchedUpdates=j2;Ur.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Dm(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Om(t,e,n,!1,r)};Ur.version="18.3.1-next-f1338f8080-20240426";function k6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k6)}catch(t){console.error(t)}}k6(),k5.exports=Ur;var n7=k5.exports,ST=n7;uy.createRoot=ST.createRoot,uy.hydrateRoot=ST.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ld(){return ld=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ld.apply(this,arguments)}var Ao;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ao||(Ao={}));const TT="popstate";function r7(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:u}=r.location;return n1("",{pathname:s,search:o,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Dg(i)}return s7(e,n,null,t)}function $t(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function A6(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function i7(){return Math.random().toString(36).substr(2,8)}function CT(t,e){return{usr:t.state,key:t.key,idx:e}}function n1(t,e,n,r){return n===void 0&&(n=null),ld({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Zu(e):e,{state:n,key:e&&e.key||r||i7()})}function Dg(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Zu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function s7(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,u=Ao.Pop,c=null,h=p();h==null&&(h=0,o.replaceState(ld({},o.state,{idx:h}),""));function p(){return(o.state||{idx:null}).idx}function m(){u=Ao.Pop;let N=p(),R=N==null?null:N-h;h=N,c&&c({action:u,location:P.location,delta:R})}function _(N,R){u=Ao.Push;let k=n1(P.location,N,R);h=p()+1;let w=CT(k,h),A=P.createHref(k);try{o.pushState(w,"",A)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;i.location.assign(A)}s&&c&&c({action:u,location:P.location,delta:1})}function E(N,R){u=Ao.Replace;let k=n1(P.location,N,R);h=p();let w=CT(k,h),A=P.createHref(k);o.replaceState(w,"",A),s&&c&&c({action:u,location:P.location,delta:0})}function S(N){let R=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof N=="string"?N:Dg(N);return k=k.replace(/ $/,"%20"),$t(R,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,R)}let P={get action(){return u},get location(){return t(i,o)},listen(N){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(TT,m),c=N,()=>{i.removeEventListener(TT,m),c=null}},createHref(N){return e(i,N)},createURL:S,encodeLocation(N){let R=S(N);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:_,replace:E,go(N){return o.go(N)}};return P}var IT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(IT||(IT={}));function o7(t,e,n){return n===void 0&&(n="/"),a7(t,e,n)}function a7(t,e,n,r){let i=typeof e=="string"?Zu(e):e,s=Y2(i.pathname||"/",n);if(s==null)return null;let o=x6(t);l7(o);let u=null;for(let c=0;u==null&&c<o.length;++c){let h=w7(s);u=_7(o[c],h)}return u}function x6(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,u)=>{let c={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&($t(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let h=Bo([r,c.relativePath]),p=n.concat(c);s.children&&s.children.length>0&&($t(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),x6(s.children,e,p,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:g7(h,s.index),routesMeta:p})};return t.forEach((s,o)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))i(s,o);else for(let c of N6(s.path))i(s,o,c)}),e}function N6(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=N6(r.join("/")),u=[];return u.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&u.push(...o),u.map(c=>t.startsWith("/")&&c===""?"/":c)}function l7(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:m7(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const u7=/^:[\w-]+$/,c7=3,h7=2,d7=1,f7=10,p7=-2,PT=t=>t==="*";function g7(t,e){let n=t.split("/"),r=n.length;return n.some(PT)&&(r+=p7),e&&(r+=h7),n.filter(i=>!PT(i)).reduce((i,s)=>i+(u7.test(s)?c7:s===""?d7:f7),r)}function m7(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function _7(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let u=0;u<r.length;++u){let c=r[u],h=u===r.length-1,p=s==="/"?e:e.slice(s.length)||"/",m=v7({path:c.relativePath,caseSensitive:c.caseSensitive,end:h},p),_=c.route;if(!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:Bo([s,m.pathname]),pathnameBase:C7(Bo([s,m.pathnameBase])),route:_}),m.pathnameBase!=="/"&&(s=Bo([s,m.pathnameBase]))}return o}function v7(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=y7(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:r.reduce((h,p,m)=>{let{paramName:_,isOptional:E}=p;if(_==="*"){let P=u[m]||"";o=s.slice(0,s.length-P.length).replace(/(.)\/+$/,"$1")}const S=u[m];return E&&!S?h[_]=void 0:h[_]=(S||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:t}}function y7(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),A6(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,c)=>(r.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function w7(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return A6(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Y2(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function E7(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Zu(t):t;return{pathname:n?n.startsWith("/")?n:S7(n,e):e,search:I7(r),hash:P7(i)}}function S7(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Ov(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function T7(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function X2(t,e){let n=T7(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function J2(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Zu(t):(i=ld({},t),$t(!i.pathname||!i.pathname.includes("?"),Ov("?","pathname","search",i)),$t(!i.pathname||!i.pathname.includes("#"),Ov("#","pathname","hash",i)),$t(!i.search||!i.search.includes("#"),Ov("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,u;if(o==null)u=n;else{let m=e.length-1;if(!r&&o.startsWith("..")){let _=o.split("/");for(;_[0]==="..";)_.shift(),m-=1;i.pathname=_.join("/")}u=m>=0?e[m]:"/"}let c=E7(i,u),h=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(h||p)&&(c.pathname+="/"),c}const Bo=t=>t.join("/").replace(/\/\/+/g,"/"),C7=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),I7=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,P7=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function R7(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const D6=["post","put","patch","delete"];new Set(D6);const k7=["get",...D6];new Set(k7);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ud(){return ud=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ud.apply(this,arguments)}const Z2=X.createContext(null),A7=X.createContext(null),sa=X.createContext(null),Mm=X.createContext(null),Ys=X.createContext({outlet:null,matches:[],isDataRoute:!1}),O6=X.createContext(null);function x7(t,e){let{relative:n}=e===void 0?{}:e;ec()||$t(!1);let{basename:r,navigator:i}=X.useContext(sa),{hash:s,pathname:o,search:u}=L6(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Bo([r,o])),i.createHref({pathname:c,search:u,hash:s})}function ec(){return X.useContext(Mm)!=null}function Md(){return ec()||$t(!1),X.useContext(Mm).location}function M6(t){X.useContext(sa).static||X.useLayoutEffect(t)}function Ld(){let{isDataRoute:t}=X.useContext(Ys);return t?W7():N7()}function N7(){ec()||$t(!1);let t=X.useContext(Z2),{basename:e,future:n,navigator:r}=X.useContext(sa),{matches:i}=X.useContext(Ys),{pathname:s}=Md(),o=JSON.stringify(X2(i,n.v7_relativeSplatPath)),u=X.useRef(!1);return M6(()=>{u.current=!0}),X.useCallback(function(h,p){if(p===void 0&&(p={}),!u.current)return;if(typeof h=="number"){r.go(h);return}let m=J2(h,JSON.parse(o),s,p.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Bo([e,m.pathname])),(p.replace?r.replace:r.push)(m,p.state,p)},[e,r,o,s,t])}function D7(){let{matches:t}=X.useContext(Ys),e=t[t.length-1];return e?e.params:{}}function L6(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=X.useContext(sa),{matches:i}=X.useContext(Ys),{pathname:s}=Md(),o=JSON.stringify(X2(i,r.v7_relativeSplatPath));return X.useMemo(()=>J2(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function O7(t,e){return M7(t,e)}function M7(t,e,n,r){ec()||$t(!1);let{navigator:i,static:s}=X.useContext(sa),{matches:o}=X.useContext(Ys),u=o[o.length-1],c=u?u.params:{};u&&u.pathname;let h=u?u.pathnameBase:"/";u&&u.route;let p=Md(),m;if(e){var _;let R=typeof e=="string"?Zu(e):e;h==="/"||(_=R.pathname)!=null&&_.startsWith(h)||$t(!1),m=R}else m=p;let E=m.pathname||"/",S=E;if(h!=="/"){let R=h.replace(/^\//,"").split("/");S="/"+E.replace(/^\//,"").split("/").slice(R.length).join("/")}let P=o7(t,{pathname:S}),N=U7(P&&P.map(R=>Object.assign({},R,{params:Object.assign({},c,R.params),pathname:Bo([h,i.encodeLocation?i.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?h:Bo([h,i.encodeLocation?i.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),o,n,r);return e&&N?X.createElement(Mm.Provider,{value:{location:ud({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Ao.Pop}},N):N}function L7(){let t=G7(),e=R7(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),n?X.createElement("pre",{style:i},n):null,null)}const b7=X.createElement(L7,null);class F7 extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?X.createElement(Ys.Provider,{value:this.props.routeContext},X.createElement(O6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function V7(t){let{routeContext:e,match:n,children:r}=t,i=X.useContext(Z2);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),X.createElement(Ys.Provider,{value:e},r)}function U7(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,u=(i=n)==null?void 0:i.errors;if(u!=null){let p=o.findIndex(m=>m.route.id&&(u==null?void 0:u[m.route.id])!==void 0);p>=0||$t(!1),o=o.slice(0,Math.min(o.length,p+1))}let c=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let p=0;p<o.length;p++){let m=o[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=p),m.route.id){let{loaderData:_,errors:E}=n,S=m.route.loader&&_[m.route.id]===void 0&&(!E||E[m.route.id]===void 0);if(m.route.lazy||S){c=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((p,m,_)=>{let E,S=!1,P=null,N=null;n&&(E=u&&m.route.id?u[m.route.id]:void 0,P=m.route.errorElement||b7,c&&(h<0&&_===0?(H7("route-fallback"),S=!0,N=null):h===_&&(S=!0,N=m.route.hydrateFallbackElement||null)));let R=e.concat(o.slice(0,_+1)),k=()=>{let w;return E?w=P:S?w=N:m.route.Component?w=X.createElement(m.route.Component,null):m.route.element?w=m.route.element:w=p,X.createElement(V7,{match:m,routeContext:{outlet:p,matches:R,isDataRoute:n!=null},children:w})};return n&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?X.createElement(F7,{location:n.location,revalidation:n.revalidation,component:P,error:E,children:k(),routeContext:{outlet:null,matches:R,isDataRoute:!0}}):k()},null)}var b6=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(b6||{}),F6=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(F6||{});function z7(t){let e=X.useContext(Z2);return e||$t(!1),e}function B7(t){let e=X.useContext(A7);return e||$t(!1),e}function j7(t){let e=X.useContext(Ys);return e||$t(!1),e}function V6(t){let e=j7(),n=e.matches[e.matches.length-1];return n.route.id||$t(!1),n.route.id}function G7(){var t;let e=X.useContext(O6),n=B7(),r=V6();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function W7(){let{router:t}=z7(b6.UseNavigateStable),e=V6(F6.UseNavigateStable),n=X.useRef(!1);return M6(()=>{n.current=!0}),X.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,ud({fromRouteId:e},s)))},[t,e])}const RT={};function H7(t,e,n){RT[t]||(RT[t]=!0)}function $7(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function kT(t){let{to:e,replace:n,state:r,relative:i}=t;ec()||$t(!1);let{future:s,static:o}=X.useContext(sa),{matches:u}=X.useContext(Ys),{pathname:c}=Md(),h=Ld(),p=J2(e,X2(u,s.v7_relativeSplatPath),c,i==="path"),m=JSON.stringify(p);return X.useEffect(()=>h(JSON.parse(m),{replace:n,state:r,relative:i}),[h,m,i,n,r]),null}function yh(t){$t(!1)}function q7(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Ao.Pop,navigator:s,static:o=!1,future:u}=t;ec()&&$t(!1);let c=e.replace(/^\/*/,"/"),h=X.useMemo(()=>({basename:c,navigator:s,static:o,future:ud({v7_relativeSplatPath:!1},u)}),[c,u,s,o]);typeof r=="string"&&(r=Zu(r));let{pathname:p="/",search:m="",hash:_="",state:E=null,key:S="default"}=r,P=X.useMemo(()=>{let N=Y2(p,c);return N==null?null:{location:{pathname:N,search:m,hash:_,state:E,key:S},navigationType:i}},[c,p,m,_,E,S,i]);return P==null?null:X.createElement(sa.Provider,{value:h},X.createElement(Mm.Provider,{children:n,value:P}))}function K7(t){let{children:e,location:n}=t;return O7(r1(e),n)}new Promise(()=>{});function r1(t,e){e===void 0&&(e=[]);let n=[];return X.Children.forEach(t,(r,i)=>{if(!X.isValidElement(r))return;let s=[...e,i];if(r.type===X.Fragment){n.push.apply(n,r1(r.props.children,s));return}r.type!==yh&&$t(!1),!r.props.index||!r.props.children||$t(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=r1(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function i1(){return i1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i1.apply(this,arguments)}function Q7(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Y7(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function X7(t,e){return t.button===0&&(!e||e==="_self")&&!Y7(t)}const J7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Z7="6";try{window.__reactRouterVersion=Z7}catch{}const eN="startTransition",AT=$k[eN];function tN(t){let{basename:e,children:n,future:r,window:i}=t,s=X.useRef();s.current==null&&(s.current=r7({window:i,v5Compat:!0}));let o=s.current,[u,c]=X.useState({action:o.action,location:o.location}),{v7_startTransition:h}=r||{},p=X.useCallback(m=>{h&&AT?AT(()=>c(m)):c(m)},[c,h]);return X.useLayoutEffect(()=>o.listen(p),[o,p]),X.useEffect(()=>$7(r),[r]),X.createElement(q7,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:o,future:r})}const nN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xo=X.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:u,target:c,to:h,preventScrollReset:p,viewTransition:m}=e,_=Q7(e,J7),{basename:E}=X.useContext(sa),S,P=!1;if(typeof h=="string"&&rN.test(h)&&(S=h,nN))try{let w=new URL(window.location.href),A=h.startsWith("//")?new URL(w.protocol+h):new URL(h),V=Y2(A.pathname,E);A.origin===w.origin&&V!=null?h=V+A.search+A.hash:P=!0}catch{}let N=x7(h,{relative:i}),R=iN(h,{replace:o,state:u,target:c,preventScrollReset:p,relative:i,viewTransition:m});function k(w){r&&r(w),w.defaultPrevented||R(w)}return X.createElement("a",i1({},_,{href:S||N,onClick:P||s?r:k,ref:n,target:c}))});var xT;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(xT||(xT={}));var NT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(NT||(NT={}));function iN(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:u}=e===void 0?{}:e,c=Ld(),h=Md(),p=L6(t,{relative:o});return X.useCallback(m=>{if(X7(m,n)){m.preventDefault();let _=r!==void 0?r:Dg(h)===Dg(p);c(t,{replace:_,state:i,preventScrollReset:s,relative:o,viewTransition:u})}},[h,c,p,r,i,n,t,s,o,u])}var DT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae=function(t,e){if(!t)throw tc(e)},tc=function(t){return new Error("Firebase Database ("+U6.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},sN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],u=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},ew={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,u=o?t[i+1]:0,c=i+2<t.length,h=c?t[i+2]:0,p=s>>2,m=(s&3)<<4|u>>4;let _=(u&15)<<2|h>>6,E=h&63;c||(E=64,o||(_=64)),r.push(n[p],n[m],n[_],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(z6(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const h=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||u==null||h==null||m==null)throw new oN;const _=s<<2|u>>4;if(r.push(_),h!==64){const E=u<<4&240|h>>2;if(r.push(E),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class oN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const B6=function(t){const e=z6(t);return ew.encodeByteArray(e,!0)},Og=function(t){return B6(t).replace(/\./g,"")},Mg=function(t){try{return ew.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(t){return j6(void 0,t)}function j6(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!lN(n)||(t[n]=j6(t[n],e[n]));return t}function lN(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN=()=>uN().__FIREBASE_DEFAULTS__,hN=()=>{if(typeof process>"u"||typeof DT>"u")return;const t=DT.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},dN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Mg(t[1]);return e&&JSON.parse(e)},Lm=()=>{try{return cN()||hN()||dN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},G6=t=>{var e,n;return(n=(e=Lm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},W6=t=>{const e=G6(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},H6=()=>{var t;return(t=Lm())===null||t===void 0?void 0:t.config},$6=t=>{var e;return(e=Lm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Og(JSON.stringify(n)),Og(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ir())}function fN(){var t;const e=(t=Lm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function K6(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mN(){const t=ir();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _N(){return U6.NODE_ADMIN===!0}function vN(){return!fN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function yN(){try{return typeof indexedDB=="object"}catch{return!1}}function wN(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="FirebaseError";class Xs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=EN,Object.setPrototypeOf(this,Xs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fd.prototype.create)}}class Fd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?SN(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new Xs(i,u,r)}}function SN(t,e){return t.replace(TN,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const TN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){return JSON.parse(t)}function Cn(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=cd(Mg(s[0])||""),n=cd(Mg(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},CN=function(t){const e=Q6(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},IN=function(t){const e=Q6(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Du(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function s1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Lg(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function bg(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(OT(s)&&OT(o)){if(!bg(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function OT(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let m=0;m<16;m++)r[m]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let m=0;m<16;m++)r[m]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let m=16;m<80;m++){const _=r[m-3]^r[m-8]^r[m-14]^r[m-16];r[m]=(_<<1|_>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],u=this.chain_[3],c=this.chain_[4],h,p;for(let m=0;m<80;m++){m<40?m<20?(h=u^s&(o^u),p=1518500249):(h=s^o^u,p=1859775393):m<60?(h=s&o|u&(s|o),p=2400959708):(h=s^o^u,p=3395469782);const _=(i<<5|i>>>27)+h+c+p+r[m]&4294967295;c=u,u=o,o=(s<<30|s>>>2)&4294967295,s=i,i=_}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function RN(t,e){const n=new kN(t,e);return n.subscribe.bind(n)}class kN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");AN(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Mv),i.error===void 0&&(i.error=Mv),i.complete===void 0&&(i.complete=Mv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function AN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Mv(){}function bm(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,ae(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Fm=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(t){return t&&t._delegate?t._delegate:t}class Qo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new bd;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ON(e))try{this.getOrInitializeService({instanceIdentifier:Ma})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ma){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ma){return this.instances.has(e)}getOptions(e=Ma){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:DN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ma){return this.component?this.component.multipleInstances?e:Ma:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DN(t){return t===Ma?void 0:t}function ON(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new NN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ke||(Ke={}));const LN={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},bN=Ke.INFO,FN={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},VN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=FN[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vm{constructor(e){this.name=e,this._logLevel=bN,this._logHandler=VN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const UN=(t,e)=>e.some(n=>t instanceof n);let MT,LT;function zN(){return MT||(MT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BN(){return LT||(LT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Y6=new WeakMap,o1=new WeakMap,X6=new WeakMap,Lv=new WeakMap,nw=new WeakMap;function jN(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(jo(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Y6.set(n,t)}).catch(()=>{}),nw.set(e,t),e}function GN(t){if(o1.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});o1.set(t,e)}let a1={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return o1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||X6.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return jo(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function WN(t){a1=t(a1)}function HN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(bv(this),e,...n);return X6.set(r,e.sort?e.sort():[e]),jo(r)}:BN().includes(t)?function(...e){return t.apply(bv(this),e),jo(Y6.get(this))}:function(...e){return jo(t.apply(bv(this),e))}}function $N(t){return typeof t=="function"?HN(t):(t instanceof IDBTransaction&&GN(t),UN(t,zN())?new Proxy(t,a1):t)}function jo(t){if(t instanceof IDBRequest)return jN(t);if(Lv.has(t))return Lv.get(t);const e=$N(t);return e!==t&&(Lv.set(t,e),nw.set(e,t)),e}const bv=t=>nw.get(t);function qN(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),u=jo(o);return r&&o.addEventListener("upgradeneeded",c=>{r(jo(o.result),c.oldVersion,c.newVersion,jo(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const KN=["get","getKey","getAll","getAllKeys","count"],QN=["put","add","delete","clear"],Fv=new Map;function bT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fv.get(e))return Fv.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=QN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||KN.includes(n)))return;const s=async function(o,...u){const c=this.transaction(o,i?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(u.shift())),(await Promise.all([h[n](...u),i&&c.done]))[0]};return Fv.set(e,s),s}WN(t=>({...t,get:(e,n,r)=>bT(e,n)||t.get(e,n,r),has:(e,n)=>!!bT(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(XN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function XN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const l1="@firebase/app",FT="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=new Vm("@firebase/app"),JN="@firebase/app-compat",ZN="@firebase/analytics-compat",eD="@firebase/analytics",tD="@firebase/app-check-compat",nD="@firebase/app-check",rD="@firebase/auth",iD="@firebase/auth-compat",sD="@firebase/database",oD="@firebase/data-connect",aD="@firebase/database-compat",lD="@firebase/functions",uD="@firebase/functions-compat",cD="@firebase/installations",hD="@firebase/installations-compat",dD="@firebase/messaging",fD="@firebase/messaging-compat",pD="@firebase/performance",gD="@firebase/performance-compat",mD="@firebase/remote-config",_D="@firebase/remote-config-compat",vD="@firebase/storage",yD="@firebase/storage-compat",wD="@firebase/firestore",ED="@firebase/vertexai-preview",SD="@firebase/firestore-compat",TD="firebase",CD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="[DEFAULT]",ID={[l1]:"fire-core",[JN]:"fire-core-compat",[eD]:"fire-analytics",[ZN]:"fire-analytics-compat",[nD]:"fire-app-check",[tD]:"fire-app-check-compat",[rD]:"fire-auth",[iD]:"fire-auth-compat",[sD]:"fire-rtdb",[oD]:"fire-data-connect",[aD]:"fire-rtdb-compat",[lD]:"fire-fn",[uD]:"fire-fn-compat",[cD]:"fire-iid",[hD]:"fire-iid-compat",[dD]:"fire-fcm",[fD]:"fire-fcm-compat",[pD]:"fire-perf",[gD]:"fire-perf-compat",[mD]:"fire-rc",[_D]:"fire-rc-compat",[vD]:"fire-gcs",[yD]:"fire-gcs-compat",[wD]:"fire-fst",[SD]:"fire-fst-compat",[ED]:"fire-vertex","fire-js":"fire-js",[TD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=new Map,PD=new Map,c1=new Map;function VT(t,e){try{t.container.addComponent(e)}catch(n){Ws.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Xa(t){const e=t.name;if(c1.has(e))return Ws.debug(`There were multiple attempts to register component ${e}.`),!1;c1.set(e,t);for(const n of Fg.values())VT(n,t);for(const n of PD.values())VT(n,t);return!0}function Um(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function xs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Go=new Fd("app","Firebase",RD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Go.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=CD;function J6(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:u1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Go.create("bad-app-name",{appName:String(i)});if(n||(n=H6()),!n)throw Go.create("no-options");const s=Fg.get(i);if(s){if(bg(n,s.options)&&bg(r,s.config))return s;throw Go.create("duplicate-app",{appName:i})}const o=new MN(i);for(const c of c1.values())o.addComponent(c);const u=new kD(n,r,o);return Fg.set(i,u),u}function rw(t=u1){const e=Fg.get(t);if(!e&&t===u1&&H6())return J6();if(!e)throw Go.create("no-app",{appName:t});return e}function Xi(t,e,n){var r;let i=(r=ID[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ws.warn(u.join(" "));return}Xa(new Qo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD="firebase-heartbeat-database",xD=1,hd="firebase-heartbeat-store";let Vv=null;function Z6(){return Vv||(Vv=qN(AD,xD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(hd)}catch(n){console.warn(n)}}}}).catch(t=>{throw Go.create("idb-open",{originalErrorMessage:t.message})})),Vv}async function ND(t){try{const n=(await Z6()).transaction(hd),r=await n.objectStore(hd).get(e9(t));return await n.done,r}catch(e){if(e instanceof Xs)Ws.warn(e.message);else{const n=Go.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ws.warn(n.message)}}}async function UT(t,e){try{const r=(await Z6()).transaction(hd,"readwrite");await r.objectStore(hd).put(e,e9(t)),await r.done}catch(n){if(n instanceof Xs)Ws.warn(n.message);else{const r=Go.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ws.warn(r.message)}}}function e9(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD=1024,OD=30*24*60*60*1e3;class MD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new bD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zT();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const u=new Date(o.date).valueOf();return Date.now()-u<=OD}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ws.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zT(),{heartbeatsToSend:r,unsentEntries:i}=LD(this._heartbeatsCache.heartbeats),s=Og(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ws.warn(n),""}}}function zT(){return new Date().toISOString().substring(0,10)}function LD(t,e=DD){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),BT(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),BT(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class bD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return yN()?wN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ND(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return UT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return UT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function BT(t){return Og(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(t){Xa(new Qo("platform-logger",e=>new YN(e),"PRIVATE")),Xa(new Qo("heartbeat",e=>new MD(e),"PRIVATE")),Xi(l1,FT,t),Xi(l1,FT,"esm2017"),Xi("fire-js","")}FD("");function iw(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function t9(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VD=t9,n9=new Fd("auth","Firebase",t9());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg=new Vm("@firebase/auth");function UD(t,...e){Vg.logLevel<=Ke.WARN&&Vg.warn(`Auth (${ul}): ${t}`,...e)}function Yp(t,...e){Vg.logLevel<=Ke.ERROR&&Vg.error(`Auth (${ul}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(t,...e){throw ow(t,...e)}function Ci(t,...e){return ow(t,...e)}function sw(t,e,n){const r=Object.assign(Object.assign({},VD()),{[e]:n});return new Fd("auth","Firebase",r).create(e,{appName:t.name})}function Wa(t){return sw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zD(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ts(t,"argument-error"),sw(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ow(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return n9.create(t,...e)}function ke(t,e,...n){if(!t)throw ow(e,...n)}function Ns(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Yp(e),new Error(e)}function Hs(t,e){t||Ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function BD(){return jT()==="http:"||jT()==="https:"}function jT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BD()||gN()||"connection"in navigator)?navigator.onLine:!0}function GD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(e,n){this.shortDelay=e,this.longDelay=n,Hs(n>e,"Short delay should be less than long delay!"),this.isMobile=tw()||K6()}get(){return jD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t,e){Hs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r9{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=new Vd(3e4,6e4);function lw(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function rc(t,e,n,r,i={}){return i9(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const u=nc(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:c},s);return pN()||(h.referrerPolicy="no-referrer"),r9.fetch()(s9(t,t.config.apiHost,n,u),h)})}async function i9(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},WD),e);try{const i=new qD(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Cp(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const u=s.ok?o.errorMessage:o.error.message,[c,h]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cp(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Cp(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Cp(t,"user-disabled",o);const p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw sw(t,p,h);ts(t,p)}}catch(i){if(i instanceof Xs)throw i;ts(t,"network-request-failed",{message:String(i)})}}async function $D(t,e,n,r,i={}){const s=await rc(t,e,n,r,i);return"mfaPendingCredential"in s&&ts(t,"multi-factor-auth-required",{_serverResponse:s}),s}function s9(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?aw(t.config,i):`${t.config.apiScheme}://${i}`}class qD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ci(this.auth,"network-request-failed")),HD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Cp(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Ci(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KD(t,e){return rc(t,"POST","/v1/accounts:delete",e)}async function o9(t,e){return rc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QD(t,e=!1){const n=cn(t),r=await n.getIdToken(e),i=uw(r);ke(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Lh(Uv(i.auth_time)),issuedAtTime:Lh(Uv(i.iat)),expirationTime:Lh(Uv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Uv(t){return Number(t)*1e3}function uw(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Yp("JWT malformed, contained fewer than 3 sections"),null;try{const i=Mg(n);return i?JSON.parse(i):(Yp("Failed to decode base64 JWT payload"),null)}catch(i){return Yp("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function GT(t){const e=uw(t);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dd(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xs&&YD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function YD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lh(this.lastLoginAt),this.creationTime=Lh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ug(t){var e;const n=t.auth,r=await t.getIdToken(),i=await dd(t,o9(n,{idToken:r}));ke(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?a9(s.providerUserInfo):[],u=ZD(t.providerData,o),c=t.isAnonymous,h=!(t.email&&s.passwordHash)&&!(u!=null&&u.length),p=c?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new d1(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(t,m)}async function JD(t){const e=cn(t);await Ug(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZD(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function a9(t){return t.map(e=>{var{providerId:n}=e,r=iw(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eO(t,e){const n=await i9(t,{},async()=>{const r=nc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=s9(t,i,"/v1/token",`key=${s}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",r9.fetch()(o,{method:"POST",headers:u,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function tO(t,e){return rc(t,"POST","/v2/accounts:revokeToken",lw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):GT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const n=GT(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await eO(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new vu;return r&&(ke(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ke(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ke(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vu,this.toJSON())}_performRefresh(){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t,e){ke(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ds{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=iw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new XD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new d1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await dd(this,this.stsTokenManager.getToken(this.auth,e));return ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return QD(this,e)}reload(){return JD(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ds(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ug(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xs(this.auth.app))return Promise.reject(Wa(this.auth));const e=await this.getIdToken();return await dd(this,KD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,u,c,h,p;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,_=(i=n.email)!==null&&i!==void 0?i:void 0,E=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=n.photoURL)!==null&&o!==void 0?o:void 0,P=(u=n.tenantId)!==null&&u!==void 0?u:void 0,N=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,R=(h=n.createdAt)!==null&&h!==void 0?h:void 0,k=(p=n.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:w,emailVerified:A,isAnonymous:V,providerData:U,stsTokenManager:O}=n;ke(w&&O,e,"internal-error");const C=vu.fromJSON(this.name,O);ke(typeof w=="string",e,"internal-error"),vo(m,e.name),vo(_,e.name),ke(typeof A=="boolean",e,"internal-error"),ke(typeof V=="boolean",e,"internal-error"),vo(E,e.name),vo(S,e.name),vo(P,e.name),vo(N,e.name),vo(R,e.name),vo(k,e.name);const D=new Ds({uid:w,auth:e,email:_,emailVerified:A,displayName:m,isAnonymous:V,photoURL:S,phoneNumber:E,tenantId:P,stsTokenManager:C,createdAt:R,lastLoginAt:k});return U&&Array.isArray(U)&&(D.providerData=U.map(x=>Object.assign({},x))),N&&(D._redirectEventId=N),D}static async _fromIdTokenResponse(e,n,r=!1){const i=new vu;i.updateFromServerResponse(n);const s=new Ds({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ug(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ke(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?a9(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),u=new vu;u.updateFromIdToken(r);const c=new Ds({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new d1(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT=new Map;function Os(t){Hs(t instanceof Function,"Expected a class definition");let e=WT.get(t);return e?(Hs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,WT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}l9.type="NONE";const HT=l9;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t,e,n){return`firebase:${t}:${e}:${n}`}class yu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Xp(this.userKey,i.apiKey,s),this.fullPersistenceKey=Xp("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ds._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new yu(Os(HT),e,r);const i=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Os(HT);const o=Xp(r,e.config.apiKey,e.name);let u=null;for(const h of n)try{const p=await h._get(o);if(p){const m=Ds._fromJSON(e,p);h!==s&&(u=m),s=h;break}}catch{}const c=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new yu(s,e,r):(s=c[0],u&&await s._set(o,u.toJSON()),await Promise.all(n.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new yu(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(d9(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(u9(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(p9(e))return"Blackberry";if(g9(e))return"Webos";if(c9(e))return"Safari";if((e.includes("chrome/")||h9(e))&&!e.includes("edge/"))return"Chrome";if(f9(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function u9(t=ir()){return/firefox\//i.test(t)}function c9(t=ir()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function h9(t=ir()){return/crios\//i.test(t)}function d9(t=ir()){return/iemobile/i.test(t)}function f9(t=ir()){return/android/i.test(t)}function p9(t=ir()){return/blackberry/i.test(t)}function g9(t=ir()){return/webos/i.test(t)}function cw(t=ir()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function nO(t=ir()){var e;return cw(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function rO(){return mN()&&document.documentMode===10}function m9(t=ir()){return cw(t)||f9(t)||g9(t)||p9(t)||/windows phone/i.test(t)||d9(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _9(t,e=[]){let n;switch(t){case"Browser":n=$T(ir());break;case"Worker":n=`${$T(ir())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ul}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,u)=>{try{const c=e(s);o(c)}catch(c){u(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sO(t,e={}){return rc(t,"GET","/v2/passwordPolicy",lw(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=6;class aO{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:oO,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,u;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qT(this),this.idTokenSubscription=new qT(this),this.beforeStateQueue=new iO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n9,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Os(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await yu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await o9(this,{idToken:e}),r=await Ds._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(xs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,u=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===u)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ug(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xs(this.app))return Promise.reject(Wa(this));const n=e?cn(e):null;return n&&ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xs(this.app)?Promise.reject(Wa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xs(this.app)?Promise.reject(Wa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Os(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sO(this),n=new aO(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await tO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Os(e)||this._popupRedirectResolver;ke(n,this,"argument-error"),this.redirectPersistenceManager=await yu.create(this,[Os(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(u,this,"internal-error"),u.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_9(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&UD(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function zm(t){return cn(t)}class qT{constructor(e){this.auth=e,this.observer=null,this.addObserver=RN(n=>this.observer=n)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uO(t){hw=t}function cO(t){return hw.loadJS(t)}function hO(){return hw.gapiScript}function dO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fO(t,e){const n=Um(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(bg(s,e??{}))return i;ts(i,"already-initialized")}return n.initialize({options:e})}function pO(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Os);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function gO(t,e,n){const r=zm(t);ke(r._canInitEmulator,r,"emulator-config-failed"),ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=v9(e),{host:o,port:u}=mO(e),c=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),_O()}function v9(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function mO(t){const e=v9(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:KT(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:KT(o)}}}function KT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _O(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ns("not implemented")}_getIdTokenResponse(e){return Ns("not implemented")}_linkToIdToken(e,n){return Ns("not implemented")}_getReauthenticationResolver(e){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wu(t,e){return $D(t,"POST","/v1/accounts:signInWithIdp",lw(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO="http://localhost";class Ja extends y9{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ja(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ts("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=iw(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Ja(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return wu(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,wu(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,wu(e,n)}buildRequest(){const e={requestUri:vO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=nc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud extends dw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends Ud{constructor(){super("facebook.com")}static credential(e){return Ja._fromParams({providerId:Co.PROVIDER_ID,signInMethod:Co.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Co.credentialFromTaggedObject(e)}static credentialFromError(e){return Co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Co.credential(e.oauthAccessToken)}catch{return null}}}Co.FACEBOOK_SIGN_IN_METHOD="facebook.com";Co.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends Ud{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ja._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Rs.credential(n,r)}catch{return null}}}Rs.GOOGLE_SIGN_IN_METHOD="google.com";Rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends Ud{constructor(){super("github.com")}static credential(e){return Ja._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Io.credential(e.oauthAccessToken)}catch{return null}}}Io.GITHUB_SIGN_IN_METHOD="github.com";Io.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po extends Ud{constructor(){super("twitter.com")}static credential(e,n){return Ja._fromParams({providerId:Po.PROVIDER_ID,signInMethod:Po.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Po.credentialFromTaggedObject(e)}static credentialFromError(e){return Po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Po.credential(n,r)}catch{return null}}}Po.TWITTER_SIGN_IN_METHOD="twitter.com";Po.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ds._fromIdTokenResponse(e,r,i),o=QT(r);return new Ou({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=QT(r);return new Ou({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function QT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg extends Xs{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,zg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new zg(e,n,r,i)}}function w9(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?zg._fromErrorAndOperation(t,s,e,r):s})}async function yO(t,e,n=!1){const r=await dd(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ou._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wO(t,e,n=!1){const{auth:r}=t;if(xs(r.app))return Promise.reject(Wa(r));const i="reauthenticate";try{const s=await dd(t,w9(r,i,e,t),n);ke(s.idToken,r,"internal-error");const o=uw(s.idToken);ke(o,r,"internal-error");const{sub:u}=o;return ke(t.uid===u,r,"user-mismatch"),Ou._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ts(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EO(t,e,n=!1){if(xs(t.app))return Promise.reject(Wa(t));const r="signIn",i=await w9(t,r,e),s=await Ou._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function SO(t,e,n,r){return cn(t).onIdTokenChanged(e,n,r)}function TO(t,e,n){return cn(t).beforeAuthStateChanged(e,n)}function CO(t,e,n,r){return cn(t).onAuthStateChanged(e,n,r)}function IO(t){return cn(t).signOut()}const Bg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Bg,"1"),this.storage.removeItem(Bg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO=1e3,RO=10;class S9 extends E9{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=m9(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,u,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);rO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,RO):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},PO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}S9.type="LOCAL";const kO=S9;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9 extends E9{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}T9.type="SESSION";const C9=T9;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Bm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(o).map(async h=>h(n.origin,s)),c=await AO(u);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Bm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((u,c)=>{const h=fw("",20);i.port1.start();const p=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(){return window}function NO(t){Ji().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(){return typeof Ji().WorkerGlobalScope<"u"&&typeof Ji().importScripts=="function"}async function DO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function OO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function MO(){return I9()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9="firebaseLocalStorageDb",LO=1,jg="firebaseLocalStorage",R9="fbase_key";class zd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function jm(t,e){return t.transaction([jg],e?"readwrite":"readonly").objectStore(jg)}function bO(){const t=indexedDB.deleteDatabase(P9);return new zd(t).toPromise()}function f1(){const t=indexedDB.open(P9,LO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(jg,{keyPath:R9})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(jg)?e(r):(r.close(),await bO(),e(await f1()))})})}async function YT(t,e,n){const r=jm(t,!0).put({[R9]:e,value:n});return new zd(r).toPromise()}async function FO(t,e){const n=jm(t,!1).get(e),r=await new zd(n).toPromise();return r===void 0?null:r.value}function XT(t,e){const n=jm(t,!0).delete(e);return new zd(n).toPromise()}const VO=800,UO=3;class k9{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await f1(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>UO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return I9()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bm._getInstance(MO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await DO(),!this.activeServiceWorker)return;this.sender=new xO(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||OO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await f1();return await YT(e,Bg,"1"),await XT(e,Bg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>YT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>FO(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>XT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=jm(i,!1).getAll();return new zd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),VO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k9.type="LOCAL";const zO=k9;new Vd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A9(t,e){return e?Os(e):(ke(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw extends y9{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return wu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return wu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function BO(t){return EO(t.auth,new pw(t),t.bypassAuthState)}function jO(t){const{auth:e,user:n}=t;return ke(n,e,"internal-error"),wO(n,new pw(t),t.bypassAuthState)}async function GO(t){const{auth:e,user:n}=t;return ke(n,e,"internal-error"),yO(n,new pw(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:u}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return BO;case"linkViaPopup":case"linkViaRedirect":return GO;case"reauthViaPopup":case"reauthViaRedirect":return jO;default:ts(this.auth,"internal-error")}}resolve(e){Hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=new Vd(2e3,1e4);async function HO(t,e,n){if(xs(t.app))return Promise.reject(Ci(t,"operation-not-supported-in-this-environment"));const r=zm(t);zD(t,e,dw);const i=A9(r,n);return new Ua(r,"signInViaPopup",e,i).executeNotNull()}class Ua extends x9{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ua.currentPopupAction&&Ua.currentPopupAction.cancel(),Ua.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){Hs(this.filter.length===1,"Popup operations only handle one event");const e=fw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ci(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ci(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ua.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ci(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,WO.get())};e()}}Ua.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O="pendingRedirect",Jp=new Map;class qO extends x9{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Jp.get(this.auth._key());if(!e){try{const r=await KO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Jp.set(this.auth._key(),e)}return this.bypassAuthState||Jp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KO(t,e){const n=XO(e),r=YO(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function QO(t,e){Jp.set(t._key(),e)}function YO(t){return Os(t._redirectPersistence)}function XO(t){return Xp($O,t.config.apiKey,t.name)}async function JO(t,e,n=!1){if(xs(t.app))return Promise.reject(Wa(t));const r=zm(t),i=A9(r,e),o=await new qO(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO=10*60*1e3;class eM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!N9(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ci(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZO&&this.cachedEventUids.clear(),this.cachedEventUids.has(JT(e))}saveEventToCache(e){this.cachedEventUids.add(JT(e)),this.lastProcessedEventTime=Date.now()}}function JT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function N9({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function tM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return N9(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nM(t,e={}){return rc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iM=/^https?/;async function sM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await nM(t);for(const n of e)try{if(oM(n))return}catch{}ts(t,"unauthorized-domain")}function oM(t){const e=h1(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!iM.test(n))return!1;if(rM.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM=new Vd(3e4,6e4);function ZT(){const t=Ji().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function lM(t){return new Promise((e,n)=>{var r,i,s;function o(){ZT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ZT(),n(Ci(t,"network-request-failed"))},timeout:aM.get()})}if(!((i=(r=Ji().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Ji().gapi)===null||s===void 0)&&s.load)o();else{const u=dO("iframefcb");return Ji()[u]=()=>{gapi.load?o():n(Ci(t,"network-request-failed"))},cO(`${hO()}?onload=${u}`).catch(c=>n(c))}}).catch(e=>{throw Zp=null,e})}let Zp=null;function uM(t){return Zp=Zp||lM(t),Zp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=new Vd(5e3,15e3),hM="__/auth/iframe",dM="emulator/auth/iframe",fM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gM(t){const e=t.config;ke(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?aw(e,dM):`https://${t.config.authDomain}/${hM}`,r={apiKey:e.apiKey,appName:t.name,v:ul},i=pM.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${nc(r).slice(1)}`}async function mM(t){const e=await uM(t),n=Ji().gapi;return ke(n,t,"internal-error"),e.open({where:document.body,url:gM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fM,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Ci(t,"network-request-failed"),u=Ji().setTimeout(()=>{s(o)},cM.get());function c(){Ji().clearTimeout(u),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vM=500,yM=600,wM="_blank",EM="http://localhost";class eC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SM(t,e,n,r=vM,i=yM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const c=Object.assign(Object.assign({},_M),{width:r.toString(),height:i.toString(),top:s,left:o}),h=ir().toLowerCase();n&&(u=h9(h)?wM:n),u9(h)&&(e=e||EM,c.scrollbars="yes");const p=Object.entries(c).reduce((_,[E,S])=>`${_}${E}=${S},`,"");if(nO(h)&&u!=="_self")return TM(e||"",u),new eC(null);const m=window.open(e||"",u,p);ke(m,t,"popup-blocked");try{m.focus()}catch{}return new eC(m)}function TM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM="__/auth/handler",IM="emulator/auth/handler",PM=encodeURIComponent("fac");async function tC(t,e,n,r,i,s){ke(t.config.authDomain,t,"auth-domain-config-required"),ke(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ul,eventId:i};if(e instanceof dw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",s1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,m]of Object.entries({}))o[p]=m}if(e instanceof Ud){const p=e.getScopes().filter(m=>m!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const c=await t._getAppCheckToken(),h=c?`#${PM}=${encodeURIComponent(c)}`:"";return`${RM(t)}?${nc(u).slice(1)}${h}`}function RM({config:t}){return t.emulator?aw(t,IM):`https://${t.authDomain}/${CM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="webStorageSupport";class kM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=C9,this._completeRedirectFn=JO,this._overrideRedirectResult=QO}async _openPopup(e,n,r,i){var s;Hs((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await tC(e,n,r,h1(),i);return SM(e,o,fw())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await tC(e,n,r,h1(),i);return NO(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Hs(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await mM(e),r=new eM(e);return n.register("authEvent",i=>(ke(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(zv,{type:zv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[zv];o!==void 0&&n(!!o),ts(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=sM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return m9()||c9()||cw()}}const AM=kM;var nC="@firebase/auth",rC="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DM(t){Xa(new Qo("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=r.options;ke(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_9(t)},h=new lO(r,i,s,c);return pO(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Xa(new Qo("auth-internal",e=>{const n=zm(e.getProvider("auth").getImmediate());return(r=>new xM(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xi(nC,rC,NM(t)),Xi(nC,rC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM=5*60,MM=$6("authIdTokenMaxAge")||OM;let iC=null;const LM=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>MM)return;const i=n==null?void 0:n.token;iC!==i&&(iC=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function bM(t=rw()){const e=Um(t,"auth");if(e.isInitialized())return e.getImmediate();const n=fO(t,{popupRedirectResolver:AM,persistence:[zO,kO,C9]}),r=$6("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=LM(s.toString());TO(n,o,()=>o(n.currentUser)),SO(n,u=>o(u))}}const i=G6("auth");return i&&gO(n,`http://${i}`),n}function FM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}uO({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Ci("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",FM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DM("Browser");var VM="firebase",UM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xi(VM,UM,"app");var sC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ha,D9;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(O,C){function D(){}D.prototype=C.prototype,O.D=C.prototype,O.prototype=new D,O.prototype.constructor=O,O.C=function(x,M,z){for(var b=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)b[oe-2]=arguments[oe];return C.prototype[M].apply(x,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(O,C,D){D||(D=0);var x=Array(16);if(typeof C=="string")for(var M=0;16>M;++M)x[M]=C.charCodeAt(D++)|C.charCodeAt(D++)<<8|C.charCodeAt(D++)<<16|C.charCodeAt(D++)<<24;else for(M=0;16>M;++M)x[M]=C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24;C=O.g[0],D=O.g[1],M=O.g[2];var z=O.g[3],b=C+(z^D&(M^z))+x[0]+3614090360&4294967295;C=D+(b<<7&4294967295|b>>>25),b=z+(M^C&(D^M))+x[1]+3905402710&4294967295,z=C+(b<<12&4294967295|b>>>20),b=M+(D^z&(C^D))+x[2]+606105819&4294967295,M=z+(b<<17&4294967295|b>>>15),b=D+(C^M&(z^C))+x[3]+3250441966&4294967295,D=M+(b<<22&4294967295|b>>>10),b=C+(z^D&(M^z))+x[4]+4118548399&4294967295,C=D+(b<<7&4294967295|b>>>25),b=z+(M^C&(D^M))+x[5]+1200080426&4294967295,z=C+(b<<12&4294967295|b>>>20),b=M+(D^z&(C^D))+x[6]+2821735955&4294967295,M=z+(b<<17&4294967295|b>>>15),b=D+(C^M&(z^C))+x[7]+4249261313&4294967295,D=M+(b<<22&4294967295|b>>>10),b=C+(z^D&(M^z))+x[8]+1770035416&4294967295,C=D+(b<<7&4294967295|b>>>25),b=z+(M^C&(D^M))+x[9]+2336552879&4294967295,z=C+(b<<12&4294967295|b>>>20),b=M+(D^z&(C^D))+x[10]+4294925233&4294967295,M=z+(b<<17&4294967295|b>>>15),b=D+(C^M&(z^C))+x[11]+2304563134&4294967295,D=M+(b<<22&4294967295|b>>>10),b=C+(z^D&(M^z))+x[12]+1804603682&4294967295,C=D+(b<<7&4294967295|b>>>25),b=z+(M^C&(D^M))+x[13]+4254626195&4294967295,z=C+(b<<12&4294967295|b>>>20),b=M+(D^z&(C^D))+x[14]+2792965006&4294967295,M=z+(b<<17&4294967295|b>>>15),b=D+(C^M&(z^C))+x[15]+1236535329&4294967295,D=M+(b<<22&4294967295|b>>>10),b=C+(M^z&(D^M))+x[1]+4129170786&4294967295,C=D+(b<<5&4294967295|b>>>27),b=z+(D^M&(C^D))+x[6]+3225465664&4294967295,z=C+(b<<9&4294967295|b>>>23),b=M+(C^D&(z^C))+x[11]+643717713&4294967295,M=z+(b<<14&4294967295|b>>>18),b=D+(z^C&(M^z))+x[0]+3921069994&4294967295,D=M+(b<<20&4294967295|b>>>12),b=C+(M^z&(D^M))+x[5]+3593408605&4294967295,C=D+(b<<5&4294967295|b>>>27),b=z+(D^M&(C^D))+x[10]+38016083&4294967295,z=C+(b<<9&4294967295|b>>>23),b=M+(C^D&(z^C))+x[15]+3634488961&4294967295,M=z+(b<<14&4294967295|b>>>18),b=D+(z^C&(M^z))+x[4]+3889429448&4294967295,D=M+(b<<20&4294967295|b>>>12),b=C+(M^z&(D^M))+x[9]+568446438&4294967295,C=D+(b<<5&4294967295|b>>>27),b=z+(D^M&(C^D))+x[14]+3275163606&4294967295,z=C+(b<<9&4294967295|b>>>23),b=M+(C^D&(z^C))+x[3]+4107603335&4294967295,M=z+(b<<14&4294967295|b>>>18),b=D+(z^C&(M^z))+x[8]+1163531501&4294967295,D=M+(b<<20&4294967295|b>>>12),b=C+(M^z&(D^M))+x[13]+2850285829&4294967295,C=D+(b<<5&4294967295|b>>>27),b=z+(D^M&(C^D))+x[2]+4243563512&4294967295,z=C+(b<<9&4294967295|b>>>23),b=M+(C^D&(z^C))+x[7]+1735328473&4294967295,M=z+(b<<14&4294967295|b>>>18),b=D+(z^C&(M^z))+x[12]+2368359562&4294967295,D=M+(b<<20&4294967295|b>>>12),b=C+(D^M^z)+x[5]+4294588738&4294967295,C=D+(b<<4&4294967295|b>>>28),b=z+(C^D^M)+x[8]+2272392833&4294967295,z=C+(b<<11&4294967295|b>>>21),b=M+(z^C^D)+x[11]+1839030562&4294967295,M=z+(b<<16&4294967295|b>>>16),b=D+(M^z^C)+x[14]+4259657740&4294967295,D=M+(b<<23&4294967295|b>>>9),b=C+(D^M^z)+x[1]+2763975236&4294967295,C=D+(b<<4&4294967295|b>>>28),b=z+(C^D^M)+x[4]+1272893353&4294967295,z=C+(b<<11&4294967295|b>>>21),b=M+(z^C^D)+x[7]+4139469664&4294967295,M=z+(b<<16&4294967295|b>>>16),b=D+(M^z^C)+x[10]+3200236656&4294967295,D=M+(b<<23&4294967295|b>>>9),b=C+(D^M^z)+x[13]+681279174&4294967295,C=D+(b<<4&4294967295|b>>>28),b=z+(C^D^M)+x[0]+3936430074&4294967295,z=C+(b<<11&4294967295|b>>>21),b=M+(z^C^D)+x[3]+3572445317&4294967295,M=z+(b<<16&4294967295|b>>>16),b=D+(M^z^C)+x[6]+76029189&4294967295,D=M+(b<<23&4294967295|b>>>9),b=C+(D^M^z)+x[9]+3654602809&4294967295,C=D+(b<<4&4294967295|b>>>28),b=z+(C^D^M)+x[12]+3873151461&4294967295,z=C+(b<<11&4294967295|b>>>21),b=M+(z^C^D)+x[15]+530742520&4294967295,M=z+(b<<16&4294967295|b>>>16),b=D+(M^z^C)+x[2]+3299628645&4294967295,D=M+(b<<23&4294967295|b>>>9),b=C+(M^(D|~z))+x[0]+4096336452&4294967295,C=D+(b<<6&4294967295|b>>>26),b=z+(D^(C|~M))+x[7]+1126891415&4294967295,z=C+(b<<10&4294967295|b>>>22),b=M+(C^(z|~D))+x[14]+2878612391&4294967295,M=z+(b<<15&4294967295|b>>>17),b=D+(z^(M|~C))+x[5]+4237533241&4294967295,D=M+(b<<21&4294967295|b>>>11),b=C+(M^(D|~z))+x[12]+1700485571&4294967295,C=D+(b<<6&4294967295|b>>>26),b=z+(D^(C|~M))+x[3]+2399980690&4294967295,z=C+(b<<10&4294967295|b>>>22),b=M+(C^(z|~D))+x[10]+4293915773&4294967295,M=z+(b<<15&4294967295|b>>>17),b=D+(z^(M|~C))+x[1]+2240044497&4294967295,D=M+(b<<21&4294967295|b>>>11),b=C+(M^(D|~z))+x[8]+1873313359&4294967295,C=D+(b<<6&4294967295|b>>>26),b=z+(D^(C|~M))+x[15]+4264355552&4294967295,z=C+(b<<10&4294967295|b>>>22),b=M+(C^(z|~D))+x[6]+2734768916&4294967295,M=z+(b<<15&4294967295|b>>>17),b=D+(z^(M|~C))+x[13]+1309151649&4294967295,D=M+(b<<21&4294967295|b>>>11),b=C+(M^(D|~z))+x[4]+4149444226&4294967295,C=D+(b<<6&4294967295|b>>>26),b=z+(D^(C|~M))+x[11]+3174756917&4294967295,z=C+(b<<10&4294967295|b>>>22),b=M+(C^(z|~D))+x[2]+718787259&4294967295,M=z+(b<<15&4294967295|b>>>17),b=D+(z^(M|~C))+x[9]+3951481745&4294967295,O.g[0]=O.g[0]+C&4294967295,O.g[1]=O.g[1]+(M+(b<<21&4294967295|b>>>11))&4294967295,O.g[2]=O.g[2]+M&4294967295,O.g[3]=O.g[3]+z&4294967295}r.prototype.u=function(O,C){C===void 0&&(C=O.length);for(var D=C-this.blockSize,x=this.B,M=this.h,z=0;z<C;){if(M==0)for(;z<=D;)i(this,O,z),z+=this.blockSize;if(typeof O=="string"){for(;z<C;)if(x[M++]=O.charCodeAt(z++),M==this.blockSize){i(this,x),M=0;break}}else for(;z<C;)if(x[M++]=O[z++],M==this.blockSize){i(this,x),M=0;break}}this.h=M,this.o+=C},r.prototype.v=function(){var O=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);O[0]=128;for(var C=1;C<O.length-8;++C)O[C]=0;var D=8*this.o;for(C=O.length-8;C<O.length;++C)O[C]=D&255,D/=256;for(this.u(O),O=Array(16),C=D=0;4>C;++C)for(var x=0;32>x;x+=8)O[D++]=this.g[C]>>>x&255;return O};function s(O,C){var D=u;return Object.prototype.hasOwnProperty.call(D,O)?D[O]:D[O]=C(O)}function o(O,C){this.h=C;for(var D=[],x=!0,M=O.length-1;0<=M;M--){var z=O[M]|0;x&&z==C||(D[M]=z,x=!1)}this.g=D}var u={};function c(O){return-128<=O&&128>O?s(O,function(C){return new o([C|0],0>C?-1:0)}):new o([O|0],0>O?-1:0)}function h(O){if(isNaN(O)||!isFinite(O))return m;if(0>O)return N(h(-O));for(var C=[],D=1,x=0;O>=D;x++)C[x]=O/D|0,D*=4294967296;return new o(C,0)}function p(O,C){if(O.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(O.charAt(0)=="-")return N(p(O.substring(1),C));if(0<=O.indexOf("-"))throw Error('number format error: interior "-" character');for(var D=h(Math.pow(C,8)),x=m,M=0;M<O.length;M+=8){var z=Math.min(8,O.length-M),b=parseInt(O.substring(M,M+z),C);8>z?(z=h(Math.pow(C,z)),x=x.j(z).add(h(b))):(x=x.j(D),x=x.add(h(b)))}return x}var m=c(0),_=c(1),E=c(16777216);t=o.prototype,t.m=function(){if(P(this))return-N(this).m();for(var O=0,C=1,D=0;D<this.g.length;D++){var x=this.i(D);O+=(0<=x?x:4294967296+x)*C,C*=4294967296}return O},t.toString=function(O){if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(S(this))return"0";if(P(this))return"-"+N(this).toString(O);for(var C=h(Math.pow(O,6)),D=this,x="";;){var M=A(D,C).g;D=R(D,M.j(C));var z=((0<D.g.length?D.g[0]:D.h)>>>0).toString(O);if(D=M,S(D))return z+x;for(;6>z.length;)z="0"+z;x=z+x}},t.i=function(O){return 0>O?0:O<this.g.length?this.g[O]:this.h};function S(O){if(O.h!=0)return!1;for(var C=0;C<O.g.length;C++)if(O.g[C]!=0)return!1;return!0}function P(O){return O.h==-1}t.l=function(O){return O=R(this,O),P(O)?-1:S(O)?0:1};function N(O){for(var C=O.g.length,D=[],x=0;x<C;x++)D[x]=~O.g[x];return new o(D,~O.h).add(_)}t.abs=function(){return P(this)?N(this):this},t.add=function(O){for(var C=Math.max(this.g.length,O.g.length),D=[],x=0,M=0;M<=C;M++){var z=x+(this.i(M)&65535)+(O.i(M)&65535),b=(z>>>16)+(this.i(M)>>>16)+(O.i(M)>>>16);x=b>>>16,z&=65535,b&=65535,D[M]=b<<16|z}return new o(D,D[D.length-1]&-2147483648?-1:0)};function R(O,C){return O.add(N(C))}t.j=function(O){if(S(this)||S(O))return m;if(P(this))return P(O)?N(this).j(N(O)):N(N(this).j(O));if(P(O))return N(this.j(N(O)));if(0>this.l(E)&&0>O.l(E))return h(this.m()*O.m());for(var C=this.g.length+O.g.length,D=[],x=0;x<2*C;x++)D[x]=0;for(x=0;x<this.g.length;x++)for(var M=0;M<O.g.length;M++){var z=this.i(x)>>>16,b=this.i(x)&65535,oe=O.i(M)>>>16,ye=O.i(M)&65535;D[2*x+2*M]+=b*ye,k(D,2*x+2*M),D[2*x+2*M+1]+=z*ye,k(D,2*x+2*M+1),D[2*x+2*M+1]+=b*oe,k(D,2*x+2*M+1),D[2*x+2*M+2]+=z*oe,k(D,2*x+2*M+2)}for(x=0;x<C;x++)D[x]=D[2*x+1]<<16|D[2*x];for(x=C;x<2*C;x++)D[x]=0;return new o(D,0)};function k(O,C){for(;(O[C]&65535)!=O[C];)O[C+1]+=O[C]>>>16,O[C]&=65535,C++}function w(O,C){this.g=O,this.h=C}function A(O,C){if(S(C))throw Error("division by zero");if(S(O))return new w(m,m);if(P(O))return C=A(N(O),C),new w(N(C.g),N(C.h));if(P(C))return C=A(O,N(C)),new w(N(C.g),C.h);if(30<O.g.length){if(P(O)||P(C))throw Error("slowDivide_ only works with positive integers.");for(var D=_,x=C;0>=x.l(O);)D=V(D),x=V(x);var M=U(D,1),z=U(x,1);for(x=U(x,2),D=U(D,2);!S(x);){var b=z.add(x);0>=b.l(O)&&(M=M.add(D),z=b),x=U(x,1),D=U(D,1)}return C=R(O,M.j(C)),new w(M,C)}for(M=m;0<=O.l(C);){for(D=Math.max(1,Math.floor(O.m()/C.m())),x=Math.ceil(Math.log(D)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),z=h(D),b=z.j(C);P(b)||0<b.l(O);)D-=x,z=h(D),b=z.j(C);S(z)&&(z=_),M=M.add(z),O=R(O,b)}return new w(M,O)}t.A=function(O){return A(this,O).h},t.and=function(O){for(var C=Math.max(this.g.length,O.g.length),D=[],x=0;x<C;x++)D[x]=this.i(x)&O.i(x);return new o(D,this.h&O.h)},t.or=function(O){for(var C=Math.max(this.g.length,O.g.length),D=[],x=0;x<C;x++)D[x]=this.i(x)|O.i(x);return new o(D,this.h|O.h)},t.xor=function(O){for(var C=Math.max(this.g.length,O.g.length),D=[],x=0;x<C;x++)D[x]=this.i(x)^O.i(x);return new o(D,this.h^O.h)};function V(O){for(var C=O.g.length+1,D=[],x=0;x<C;x++)D[x]=O.i(x)<<1|O.i(x-1)>>>31;return new o(D,O.h)}function U(O,C){var D=C>>5;C%=32;for(var x=O.g.length-D,M=[],z=0;z<x;z++)M[z]=0<C?O.i(z+D)>>>C|O.i(z+D+1)<<32-C:O.i(z+D);return new o(M,O.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,D9=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,Ha=o}).apply(typeof sC<"u"?sC:typeof self<"u"?self:typeof window<"u"?window:{});var Ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var O9,wh,M9,eg,p1,L9,b9,F9;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,y,I){return d==Array.prototype||d==Object.prototype||(d[y]=I.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ip=="object"&&Ip];for(var y=0;y<d.length;++y){var I=d[y];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var r=n(this);function i(d,y){if(y)e:{var I=r;d=d.split(".");for(var L=0;L<d.length-1;L++){var W=d[L];if(!(W in I))break e;I=I[W]}d=d[d.length-1],L=I[d],y=y(L),y!=L&&y!=null&&e(I,d,{configurable:!0,writable:!0,value:y})}}function s(d,y){d instanceof String&&(d+="");var I=0,L=!1,W={next:function(){if(!L&&I<d.length){var q=I++;return{value:y(q,d[q]),done:!1}}return L=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}i("Array.prototype.values",function(d){return d||function(){return s(this,function(y,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},u=this||self;function c(d){var y=typeof d;return y=y!="object"?y:d?Array.isArray(d)?"array":y:"null",y=="array"||y=="object"&&typeof d.length=="number"}function h(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function p(d,y,I){return d.call.apply(d.bind,arguments)}function m(d,y,I){if(!d)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,L),d.apply(y,W)}}return function(){return d.apply(y,arguments)}}function _(d,y,I){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,_.apply(null,arguments)}function E(d,y){var I=Array.prototype.slice.call(arguments,1);return function(){var L=I.slice();return L.push.apply(L,arguments),d.apply(this,L)}}function S(d,y){function I(){}I.prototype=y.prototype,d.aa=y.prototype,d.prototype=new I,d.prototype.constructor=d,d.Qb=function(L,W,q){for(var se=Array(arguments.length-2),Ze=2;Ze<arguments.length;Ze++)se[Ze-2]=arguments[Ze];return y.prototype[W].apply(L,se)}}function P(d){const y=d.length;if(0<y){const I=Array(y);for(let L=0;L<y;L++)I[L]=d[L];return I}return[]}function N(d,y){for(let I=1;I<arguments.length;I++){const L=arguments[I];if(c(L)){const W=d.length||0,q=L.length||0;d.length=W+q;for(let se=0;se<q;se++)d[W+se]=L[se]}else d.push(L)}}class R{constructor(y,I){this.i=y,this.j=I,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function k(d){return/^[\s\xa0]*$/.test(d)}function w(){var d=u.navigator;return d&&(d=d.userAgent)?d:""}function A(d){return A[" "](d),d}A[" "]=function(){};var V=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function U(d,y,I){for(const L in d)y.call(I,d[L],L,d)}function O(d,y){for(const I in d)y.call(void 0,d[I],I,d)}function C(d){const y={};for(const I in d)y[I]=d[I];return y}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(d,y){let I,L;for(let W=1;W<arguments.length;W++){L=arguments[W];for(I in L)d[I]=L[I];for(let q=0;q<D.length;q++)I=D[q],Object.prototype.hasOwnProperty.call(L,I)&&(d[I]=L[I])}}function M(d){var y=1;d=d.split(":");const I=[];for(;0<y&&d.length;)I.push(d.shift()),y--;return d.length&&I.push(d.join(":")),I}function z(d){u.setTimeout(()=>{throw d},0)}function b(){var d=ue;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class oe{constructor(){this.h=this.g=null}add(y,I){const L=ye.get();L.set(y,I),this.h?this.h.next=L:this.g=L,this.h=L}}var ye=new R(()=>new Te,d=>d.reset());class Te{constructor(){this.next=this.g=this.h=null}set(y,I){this.h=y,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let Pe,J=!1,ue=new oe,te=()=>{const d=u.Promise.resolve(void 0);Pe=()=>{d.then(le)}};var le=()=>{for(var d;d=b();){try{d.h.call(d.g)}catch(I){z(I)}var y=ye;y.j(d),100>y.h&&(y.h++,d.next=y.g,y.g=d)}J=!1};function _e(){this.s=this.s,this.C=this.C}_e.prototype.s=!1,_e.prototype.ma=function(){this.s||(this.s=!0,this.N())},_e.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ce(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}Ce.prototype.h=function(){this.defaultPrevented=!0};var Le=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const I=()=>{};u.addEventListener("test",I,y),u.removeEventListener("test",I,y)}catch{}return d}();function yt(d,y){if(Ce.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var I=this.type=d.type,L=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget){if(V){e:{try{A(y.nodeName);var W=!0;break e}catch{}W=!1}W||(y=null)}}else I=="mouseover"?y=d.fromElement:I=="mouseout"&&(y=d.toElement);this.relatedTarget=y,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ut[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&yt.aa.h.call(this)}}S(yt,Ce);var ut={2:"touch",3:"pen",4:"mouse"};yt.prototype.h=function(){yt.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),Y=0;function re(d,y,I,L,W){this.listener=d,this.proxy=null,this.src=y,this.type=I,this.capture=!!L,this.ha=W,this.key=++Y,this.da=this.fa=!1}function ve(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function de(d){this.src=d,this.g={},this.h=0}de.prototype.add=function(d,y,I,L,W){var q=d.toString();d=this.g[q],d||(d=this.g[q]=[],this.h++);var se=He(d,y,L,W);return-1<se?(y=d[se],I||(y.fa=!1)):(y=new re(y,this.src,q,!!L,W),y.fa=I,d.push(y)),y};function be(d,y){var I=y.type;if(I in d.g){var L=d.g[I],W=Array.prototype.indexOf.call(L,y,void 0),q;(q=0<=W)&&Array.prototype.splice.call(L,W,1),q&&(ve(y),d.g[I].length==0&&(delete d.g[I],d.h--))}}function He(d,y,I,L){for(var W=0;W<d.length;++W){var q=d[W];if(!q.da&&q.listener==y&&q.capture==!!I&&q.ha==L)return W}return-1}var Bt="closure_lm_"+(1e6*Math.random()|0),Xe={};function mr(d,y,I,L,W){if(Array.isArray(y)){for(var q=0;q<y.length;q++)mr(d,y[q],I,L,W);return null}return I=of(I),d&&d[B]?d.K(y,I,h(L)?!!L.capture:!1,W):Pn(d,y,I,!1,L,W)}function Pn(d,y,I,L,W,q){if(!y)throw Error("Invalid event type");var se=h(W)?!!W.capture:!!W,Ze=vc(d);if(Ze||(d[Bt]=Ze=new de(d)),I=Ze.add(y,I,L,se,q),I.proxy)return I;if(L=Br(),I.proxy=L,L.src=d,L.listener=I,d.addEventListener)Le||(W=se),W===void 0&&(W=!1),d.addEventListener(y.toString(),L,W);else if(d.attachEvent)d.attachEvent(sf(y.toString()),L);else if(d.addListener&&d.removeListener)d.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Br(){function d(I){return y.call(d.src,d.listener,I)}const y=o_;return d}function rf(d,y,I,L,W){if(Array.isArray(y))for(var q=0;q<y.length;q++)rf(d,y[q],I,L,W);else L=h(L)?!!L.capture:!!L,I=of(I),d&&d[B]?(d=d.i,y=String(y).toString(),y in d.g&&(q=d.g[y],I=He(q,I,L,W),-1<I&&(ve(q[I]),Array.prototype.splice.call(q,I,1),q.length==0&&(delete d.g[y],d.h--)))):d&&(d=vc(d))&&(y=d.g[y.toString()],d=-1,y&&(d=He(y,I,L,W)),(I=-1<d?y[d]:null)&&os(I))}function os(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[B])be(y.i,d);else{var I=d.type,L=d.proxy;y.removeEventListener?y.removeEventListener(I,L,d.capture):y.detachEvent?y.detachEvent(sf(I),L):y.addListener&&y.removeListener&&y.removeListener(L),(I=vc(y))?(be(I,d),I.h==0&&(I.src=null,y[Bt]=null)):ve(d)}}}function sf(d){return d in Xe?Xe[d]:Xe[d]="on"+d}function o_(d,y){if(d.da)d=!0;else{y=new yt(y,this);var I=d.listener,L=d.ha||d.src;d.fa&&os(d),d=I.call(L,y)}return d}function vc(d){return d=d[Bt],d instanceof de?d:null}var as="__closure_events_fn_"+(1e9*Math.random()>>>0);function of(d){return typeof d=="function"?d:(d[as]||(d[as]=function(y){return d.handleEvent(y)}),d[as])}function fn(){_e.call(this),this.i=new de(this),this.M=this,this.F=null}S(fn,_e),fn.prototype[B]=!0,fn.prototype.removeEventListener=function(d,y,I,L){rf(this,d,y,I,L)};function Rn(d,y){var I,L=d.F;if(L)for(I=[];L;L=L.F)I.push(L);if(d=d.M,L=y.type||y,typeof y=="string")y=new Ce(y,d);else if(y instanceof Ce)y.target=y.target||d;else{var W=y;y=new Ce(L,d),x(y,W)}if(W=!0,I)for(var q=I.length-1;0<=q;q--){var se=y.g=I[q];W=Tl(se,L,!0,y)&&W}if(se=y.g=d,W=Tl(se,L,!0,y)&&W,W=Tl(se,L,!1,y)&&W,I)for(q=0;q<I.length;q++)se=y.g=I[q],W=Tl(se,L,!1,y)&&W}fn.prototype.N=function(){if(fn.aa.N.call(this),this.i){var d=this.i,y;for(y in d.g){for(var I=d.g[y],L=0;L<I.length;L++)ve(I[L]);delete d.g[y],d.h--}}this.F=null},fn.prototype.K=function(d,y,I,L){return this.i.add(String(d),y,!1,I,L)},fn.prototype.L=function(d,y,I,L){return this.i.add(String(d),y,!0,I,L)};function Tl(d,y,I,L){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();for(var W=!0,q=0;q<y.length;++q){var se=y[q];if(se&&!se.da&&se.capture==I){var Ze=se.listener,jt=se.ha||se.src;se.fa&&be(d.i,se),W=Ze.call(jt,L)!==!1&&W}}return W&&!L.defaultPrevented}function af(d,y,I){if(typeof d=="function")I&&(d=_(d,I));else if(d&&typeof d.handleEvent=="function")d=_(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:u.setTimeout(d,y||0)}function lf(d){d.g=af(()=>{d.g=null,d.i&&(d.i=!1,lf(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class a_ extends _e{constructor(y,I){super(),this.m=y,this.l=I,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:lf(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fa(d){_e.call(this),this.h=d,this.g={}}S(fa,_e);var uf=[];function cf(d){U(d.g,function(y,I){this.g.hasOwnProperty(I)&&os(y)},d),d.g={}}fa.prototype.N=function(){fa.aa.N.call(this),cf(this)},fa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yc=u.JSON.stringify,l_=u.JSON.parse,hf=class{stringify(d){return u.JSON.stringify(d,void 0)}parse(d){return u.JSON.parse(d,void 0)}};function wc(){}wc.prototype.h=null;function df(d){return d.h||(d.h=d.i())}function ff(){}var pa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ec(){Ce.call(this,"d")}S(Ec,Ce);function Sc(){Ce.call(this,"c")}S(Sc,Ce);var Ni={},Tc=null;function Cl(){return Tc=Tc||new fn}Ni.La="serverreachability";function Il(d){Ce.call(this,Ni.La,d)}S(Il,Ce);function no(d){const y=Cl();Rn(y,new Il(y))}Ni.STAT_EVENT="statevent";function Cc(d,y){Ce.call(this,Ni.STAT_EVENT,d),this.stat=y}S(Cc,Ce);function kn(d){const y=Cl();Rn(y,new Cc(y,d))}Ni.Ma="timingevent";function pf(d,y){Ce.call(this,Ni.Ma,d),this.size=y}S(pf,Ce);function ga(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){d()},y)}function ro(){this.g=!0}ro.prototype.xa=function(){this.g=!1};function Ic(d,y,I,L,W,q){d.info(function(){if(d.g)if(q)for(var se="",Ze=q.split("&"),jt=0;jt<Ze.length;jt++){var $e=Ze[jt].split("=");if(1<$e.length){var nn=$e[0];$e=$e[1];var Qt=nn.split("_");se=2<=Qt.length&&Qt[1]=="type"?se+(nn+"="+$e+"&"):se+(nn+"=redacted&")}}else se=null;else se=q;return"XMLHTTP REQ ("+L+") [attempt "+W+"]: "+y+`
`+I+`
`+se})}function u_(d,y,I,L,W,q,se){d.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+W+"]: "+y+`
`+I+`
`+q+" "+se})}function io(d,y,I,L){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+c_(d,I)+(L?" "+L:"")})}function Pl(d,y){d.info(function(){return"TIMEOUT: "+y})}ro.prototype.info=function(){};function c_(d,y){if(!d.g)return y;if(!y)return null;try{var I=JSON.parse(y);if(I){for(d=0;d<I.length;d++)if(Array.isArray(I[d])){var L=I[d];if(!(2>L.length)){var W=L[1];if(Array.isArray(W)&&!(1>W.length)){var q=W[0];if(q!="noop"&&q!="stop"&&q!="close")for(var se=1;se<W.length;se++)W[se]=""}}}}return yc(I)}catch{return y}}var Rl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Pc;function kl(){}S(kl,wc),kl.prototype.g=function(){return new XMLHttpRequest},kl.prototype.i=function(){return{}},Pc=new kl;function Di(d,y,I,L){this.j=d,this.i=y,this.l=I,this.R=L||1,this.U=new fa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new mf}function mf(){this.i=null,this.g="",this.h=!1}var _f={},Rc={};function kc(d,y,I){d.L=1,d.v=Nl(_r(y)),d.m=I,d.P=!0,vf(d,null)}function vf(d,y){d.F=Date.now(),Al(d),d.A=_r(d.v);var I=d.A,L=d.R;Array.isArray(L)||(L=[String(L)]),Ye(I.i,"t",L),d.C=0,I=d.j.J,d.h=new mf,d.g=Vc(d.j,I?y:null,!d.m),0<d.O&&(d.M=new a_(_(d.Y,d,d.g),d.O)),y=d.U,I=d.g,L=d.ca;var W="readystatechange";Array.isArray(W)||(W&&(uf[0]=W.toString()),W=uf);for(var q=0;q<W.length;q++){var se=mr(I,W[q],L||y.handleEvent,!1,y.h||y);if(!se)break;y.g[se.key]=se}y=d.H?C(d.H):{},d.m?(d.u||(d.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,y)):(d.u="GET",d.g.ea(d.A,d.u,null,y)),no(),Ic(d.i,d.u,d.A,d.l,d.R,d.m)}Di.prototype.ca=function(d){d=d.target;const y=this.M;y&&Hn(d)==3?y.j():this.Y(d)},Di.prototype.Y=function(d){try{if(d==this.g)e:{const Qt=Hn(this.g);var y=this.g.Ba();const Vi=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||wa(this.g)))){this.J||Qt!=4||y==7||(y==8||0>=Vi?no(3):no(2)),ls(this);var I=this.g.Z();this.X=I;t:if(yf(this)){var L=wa(this.g);d="";var W=L.length,q=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){si(this),us(this);var se="";break t}this.h.i=new u.TextDecoder}for(y=0;y<W;y++)this.h.h=!0,d+=this.h.i.decode(L[y],{stream:!(q&&y==W-1)});L.length=0,this.h.g+=d,this.C=0,se=this.h.g}else se=this.g.oa();if(this.o=I==200,u_(this.i,this.u,this.A,this.l,this.R,Qt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Ze,jt=this.g;if((Ze=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Ze)){var $e=Ze;break t}}$e=null}if(I=$e)io(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ac(this,I);else{this.o=!1,this.s=3,kn(12),si(this),us(this);break e}}if(this.P){I=!0;let gn;for(;!this.J&&this.C<se.length;)if(gn=h_(this,se),gn==Rc){Qt==4&&(this.s=4,kn(14),I=!1),io(this.i,this.l,null,"[Incomplete Response]");break}else if(gn==_f){this.s=4,kn(15),io(this.i,this.l,se,"[Invalid Chunk]"),I=!1;break}else io(this.i,this.l,gn,null),Ac(this,gn);if(yf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||se.length!=0||this.h.h||(this.s=1,kn(16),I=!1),this.o=this.o&&I,!I)io(this.i,this.l,se,"[Invalid Chunked Response]"),si(this),us(this);else if(0<se.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),ms(nn),nn.M=!0,kn(11))}}else io(this.i,this.l,se,null),Ac(this,se);Qt==4&&si(this),this.o&&!this.J&&(Qt==4?bc(this.j,this):(this.o=!1,Al(this)))}else bl(this.g),I==400&&0<se.indexOf("Unknown SID")?(this.s=3,kn(12)):(this.s=0,kn(13)),si(this),us(this)}}}catch{}finally{}};function yf(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function h_(d,y){var I=d.C,L=y.indexOf(`
`,I);return L==-1?Rc:(I=Number(y.substring(I,L)),isNaN(I)?_f:(L+=1,L+I>y.length?Rc:(y=y.slice(L,L+I),d.C=L+I,y)))}Di.prototype.cancel=function(){this.J=!0,si(this)};function Al(d){d.S=Date.now()+d.I,xl(d,d.I)}function xl(d,y){if(d.B!=null)throw Error("WatchDog timer not null");d.B=ga(_(d.ba,d),y)}function ls(d){d.B&&(u.clearTimeout(d.B),d.B=null)}Di.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(Pl(this.i,this.A),this.L!=2&&(no(),kn(17)),si(this),this.s=2,us(this)):xl(this,this.S-d)};function us(d){d.j.G==0||d.J||bc(d.j,d)}function si(d){ls(d);var y=d.M;y&&typeof y.ma=="function"&&y.ma(),d.M=null,cf(d.U),d.g&&(y=d.g,d.g=null,y.abort(),y.ma())}function Ac(d,y){try{var I=d.j;if(I.G!=0&&(I.g==d||at(I.h,d))){if(!d.K&&at(I.h,d)&&I.G==3){try{var L=I.Da.g.parse(y)}catch{L=null}if(Array.isArray(L)&&L.length==3){var W=L;if(W[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<d.F)Ea(I),yr(I);else break e;ft(I),kn(18)}}else I.za=W[1],0<I.za-I.T&&37500>W[2]&&I.F&&I.v==0&&!I.C&&(I.C=ga(_(I.Za,I),6e3));if(1>=dt(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else ui(I,11)}else if((d.K||I.g==d)&&Ea(I),!k(y))for(W=I.Da.g.parse(y),y=0;y<W.length;y++){let $e=W[y];if(I.T=$e[0],$e=$e[1],I.G==2)if($e[0]=="c"){I.K=$e[1],I.ia=$e[2];const nn=$e[3];nn!=null&&(I.la=nn,I.j.info("VER="+I.la));const Qt=$e[4];Qt!=null&&(I.Aa=Qt,I.j.info("SVER="+I.Aa));const Vi=$e[5];Vi!=null&&typeof Vi=="number"&&0<Vi&&(L=1.5*Vi,I.L=L,I.j.info("backChannelRequestTimeoutMs_="+L)),L=I;const gn=d.g;if(gn){const Nn=gn.g?gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nn){var q=L.h;q.g||Nn.indexOf("spdy")==-1&&Nn.indexOf("quic")==-1&&Nn.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(jr(q,q.h),q.h=null))}if(L.D){const ci=gn.g?gn.g.getResponseHeader("X-HTTP-Session-Id"):null;ci&&(L.ya=ci,mt(L.I,L.D,ci))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-d.F,I.j.info("Handshake RTT: "+I.R+"ms")),L=I;var se=d;if(L.qa=Sa(L,L.J?L.ia:null,L.W),se.K){tn(L.h,se);var Ze=se,jt=L.L;jt&&(Ze.I=jt),Ze.B&&(ls(Ze),Al(Ze)),L.g=se}else lr(L);0<I.i.length&&Wr(I)}else $e[0]!="stop"&&$e[0]!="close"||ui(I,7);else I.G==3&&($e[0]=="stop"||$e[0]=="close"?$e[0]=="stop"?ui(I,7):li(I):$e[0]!="noop"&&I.l&&I.l.ta($e),I.v=0)}}no(4)}catch{}}var xc=class{constructor(d,y){this.g=d,this.map=y}};function cs(d){this.l=d||10,u.PerformanceNavigationTiming?(d=u.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function oi(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function dt(d){return d.h?1:d.g?d.g.size:0}function at(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function jr(d,y){d.g?d.g.add(y):d.h=y}function tn(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}cs.prototype.cancel=function(){if(this.i=An(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function An(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const I of d.g.values())y=y.concat(I.D);return y}return P(d.i)}function hs(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var y=[],I=d.length,L=0;L<I;L++)y.push(d[L]);return y}y=[],I=0;for(L in d)y[I++]=d[L];return y}function so(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var y=[];d=d.length;for(var I=0;I<d;I++)y.push(I);return y}y=[],I=0;for(const L in d)y[I++]=L;return y}}}function xn(d,y){if(d.forEach&&typeof d.forEach=="function")d.forEach(y,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,y,void 0);else for(var I=so(d),L=hs(d),W=L.length,q=0;q<W;q++)y.call(void 0,L[q],I&&I[q],d)}var ma=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wf(d,y){if(d){d=d.split("&");for(var I=0;I<d.length;I++){var L=d[I].indexOf("="),W=null;if(0<=L){var q=d[I].substring(0,L);W=d[I].substring(L+1)}else q=d[I];y(q,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Oi(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Oi){this.h=d.h,_a(this,d.j),this.o=d.o,this.g=d.g,Gn(this,d.s),this.l=d.l;var y=d.i,I=new ds;I.i=y.i,y.g&&(I.g=new Map(y.g),I.h=y.h),Ef(this,I),this.m=d.m}else d&&(y=String(d).match(ma))?(this.h=!1,_a(this,y[1]||"",!0),this.o=Mi(y[2]||""),this.g=Mi(y[3]||"",!0),Gn(this,y[4]),this.l=Mi(y[5]||"",!0),Ef(this,y[6]||"",!0),this.m=Mi(y[7]||"")):(this.h=!1,this.i=new ds(null,this.h))}Oi.prototype.toString=function(){var d=[],y=this.j;y&&d.push(Li(y,ya,!0),":");var I=this.g;return(I||y=="file")&&(d.push("//"),(y=this.o)&&d.push(Li(y,ya,!0),"@"),d.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&d.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&d.push("/"),d.push(Li(I,I.charAt(0)=="/"?f_:d_,!0))),(I=this.i.toString())&&d.push("?",I),(I=this.m)&&d.push("#",Li(I,Sf)),d.join("")};function _r(d){return new Oi(d)}function _a(d,y,I){d.j=I?Mi(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function Gn(d,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);d.s=y}else d.s=null}function Ef(d,y,I){y instanceof ds?(d.i=y,Dc(d.i,d.h)):(I||(y=Li(y,Nc)),d.i=new ds(y,d.h))}function mt(d,y,I){d.i.set(y,I)}function Nl(d){return mt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Mi(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Li(d,y,I){return typeof d=="string"?(d=encodeURI(d).replace(y,va),I&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function va(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var ya=/[#\/\?@]/g,d_=/[#\?:]/g,f_=/[#\?]/g,Nc=/[#\?@]/g,Sf=/#/g;function ds(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function vr(d){d.g||(d.g=new Map,d.h=0,d.i&&wf(d.i,function(y,I){d.add(decodeURIComponent(y.replace(/\+/g," ")),I)}))}t=ds.prototype,t.add=function(d,y){vr(this),this.i=null,d=fs(this,d);var I=this.g.get(d);return I||this.g.set(d,I=[]),I.push(y),this.h+=1,this};function Tf(d,y){vr(d),y=fs(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function Dl(d,y){return vr(d),y=fs(d,y),d.g.has(y)}t.forEach=function(d,y){vr(this),this.g.forEach(function(I,L){I.forEach(function(W){d.call(y,W,L,this)},this)},this)},t.na=function(){vr(this);const d=Array.from(this.g.values()),y=Array.from(this.g.keys()),I=[];for(let L=0;L<y.length;L++){const W=d[L];for(let q=0;q<W.length;q++)I.push(y[L])}return I},t.V=function(d){vr(this);let y=[];if(typeof d=="string")Dl(this,d)&&(y=y.concat(this.g.get(fs(this,d))));else{d=Array.from(this.g.values());for(let I=0;I<d.length;I++)y=y.concat(d[I])}return y},t.set=function(d,y){return vr(this),this.i=null,d=fs(this,d),Dl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},t.get=function(d,y){return d?(d=this.V(d),0<d.length?String(d[0]):y):y};function Ye(d,y,I){Tf(d,y),0<I.length&&(d.i=null,d.g.set(fs(d,y),P(I)),d.h+=I.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(var I=0;I<y.length;I++){var L=y[I];const q=encodeURIComponent(String(L)),se=this.V(L);for(L=0;L<se.length;L++){var W=q;se[L]!==""&&(W+="="+encodeURIComponent(String(se[L]))),d.push(W)}}return this.i=d.join("&")};function fs(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function Dc(d,y){y&&!d.j&&(vr(d),d.i=null,d.g.forEach(function(I,L){var W=L.toLowerCase();L!=W&&(Tf(this,L),Ye(this,W,I))},d)),d.j=y}function Cf(d,y){const I=new ro;if(u.Image){const L=new Image;L.onload=E(bi,I,"TestLoadImage: loaded",!0,y,L),L.onerror=E(bi,I,"TestLoadImage: error",!1,y,L),L.onabort=E(bi,I,"TestLoadImage: abort",!1,y,L),L.ontimeout=E(bi,I,"TestLoadImage: timeout",!1,y,L),u.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=d}else y(!1)}function p_(d,y){const I=new ro,L=new AbortController,W=setTimeout(()=>{L.abort(),bi(I,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:L.signal}).then(q=>{clearTimeout(W),q.ok?bi(I,"TestPingServer: ok",!0,y):bi(I,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(W),bi(I,"TestPingServer: error",!1,y)})}function bi(d,y,I,L,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),L(I)}catch{}}function Kt(){this.g=new hf}function Oc(d,y,I){const L=I||"";try{xn(d,function(W,q){let se=W;h(W)&&(se=yc(W)),y.push(L+q+"="+encodeURIComponent(se))})}catch(W){throw y.push(L+"type="+encodeURIComponent("_badmap")),W}}function Ol(d){this.l=d.Ub||null,this.j=d.eb||!1}S(Ol,wc),Ol.prototype.g=function(){return new oo(this.l,this.j)},Ol.prototype.i=function(d){return function(){return d}}({});function oo(d,y){fn.call(this),this.D=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(oo,fn),t=oo.prototype,t.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=y,this.readyState=1,Wn(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(y.body=d),(this.D||u).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fi(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Wn(this)),this.g&&(this.readyState=3,Wn(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;If(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function If(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?Fi(this):Wn(this),this.readyState==3&&If(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Fi(this))},t.Qa=function(d){this.g&&(this.response=d,Fi(this))},t.ga=function(){this.g&&Fi(this)};function Fi(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Wn(d)}t.setRequestHeader=function(d,y){this.u.append(d,y)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var I=y.next();!I.done;)I=I.value,d.push(I[0]+": "+I[1]),I=y.next();return d.join(`\r
`)};function Wn(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(oo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Pf(d){let y="";return U(d,function(I,L){y+=L,y+=":",y+=I,y+=`\r
`}),y}function Mc(d,y,I){e:{for(L in I){var L=!1;break e}L=!0}L||(I=Pf(I),typeof d=="string"?I!=null&&encodeURIComponent(String(I)):mt(d,y,I))}function Je(d){fn.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Je,fn);var ai=/^https?$/i,Ml=["POST","PUT"];t=Je.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,y,I,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pc.g(),this.v=this.o?df(this.o):df(Pc),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(q){Ll(this,q);return}if(d=I||"",I=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var W in L)I.set(W,L[W]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const q of L.keys())I.set(q,L.get(q));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(I.keys()).find(q=>q.toLowerCase()=="content-type"),W=u.FormData&&d instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Ml,y,void 0))||L||W||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,se]of I)this.g.setRequestHeader(q,se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ps(this),this.u=!0,this.g.send(d),this.u=!1}catch(q){Ll(this,q)}};function Ll(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.m=5,Lc(d),or(d)}function Lc(d){d.A||(d.A=!0,Rn(d,"complete"),Rn(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Rn(this,"complete"),Rn(this,"abort"),or(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),or(this,!0)),Je.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rf(this):this.bb())},t.bb=function(){Rf(this)};function Rf(d){if(d.h&&typeof o<"u"&&(!d.v[1]||Hn(d)!=4||d.Z()!=2)){if(d.u&&Hn(d)==4)af(d.Ea,0,d);else if(Rn(d,"readystatechange"),Hn(d)==4){d.h=!1;try{const se=d.Z();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var I;if(!(I=y)){var L;if(L=se===0){var W=String(d.D).match(ma)[1]||null;!W&&u.self&&u.self.location&&(W=u.self.location.protocol.slice(0,-1)),L=!ai.test(W?W.toLowerCase():"")}I=L}if(I)Rn(d,"complete"),Rn(d,"success");else{d.m=6;try{var q=2<Hn(d)?d.g.statusText:""}catch{q=""}d.l=q+" ["+d.Z()+"]",Lc(d)}}finally{or(d)}}}}function or(d,y){if(d.g){ps(d);const I=d.g,L=d.v[0]?()=>{}:null;d.g=null,d.v=null,y||Rn(d,"ready");try{I.onreadystatechange=L}catch{}}}function ps(d){d.I&&(u.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function Hn(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),l_(y)}};function wa(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function bl(d){const y={};d=(d.g&&2<=Hn(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<d.length;L++){if(k(d[L]))continue;var I=M(d[L]);const W=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const q=y[W]||[];y[W]=q,q.push(I)}O(y,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pn(d,y,I){return I&&I.internalChannelParams&&I.internalChannelParams[d]||y}function ar(d){this.Aa=0,this.i=[],this.j=new ro,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pn("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pn("baseRetryDelayMs",5e3,d),this.cb=pn("retryDelaySeedMs",1e4,d),this.Wa=pn("forwardChannelMaxRetries",2,d),this.wa=pn("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new cs(d&&d.concurrentRequestLimit),this.Da=new Kt,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ar.prototype,t.la=8,t.G=1,t.connect=function(d,y,I,L){kn(0),this.W=d,this.H=y||{},I&&L!==void 0&&(this.H.OSID=I,this.H.OAID=L),this.F=this.X,this.I=Sa(this,null,this.W),Wr(this)};function li(d){if(Gr(d),d.G==3){var y=d.U++,I=_r(d.I);if(mt(I,"SID",d.K),mt(I,"RID",y),mt(I,"TYPE","terminate"),gs(d,I),y=new Di(d,d.j,y),y.L=2,y.v=Nl(_r(I)),I=!1,u.navigator&&u.navigator.sendBeacon)try{I=u.navigator.sendBeacon(y.v.toString(),"")}catch{}!I&&u.Image&&(new Image().src=y.v,I=!0),I||(y.g=Vc(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Al(y)}Fc(d)}function yr(d){d.g&&(ms(d),d.g.cancel(),d.g=null)}function Gr(d){yr(d),d.u&&(u.clearTimeout(d.u),d.u=null),Ea(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&u.clearTimeout(d.s),d.s=null)}function Wr(d){if(!oi(d.h)&&!d.s){d.s=!0;var y=d.Ga;Pe||te(),J||(Pe(),J=!0),ue.add(y,d),d.B=0}}function kf(d,y){return dt(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=y.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=ga(_(d.Ga,d,y),Vl(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const W=new Di(this,this.j,d);let q=this.o;if(this.S&&(q?(q=C(q),x(q,this.S)):q=this.S),this.m!==null||this.O||(W.H=q,q=null),this.P)e:{for(var y=0,I=0;I<this.i.length;I++){t:{var L=this.i[I];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(y+=L,4096<y){y=I;break e}if(y===4096||I===this.i.length-1){y=I+1;break e}}y=1e3}else y=1e3;y=$n(this,W,y),I=_r(this.I),mt(I,"RID",d),mt(I,"CVER",22),this.D&&mt(I,"X-HTTP-Session-Id",this.D),gs(this,I),q&&(this.O?y="headers="+encodeURIComponent(String(Pf(q)))+"&"+y:this.m&&Mc(I,this.m,q)),jr(this.h,W),this.Ua&&mt(I,"TYPE","init"),this.P?(mt(I,"$req",y),mt(I,"SID","null"),W.T=!0,kc(W,I,null)):kc(W,I,y),this.G=2}}else this.G==3&&(d?Fl(this,d):this.i.length==0||oi(this.h)||Fl(this))};function Fl(d,y){var I;y?I=y.l:I=d.U++;const L=_r(d.I);mt(L,"SID",d.K),mt(L,"RID",I),mt(L,"AID",d.T),gs(d,L),d.m&&d.o&&Mc(L,d.m,d.o),I=new Di(d,d.j,I,d.B+1),d.m===null&&(I.H=d.o),y&&(d.i=y.D.concat(d.i)),y=$n(d,I,1e3),I.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),jr(d.h,I),kc(I,L,y)}function gs(d,y){d.H&&U(d.H,function(I,L){mt(y,L,I)}),d.l&&xn({},function(I,L){mt(y,L,I)})}function $n(d,y,I){I=Math.min(d.i.length,I);var L=d.l?_(d.l.Na,d.l,d):null;e:{var W=d.i;let q=-1;for(;;){const se=["count="+I];q==-1?0<I?(q=W[0].g,se.push("ofs="+q)):q=0:se.push("ofs="+q);let Ze=!0;for(let jt=0;jt<I;jt++){let $e=W[jt].g;const nn=W[jt].map;if($e-=q,0>$e)q=Math.max(0,W[jt].g-100),Ze=!1;else try{Oc(nn,se,"req"+$e+"_")}catch{L&&L(nn)}}if(Ze){L=se.join("&");break e}}}return d=d.i.splice(0,I),y.D=d,L}function lr(d){if(!d.g&&!d.u){d.Y=1;var y=d.Fa;Pe||te(),J||(Pe(),J=!0),ue.add(y,d),d.v=0}}function ft(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=ga(_(d.Fa,d),Vl(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,wr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=ga(_(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,kn(10),yr(this),wr(this))};function ms(d){d.A!=null&&(u.clearTimeout(d.A),d.A=null)}function wr(d){d.g=new Di(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var y=_r(d.qa);mt(y,"RID","rpc"),mt(y,"SID",d.K),mt(y,"AID",d.T),mt(y,"CI",d.F?"0":"1"),!d.F&&d.ja&&mt(y,"TO",d.ja),mt(y,"TYPE","xmlhttp"),gs(d,y),d.m&&d.o&&Mc(y,d.m,d.o),d.L&&(d.g.I=d.L);var I=d.g;d=d.ia,I.L=1,I.v=Nl(_r(y)),I.m=null,I.P=!0,vf(I,d)}t.Za=function(){this.C!=null&&(this.C=null,yr(this),ft(this),kn(19))};function Ea(d){d.C!=null&&(u.clearTimeout(d.C),d.C=null)}function bc(d,y){var I=null;if(d.g==y){Ea(d),ms(d),d.g=null;var L=2}else if(at(d.h,y))I=y.D,tn(d.h,y),L=1;else return;if(d.G!=0){if(y.o)if(L==1){I=y.m?y.m.length:0,y=Date.now()-y.F;var W=d.B;L=Cl(),Rn(L,new pf(L,I)),Wr(d)}else lr(d);else if(W=y.s,W==3||W==0&&0<y.X||!(L==1&&kf(d,y)||L==2&&ft(d)))switch(I&&0<I.length&&(y=d.h,y.i=y.i.concat(I)),W){case 1:ui(d,5);break;case 4:ui(d,10);break;case 3:ui(d,6);break;default:ui(d,2)}}}function Vl(d,y){let I=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(I*=2),I*y}function ui(d,y){if(d.j.info("Error code "+y),y==2){var I=_(d.fb,d),L=d.Xa;const W=!L;L=new Oi(L||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||_a(L,"https"),Nl(L),W?Cf(L.toString(),I):p_(L.toString(),I)}else kn(2);d.G=0,d.l&&d.l.sa(y),Fc(d),Gr(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),kn(2)):(this.j.info("Failed to ping google.com"),kn(1))};function Fc(d){if(d.G=0,d.ka=[],d.l){const y=An(d.h);(y.length!=0||d.i.length!=0)&&(N(d.ka,y),N(d.ka,d.i),d.h.i.length=0,P(d.i),d.i.length=0),d.l.ra()}}function Sa(d,y,I){var L=I instanceof Oi?_r(I):new Oi(I);if(L.g!="")y&&(L.g=y+"."+L.g),Gn(L,L.s);else{var W=u.location;L=W.protocol,y=y?y+"."+W.hostname:W.hostname,W=+W.port;var q=new Oi(null);L&&_a(q,L),y&&(q.g=y),W&&Gn(q,W),I&&(q.l=I),L=q}return I=d.D,y=d.ya,I&&y&&mt(L,I,y),mt(L,"VER",d.la),gs(d,L),L}function Vc(d,y,I){if(y&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Ca&&!d.pa?new Je(new Ol({eb:I})):new Je(d.pa),y.Ha(d.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _s(){}t=_s.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ao(){}ao.prototype.g=function(d,y){return new ur(d,y)};function ur(d,y){fn.call(this),this.g=new ar(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(d?d["X-WebChannel-Client-Profile"]=y.va:d={"X-WebChannel-Client-Profile":y.va}),this.g.S=d,(d=y&&y.Sb)&&!k(d)&&(this.g.m=d),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!k(y)&&(this.g.D=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new Hr(this)}S(ur,fn),ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ur.prototype.close=function(){li(this.g)},ur.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var I={};I.__data__=d,d=I}else this.u&&(I={},I.__data__=yc(d),d=I);y.i.push(new xc(y.Ya++,d)),y.G==3&&Wr(y)},ur.prototype.N=function(){this.g.l=null,delete this.j,li(this.g),delete this.g,ur.aa.N.call(this)};function Ta(d){Ec.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const I in y){d=I;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}S(Ta,Ec);function Af(){Sc.call(this),this.status=1}S(Af,Sc);function Hr(d){this.g=d}S(Hr,_s),Hr.prototype.ua=function(){Rn(this.g,"a")},Hr.prototype.ta=function(d){Rn(this.g,new Ta(d))},Hr.prototype.sa=function(d){Rn(this.g,new Af)},Hr.prototype.ra=function(){Rn(this.g,"b")},ao.prototype.createWebChannel=ao.prototype.g,ur.prototype.send=ur.prototype.o,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,F9=function(){return new ao},b9=function(){return Cl()},L9=Ni,p1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Rl.NO_ERROR=0,Rl.TIMEOUT=8,Rl.HTTP_ERROR=6,eg=Rl,gf.COMPLETE="complete",M9=gf,ff.EventType=pa,pa.OPEN="a",pa.CLOSE="b",pa.ERROR="c",pa.MESSAGE="d",fn.prototype.listen=fn.prototype.K,wh=ff,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,O9=Je}).apply(typeof Ip<"u"?Ip:typeof self<"u"?self:typeof window<"u"?window:{});const oC="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}er.UNAUTHENTICATED=new er(null),er.GOOGLE_CREDENTIALS=new er("google-credentials-uid"),er.FIRST_PARTY=new er("first-party-uid"),er.MOCK_USER=new er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ic="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=new Vm("@firebase/firestore");function ah(){return Za.logLevel}function we(t,...e){if(Za.logLevel<=Ke.DEBUG){const n=e.map(gw);Za.debug(`Firestore (${ic}): ${t}`,...n)}}function $s(t,...e){if(Za.logLevel<=Ke.ERROR){const n=e.map(gw);Za.error(`Firestore (${ic}): ${t}`,...n)}}function Mu(t,...e){if(Za.logLevel<=Ke.WARN){const n=e.map(gw);Za.warn(`Firestore (${ic}): ${t}`,...n)}}function gw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(t="Unexpected state"){const e=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: `+t;throw $s(e),new Error(e)}function ht(t,e){t||Ae()}function De(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends Xs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V9{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(er.UNAUTHENTICATED))}shutdown(){}}class BM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class jM{constructor(e){this.t=e,this.currentUser=er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ht(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new bs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new bs,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{we("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(we("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new bs)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(we("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ht(typeof r.accessToken=="string"),new V9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ht(e===null||typeof e=="string"),new er(e)}}class GM{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=er.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class WM{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new GM(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class HM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $M{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ht(this.o===void 0);const r=s=>{s.error!=null&&we("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,we("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{we("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):we("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ht(typeof n.token=="string"),this.R=n.token,new HM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=qM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function st(t,e){return t<e?-1:t>e?1:0}function Lu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ge(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ge(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ge(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return un.fromMillis(Date.now())}static fromDate(e){return un.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new un(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ne(e)}static min(){return new Ne(new un(0,0))}static max(){return new Ne(new un(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ae(),r===void 0?r=e.length-n:r>e.length-n&&Ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return fd.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof fd?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class It extends fd{construct(e,n,r){return new It(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ge(Z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new It(n)}static emptyPath(){return new It([])}}const KM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fn extends fd{construct(e,n,r){return new Fn(e,n,r)}static isValidIdentifier(e){return KM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Fn(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ge(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new ge(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ge(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new ge(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fn(n)}static emptyPath(){return new Fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(It.fromString(e))}static fromName(e){return new Se(It.fromString(e).popFirst(5))}static empty(){return new Se(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&It.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return It.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new It(e.slice()))}}function QM(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ne.fromTimestamp(r===1e9?new un(n+1,0):new un(n,r));return new Yo(i,Se.empty(),e)}function YM(t){return new Yo(t.readTime,t.key,-1)}class Yo{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Yo(Ne.min(),Se.empty(),-1)}static max(){return new Yo(Ne.max(),Se.empty(),-1)}}function XM(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Se.comparator(t.documentKey,e.documentKey),n!==0?n:st(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bd(t){if(t.code!==Z.FAILED_PRECONDITION||t.message!==JM)throw t;we("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ee((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ee?n:ee.resolve(n)}catch(n){return ee.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ee.reject(n)}static resolve(e){return new ee((n,r)=>{n(e)})}static reject(e){return new ee((n,r)=>{r(e)})}static waitFor(e){return new ee((n,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=ee.resolve(!1);for(const r of e)n=n.next(i=>i?ee.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new ee((r,i)=>{const s=e.length,o=new Array(s);let u=0;for(let c=0;c<s;c++){const h=c;n(e[h]).next(p=>{o[h]=p,++u,u===s&&r(o)},p=>i(p))}})}static doWhile(e,n){return new ee((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function eL(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function jd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}mw.oe=-1;function Gm(t){return t==null}function Gg(t){return t===0&&1/t==-1/0}function tL(t){return typeof t=="number"&&Number.isInteger(t)&&!Gg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function sc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function z9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let en=class g1{constructor(e,n){this.comparator=e,this.root=n||Wo.EMPTY}insert(e,n){return new g1(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wo.BLACK,null,null))}remove(e){return new g1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wo.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pp(this.root,e,this.comparator,!0)}},Pp=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Wo=class Ts{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ts.RED,this.left=i??Ts.EMPTY,this.right=s??Ts.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ts(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ts.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ts.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ts.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ts.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ae();const e=this.left.check();if(e!==this.right.check())throw Ae();return e+(this.isRed()?0:1)}};Wo.EMPTY=null,Wo.RED=!0,Wo.BLACK=!1;Wo.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae()}get value(){throw Ae()}get color(){throw Ae()}get left(){throw Ae()}get right(){throw Ae()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Wo(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.comparator=e,this.data=new en(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new lC(this.data.getIterator())}getIteratorFrom(e){return new lC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Un)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Un(this.comparator);return n.data=e,n}}class lC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this.fields=e,e.sort(Fn.comparator)}static empty(){return new wi([])}unionWith(e){let n=new Un(Fn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new wi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Lu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B9 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new B9("Invalid base64 string: "+s):s}}(e);return new Bn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Bn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bn.EMPTY_BYTE_STRING=new Bn("");const nL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xo(t){if(ht(!!t),typeof t=="string"){let e=0;const n=nL.exec(t);if(ht(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Wt(t.seconds),nanos:Wt(t.nanos)}}function Wt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function el(t){return typeof t=="string"?Bn.fromBase64String(t):Bn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vw(t){const e=t.mapValue.fields.__previous_value__;return _w(e)?vw(e):e}function pd(t){const e=Xo(t.mapValue.fields.__local_write_time__.timestampValue);return new un(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e,n,r,i,s,o,u,c,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=h}}class gd{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new gd("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof gd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp={mapValue:{}};function tl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_w(t)?4:sL(t)?9007199254740991:iL(t)?10:11:Ae()}function ns(t,e){if(t===e)return!0;const n=tl(t);if(n!==tl(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pd(t).isEqual(pd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Xo(i.timestampValue),u=Xo(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return el(i.bytesValue).isEqual(el(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Wt(i.geoPointValue.latitude)===Wt(s.geoPointValue.latitude)&&Wt(i.geoPointValue.longitude)===Wt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Wt(i.integerValue)===Wt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Wt(i.doubleValue),u=Wt(s.doubleValue);return o===u?Gg(o)===Gg(u):isNaN(o)&&isNaN(u)}return!1}(t,e);case 9:return Lu(t.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(aC(o)!==aC(u))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!ns(o[c],u[c])))return!1;return!0}(t,e);default:return Ae()}}function md(t,e){return(t.values||[]).find(n=>ns(n,e))!==void 0}function bu(t,e){if(t===e)return 0;const n=tl(t),r=tl(e);if(n!==r)return st(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return st(t.booleanValue,e.booleanValue);case 2:return function(s,o){const u=Wt(s.integerValue||s.doubleValue),c=Wt(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return uC(t.timestampValue,e.timestampValue);case 4:return uC(pd(t),pd(e));case 5:return st(t.stringValue,e.stringValue);case 6:return function(s,o){const u=el(s),c=el(o);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const u=s.split("/"),c=o.split("/");for(let h=0;h<u.length&&h<c.length;h++){const p=st(u[h],c[h]);if(p!==0)return p}return st(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const u=st(Wt(s.latitude),Wt(o.latitude));return u!==0?u:st(Wt(s.longitude),Wt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return cC(t.arrayValue,e.arrayValue);case 10:return function(s,o){var u,c,h,p;const m=s.fields||{},_=o.fields||{},E=(u=m.value)===null||u===void 0?void 0:u.arrayValue,S=(c=_.value)===null||c===void 0?void 0:c.arrayValue,P=st(((h=E==null?void 0:E.values)===null||h===void 0?void 0:h.length)||0,((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:cC(E,S)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Rp.mapValue&&o===Rp.mapValue)return 0;if(s===Rp.mapValue)return 1;if(o===Rp.mapValue)return-1;const u=s.fields||{},c=Object.keys(u),h=o.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const _=st(c[m],p[m]);if(_!==0)return _;const E=bu(u[c[m]],h[p[m]]);if(E!==0)return E}return st(c.length,p.length)}(t.mapValue,e.mapValue);default:throw Ae()}}function uC(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return st(t,e);const n=Xo(t),r=Xo(e),i=st(n.seconds,r.seconds);return i!==0?i:st(n.nanos,r.nanos)}function cC(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=bu(n[i],r[i]);if(s)return s}return st(n.length,r.length)}function Fu(t){return m1(t)}function m1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Xo(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return el(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=m1(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${m1(n.fields[o])}`;return i+"}"}(t.mapValue):Ae()}function hC(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _1(t){return!!t&&"integerValue"in t}function yw(t){return!!t&&"arrayValue"in t}function dC(t){return!!t&&"nullValue"in t}function fC(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tg(t){return!!t&&"mapValue"in t}function iL(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function bh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return sc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=bh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=bh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function sL(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.value=e}static empty(){return new Zr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=bh(n)}setAll(e){let n=Fn.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}o?r[u.lastSegment()]=bh(o):i.push(u.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());tg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];tg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){sc(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Zr(bh(this.value))}}function j9(t){const e=[];return sc(t.fields,(n,r)=>{const i=new Fn([n]);if(tg(r)){const s=j9(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new wi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n,r,i,s,o,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new nr(e,0,Ne.min(),Ne.min(),Ne.min(),Zr.empty(),0)}static newFoundDocument(e,n,r,i){return new nr(e,1,n,Ne.min(),r,i,0)}static newNoDocument(e,n){return new nr(e,2,n,Ne.min(),Ne.min(),Zr.empty(),0)}static newUnknownDocument(e,n){return new nr(e,3,n,Ne.min(),Ne.min(),Zr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof nr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new nr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,n){this.position=e,this.inclusive=n}}function pC(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Se.comparator(Se.fromName(o.referenceValue),n.key):r=bu(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function gC(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ns(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,n="asc"){this.field=e,this.dir=n}}function oL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G9{}class Zt extends G9{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new lL(e,n,r):n==="array-contains"?new hL(e,r):n==="in"?new dL(e,r):n==="not-in"?new fL(e,r):n==="array-contains-any"?new pL(e,r):new Zt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new uL(e,r):new cL(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(bu(n,this.value)):n!==null&&tl(this.value)===tl(n)&&this.matchesComparison(bu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ki extends G9{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new ki(e,n)}matches(e){return W9(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function W9(t){return t.op==="and"}function H9(t){return aL(t)&&W9(t)}function aL(t){for(const e of t.filters)if(e instanceof ki)return!1;return!0}function v1(t){if(t instanceof Zt)return t.field.canonicalString()+t.op.toString()+Fu(t.value);if(H9(t))return t.filters.map(e=>v1(e)).join(",");{const e=t.filters.map(n=>v1(n)).join(",");return`${t.op}(${e})`}}function $9(t,e){return t instanceof Zt?function(r,i){return i instanceof Zt&&r.op===i.op&&r.field.isEqual(i.field)&&ns(r.value,i.value)}(t,e):t instanceof ki?function(r,i){return i instanceof ki&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&$9(o,i.filters[u]),!0):!1}(t,e):void Ae()}function q9(t){return t instanceof Zt?function(n){return`${n.field.canonicalString()} ${n.op} ${Fu(n.value)}`}(t):t instanceof ki?function(n){return n.op.toString()+" {"+n.getFilters().map(q9).join(" ,")+"}"}(t):"Filter"}class lL extends Zt{constructor(e,n,r){super(e,n,r),this.key=Se.fromName(r.referenceValue)}matches(e){const n=Se.comparator(e.key,this.key);return this.matchesComparison(n)}}class uL extends Zt{constructor(e,n){super(e,"in",n),this.keys=K9("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class cL extends Zt{constructor(e,n){super(e,"not-in",n),this.keys=K9("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function K9(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Se.fromName(r.referenceValue))}class hL extends Zt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return yw(n)&&md(n.arrayValue,this.value)}}class dL extends Zt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&md(this.value.arrayValue,n)}}class fL extends Zt{constructor(e,n){super(e,"not-in",n)}matches(e){if(md(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!md(this.value.arrayValue,n)}}class pL extends Zt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!yw(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>md(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(e,n=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.ue=null}}function mC(t,e=null,n=[],r=[],i=null,s=null,o=null){return new gL(t,e,n,r,i,s,o)}function ww(t){const e=De(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>v1(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Fu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Fu(r)).join(",")),e.ue=n}return e.ue}function Ew(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!oL(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!$9(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gC(t.startAt,e.startAt)&&gC(t.endAt,e.endAt)}function y1(t){return Se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,n=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function mL(t,e,n,r,i,s,o,u){return new Gd(t,e,n,r,i,s,o,u)}function Sw(t){return new Gd(t)}function _C(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Q9(t){return t.collectionGroup!==null}function Fh(t){const e=De(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Un(Fn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(u=u.add(h.field))})}),u})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Hg(s,r))}),n.has(Fn.keyField().canonicalString())||e.ce.push(new Hg(Fn.keyField(),r))}return e.ce}function Zi(t){const e=De(t);return e.le||(e.le=_L(e,Fh(t))),e.le}function _L(t,e){if(t.limitType==="F")return mC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Hg(i.field,s)});const n=t.endAt?new Wg(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Wg(t.startAt.position,t.startAt.inclusive):null;return mC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function w1(t,e){const n=t.filters.concat([e]);return new Gd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function E1(t,e,n){return new Gd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wm(t,e){return Ew(Zi(t),Zi(e))&&t.limitType===e.limitType}function Y9(t){return`${ww(Zi(t))}|lt:${t.limitType}`}function Yl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>q9(i)).join(", ")}]`),Gm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Fu(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Fu(i)).join(",")),`Target(${r})`}(Zi(t))}; limitType=${t.limitType})`}function Hm(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Fh(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,u,c){const h=pC(o,u,c);return o.inclusive?h<=0:h<0}(r.startAt,Fh(r),i)||r.endAt&&!function(o,u,c){const h=pC(o,u,c);return o.inclusive?h>=0:h>0}(r.endAt,Fh(r),i))}(t,e)}function vL(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function X9(t){return(e,n)=>{let r=!1;for(const i of Fh(t)){const s=yL(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function yL(t,e,n){const r=t.field.isKeyField()?Se.comparator(e.key,n.key):function(s,o,u){const c=o.data.field(s),h=u.data.field(s);return c!==null&&h!==null?bu(c,h):Ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){sc(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return z9(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=new en(Se.comparator);function qs(){return wL}const J9=new en(Se.comparator);function Eh(...t){let e=J9;for(const n of t)e=e.insert(n.key,n);return e}function Z9(t){let e=J9;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function za(){return Vh()}function eP(){return Vh()}function Vh(){return new oc(t=>t.toString(),(t,e)=>t.isEqual(e))}const EL=new en(Se.comparator),SL=new Un(Se.comparator);function Qe(...t){let e=SL;for(const n of t)e=e.add(n);return e}const TL=new Un(st);function CL(){return TL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gg(e)?"-0":e}}function tP(t){return{integerValue:""+t}}function IL(t,e){return tL(e)?tP(e):Tw(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(){this._=void 0}}function PL(t,e,n){return t instanceof _d?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&_w(s)&&(s=vw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof vd?rP(t,e):t instanceof yd?iP(t,e):function(i,s){const o=nP(i,s),u=vC(o)+vC(i.Pe);return _1(o)&&_1(i.Pe)?tP(u):Tw(i.serializer,u)}(t,e)}function RL(t,e,n){return t instanceof vd?rP(t,e):t instanceof yd?iP(t,e):n}function nP(t,e){return t instanceof $g?function(r){return _1(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class _d extends $m{}class vd extends $m{constructor(e){super(),this.elements=e}}function rP(t,e){const n=sP(e);for(const r of t.elements)n.some(i=>ns(i,r))||n.push(r);return{arrayValue:{values:n}}}class yd extends $m{constructor(e){super(),this.elements=e}}function iP(t,e){let n=sP(e);for(const r of t.elements)n=n.filter(i=>!ns(i,r));return{arrayValue:{values:n}}}class $g extends $m{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function vC(t){return Wt(t.integerValue||t.doubleValue)}function sP(t){return yw(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e,n){this.field=e,this.transform=n}}function AL(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof vd&&i instanceof vd||r instanceof yd&&i instanceof yd?Lu(r.elements,i.elements,ns):r instanceof $g&&i instanceof $g?ns(r.Pe,i.Pe):r instanceof _d&&i instanceof _d}(t.transform,e.transform)}class xL{constructor(e,n){this.version=e,this.transformResults=n}}class Fs{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Fs}static exists(e){return new Fs(void 0,e)}static updateTime(e){return new Fs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ng(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qm{}function oP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new lP(t.key,Fs.none()):new Wd(t.key,t.data,Fs.none());{const n=t.data,r=Zr.empty();let i=new Un(Fn.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new cl(t.key,r,new wi(i.toArray()),Fs.none())}}function NL(t,e,n){t instanceof Wd?function(i,s,o){const u=i.value.clone(),c=wC(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):t instanceof cl?function(i,s,o){if(!ng(i.precondition,s))return void s.convertToUnknownDocument(o.version);const u=wC(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(aP(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Uh(t,e,n,r){return t instanceof Wd?function(s,o,u,c){if(!ng(s.precondition,o))return u;const h=s.value.clone(),p=EC(s.fieldTransforms,c,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof cl?function(s,o,u,c){if(!ng(s.precondition,o))return u;const h=EC(s.fieldTransforms,c,o),p=o.data;return p.setAll(aP(s)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(s,o,u){return ng(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(t,e,n)}function DL(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=nP(r.transform,i||null);s!=null&&(n===null&&(n=Zr.empty()),n.set(r.field,s))}return n||null}function yC(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Lu(r,i,(s,o)=>AL(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wd extends qm{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class cl extends qm{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function aP(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function wC(t,e,n){const r=new Map;ht(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,RL(o,u,n[i]))}return r}function EC(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,PL(s,o,e))}return r}class lP extends qm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OL extends qm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&NL(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Uh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Uh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=eP();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let u=this.applyToLocalView(o,s.mutatedFields);u=n.has(i.key)?null:u;const c=oP(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Qe())}isEqual(e){return this.batchId===e.batchId&&Lu(this.mutations,e.mutations,(n,r)=>yC(n,r))&&Lu(this.baseMutations,e.baseMutations,(n,r)=>yC(n,r))}}class Cw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ht(e.mutations.length===r.length);let i=function(){return EL}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Cw(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt,et;function FL(t){switch(t){default:return Ae();case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0}}function uP(t){if(t===void 0)return $s("GRPC error has no .code"),Z.UNKNOWN;switch(t){case Xt.OK:return Z.OK;case Xt.CANCELLED:return Z.CANCELLED;case Xt.UNKNOWN:return Z.UNKNOWN;case Xt.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case Xt.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case Xt.INTERNAL:return Z.INTERNAL;case Xt.UNAVAILABLE:return Z.UNAVAILABLE;case Xt.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case Xt.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case Xt.NOT_FOUND:return Z.NOT_FOUND;case Xt.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case Xt.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case Xt.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case Xt.ABORTED:return Z.ABORTED;case Xt.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case Xt.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case Xt.DATA_LOSS:return Z.DATA_LOSS;default:return Ae()}}(et=Xt||(Xt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=new Ha([4294967295,4294967295],0);function SC(t){const e=VL().encode(t),n=new D9;return n.update(e),new Uint8Array(n.digest())}function TC(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ha([n,r],0),new Ha([i,s],0)]}class Iw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Sh(`Invalid padding: ${n}`);if(r<0)throw new Sh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Sh(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Sh(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ha.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Ha.fromNumber(r)));return i.compare(UL)===1&&(i=new Ha([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=SC(e),[r,i]=TC(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Iw(s,i,n);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ie===0)return;const n=SC(e),[r,i]=TC(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Sh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Hd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Km(Ne.min(),i,new en(st),qs(),Qe())}}class Hd{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Hd(r,n,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class cP{constructor(e,n){this.targetId=e,this.me=n}}class hP{constructor(e,n,r=Bn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class CC{constructor(){this.fe=0,this.ge=PC(),this.pe=Bn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Qe(),n=Qe(),r=Qe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ae()}}),new Hd(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=PC()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ht(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class zL{constructor(e){this.Le=e,this.Be=new Map,this.ke=qs(),this.qe=IC(),this.Qe=new en(st)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(y1(s))if(r===0){const o=new Se(s.path);this.Ue(n,o,nr.newNoDocument(o,Ne.min()))}else ht(r===1);else{const o=this.Ye(n);if(o!==r){const u=this.Ze(e),c=u?this.Xe(u,e,o):1;if(c!==0){this.je(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,u;try{o=el(r).toUint8Array()}catch(c){if(c instanceof B9)return Mu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new Iw(o,i,s)}catch(c){return Mu(c instanceof Sh?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const u=this.Je(o);if(u){if(s.current&&y1(u.target)){const c=new Se(u.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,nr.newNoDocument(c,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Qe();this.qe.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Km(e,n,this.Qe,this.ke,r);return this.ke=qs(),this.qe=IC(),this.Qe=new en(st),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new CC,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Un(st),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||we("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new CC),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function IC(){return new en(Se.comparator)}function PC(){return new en(Se.comparator)}const BL={asc:"ASCENDING",desc:"DESCENDING"},jL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GL={and:"AND",or:"OR"};class WL{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function S1(t,e){return t.useProto3Json||Gm(e)?e:{value:e}}function qg(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function HL(t,e){return qg(t,e.toTimestamp())}function es(t){return ht(!!t),Ne.fromTimestamp(function(n){const r=Xo(n);return new un(r.seconds,r.nanos)}(t))}function Pw(t,e){return T1(t,e).canonicalString()}function T1(t,e){const n=function(i){return new It(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function fP(t){const e=It.fromString(t);return ht(vP(e)),e}function C1(t,e){return Pw(t.databaseId,e.path)}function Bv(t,e){const n=fP(e);if(n.get(1)!==t.databaseId.projectId)throw new ge(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ge(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Se(gP(n))}function pP(t,e){return Pw(t.databaseId,e)}function $L(t){const e=fP(t);return e.length===4?It.emptyPath():gP(e)}function I1(t){return new It(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gP(t){return ht(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RC(t,e,n){return{name:C1(t,e),fields:n.value.mapValue.fields}}function qL(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(ht(p===void 0||typeof p=="string"),Bn.fromBase64String(p||"")):(ht(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Bn.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(h){const p=h.code===void 0?Z.UNKNOWN:uP(h.code);return new ge(p,h.message||"")}(o);n=new hP(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Bv(t,r.document.name),s=es(r.document.updateTime),o=r.document.createTime?es(r.document.createTime):Ne.min(),u=new Zr({mapValue:{fields:r.document.fields}}),c=nr.newFoundDocument(i,s,o,u),h=r.targetIds||[],p=r.removedTargetIds||[];n=new rg(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Bv(t,r.document),s=r.readTime?es(r.readTime):Ne.min(),o=nr.newNoDocument(i,s),u=r.removedTargetIds||[];n=new rg([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Bv(t,r.document),s=r.removedTargetIds||[];n=new rg([],s,i,null)}else{if(!("filter"in e))return Ae();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new bL(i,s),u=r.targetId;n=new cP(u,o)}}return n}function KL(t,e){let n;if(e instanceof Wd)n={update:RC(t,e.key,e.value)};else if(e instanceof lP)n={delete:C1(t,e.key)};else if(e instanceof cl)n={update:RC(t,e.key,e.data),updateMask:rb(e.fieldMask)};else{if(!(e instanceof OL))return Ae();n={verify:C1(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const u=o.transform;if(u instanceof _d)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof vd)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof yd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof $g)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw Ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:HL(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ae()}(t,e.precondition)),n}function QL(t,e){return t&&t.length>0?(ht(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?es(i.updateTime):es(s);return o.isEqual(Ne.min())&&(o=es(s)),new xL(o,i.transformResults||[])}(n,e))):[]}function YL(t,e){return{documents:[pP(t,e.path)]}}function XL(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=pP(t,i);const s=function(h){if(h.length!==0)return _P(ki.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:Xl(_.field),direction:eb(_.dir)}}(p))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const u=S1(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:i}}function JL(t){let e=$L(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ht(r===1);const p=n.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(m){const _=mP(m);return _ instanceof ki&&H9(_)?_.getFilters():[_]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(_=>function(S){return new Hg(Jl(S.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(_))}(n.orderBy));let u=null;n.limit&&(u=function(m){let _;return _=typeof m=="object"?m.value:m,Gm(_)?null:_}(n.limit));let c=null;n.startAt&&(c=function(m){const _=!!m.before,E=m.values||[];return new Wg(E,_)}(n.startAt));let h=null;return n.endAt&&(h=function(m){const _=!m.before,E=m.values||[];return new Wg(E,_)}(n.endAt)),mL(e,i,o,s,u,"F",c,h)}function ZL(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function mP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Jl(n.unaryFilter.field);return Zt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Jl(n.unaryFilter.field);return Zt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Jl(n.unaryFilter.field);return Zt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Jl(n.unaryFilter.field);return Zt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ae()}}(t):t.fieldFilter!==void 0?function(n){return Zt.create(Jl(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ki.create(n.compositeFilter.filters.map(r=>mP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ae()}}(n.compositeFilter.op))}(t):Ae()}function eb(t){return BL[t]}function tb(t){return jL[t]}function nb(t){return GL[t]}function Xl(t){return{fieldPath:t.canonicalString()}}function Jl(t){return Fn.fromServerFormat(t.fieldPath)}function _P(t){return t instanceof Zt?function(n){if(n.op==="=="){if(fC(n.value))return{unaryFilter:{field:Xl(n.field),op:"IS_NAN"}};if(dC(n.value))return{unaryFilter:{field:Xl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(fC(n.value))return{unaryFilter:{field:Xl(n.field),op:"IS_NOT_NAN"}};if(dC(n.value))return{unaryFilter:{field:Xl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xl(n.field),op:tb(n.op),value:n.value}}}(t):t instanceof ki?function(n){const r=n.getFilters().map(i=>_P(i));return r.length===1?r[0]:{compositeFilter:{op:nb(n.op),filters:r}}}(t):Ae()}function rb(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function vP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,n,r,i,s=Ne.min(),o=Ne.min(),u=Bn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new No(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new No(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new No(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new No(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e){this.ct=e}}function sb(t){const e=JL({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?E1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(){this.un=new ab}addToCollectionParentIndex(e,n){return this.un.add(n),ee.resolve()}getCollectionParents(e,n){return ee.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return ee.resolve()}deleteFieldIndex(e,n){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,n){return ee.resolve()}getDocumentsMatchingTarget(e,n){return ee.resolve(null)}getIndexType(e,n){return ee.resolve(0)}getFieldIndexes(e,n){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,n){return ee.resolve(Yo.min())}getMinOffsetFromCollectionGroup(e,n){return ee.resolve(Yo.min())}updateCollectionGroup(e,n,r){return ee.resolve()}updateIndexEntries(e,n){return ee.resolve()}}class ab{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Un(It.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Un(It.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Vu(0)}static kn(){return new Vu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(){this.changes=new oc(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,nr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ee.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Uh(r.mutation,i,wi.empty(),un.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Qe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Qe()){const i=za();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Eh();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=za();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Qe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{n.set(o,u)})})}computeViews(e,n,r,i){let s=qs();const o=Vh(),u=function(){return Vh()}();return n.forEach((c,h)=>{const p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof cl)?s=s.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),Uh(p.mutation,h,p.mutation.getFieldMask(),un.now())):o.set(h.key,wi.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((h,p)=>o.set(h,p)),n.forEach((h,p)=>{var m;return u.set(h,new ub(p,(m=o.get(h))!==null&&m!==void 0?m:null))}),u))}recalculateAndSaveOverlays(e,n){const r=Vh();let i=new en((o,u)=>o-u),s=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const u of o)u.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let p=r.get(c)||wi.empty();p=u.applyToLocalView(h,p),r.set(c,p);const m=(i.get(u.batchId)||Qe()).add(c);i=i.insert(u.batchId,m)})}).next(()=>{const o=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),h=c.key,p=c.value,m=eP();p.forEach(_=>{if(!s.has(_)){const E=oP(n.get(_),r.get(_));E!==null&&m.set(_,E),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return ee.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return Se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Q9(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):ee.resolve(za());let u=-1,c=s;return o.next(h=>ee.forEach(h,(p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),s.get(p)?ee.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{c=c.insert(p,_)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,c,h,Qe())).next(p=>({batchId:u,changes:Z9(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Se(n)).next(r=>{let i=Eh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Eh();return this.indexManager.getCollectionParents(e,s).next(u=>ee.forEach(u,c=>{const h=function(m,_){return new Gd(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((m,_)=>{o=o.insert(m,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,nr.newInvalidDocument(p)))});let u=Eh();return o.forEach((c,h)=>{const p=s.get(c);p!==void 0&&Uh(p.mutation,h,wi.empty(),un.now()),Hm(n,h)&&(u=u.insert(c,h))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return ee.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:es(i.createTime)}}(n)),ee.resolve()}getNamedQuery(e,n){return ee.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:sb(i.bundledQuery),readTime:es(i.readTime)}}(n)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(){this.overlays=new en(Se.comparator),this.Ir=new Map}getOverlay(e,n){return ee.resolve(this.overlays.get(n))}getOverlays(e,n){const r=za();return ee.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),ee.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),ee.resolve()}getOverlaysForCollection(e,n,r){const i=za(),s=n.length+1,o=new Se(n.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const c=u.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return ee.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new en((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=za(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const u=za(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>u.set(h,p)),!(u.size()>=i)););return ee.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new LL(n,r));let s=this.Ir.get(n);s===void 0&&(s=Qe(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(){this.sessionToken=Bn.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(){this.Tr=new Un(wn.Er),this.dr=new Un(wn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new wn(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new wn(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Se(new It([])),r=new wn(n,e),i=new wn(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Se(new It([])),r=new wn(n,e),i=new wn(n,e+1);let s=Qe();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new wn(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class wn{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Se.comparator(e.key,n.key)||st(e.wr,n.wr)}static Ar(e,n){return st(e.wr,n.wr)||Se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Un(wn.Er)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new ML(s,n,r,i);this.mutationQueue.push(o);for(const u of i)this.br=this.br.add(new wn(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ee.resolve(o)}lookupMutationBatch(e,n){return ee.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return ee.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new wn(n,0),i=new wn(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const u=this.Dr(o.wr);s.push(u)}),ee.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Un(st);return n.forEach(i=>{const s=new wn(i,0),o=new wn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],u=>{r=r.add(u.wr)})}),ee.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Se.isDocumentKey(s)||(s=s.child(""));const o=new wn(new Se(s),0);let u=new Un(st);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(u=u.add(c.wr)),!0)},o),ee.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ht(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return ee.forEach(n.mutations,i=>{const s=new wn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new wn(n,0),i=this.br.firstAfterOrEqual(r);return ee.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e){this.Mr=e,this.docs=function(){return new en(Se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ee.resolve(r?r.document.mutableCopy():nr.newInvalidDocument(n))}getEntries(e,n){let r=qs();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():nr.newInvalidDocument(i))}),ee.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=qs();const o=n.path,u=new Se(o.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||XM(YM(p),r)<=0||(i.has(p.key)||Hm(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return ee.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ae()}Or(e,n){return ee.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new mb(this)}getSize(e){return ee.resolve(this.size)}}class mb extends lb{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),ee.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e){this.persistence=e,this.Nr=new oc(n=>ww(n),Ew),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Rw,this.targetCount=0,this.kr=Vu.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),ee.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Vu(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,ee.resolve()}updateTargetData(e,n){return this.Kn(n),ee.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),ee.waitFor(s).next(()=>i)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return ee.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),ee.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ee.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),ee.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return ee.resolve(r)}containsKey(e,n){return ee.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(e,n){this.qr={},this.overlays={},this.Qr=new mw(0),this.Kr=!1,this.Kr=!0,this.$r=new fb,this.referenceDelegate=e(this),this.Ur=new _b(this),this.indexManager=new ob,this.remoteDocumentCache=function(i){return new gb(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ib(n),this.Gr=new hb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new db,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new pb(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){we("MemoryPersistence","Starting transaction:",e);const i=new yb(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return ee.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class yb extends ZM{constructor(e){super(),this.currentSequenceNumber=e}}class kw{constructor(e){this.persistence=e,this.Jr=new Rw,this.Yr=null}static Zr(e){return new kw(e)}get Xr(){if(this.Yr)return this.Yr;throw Ae()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),ee.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),ee.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.Xr,r=>{const i=Se.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ne.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return ee.or([()=>ee.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Qe(),i=Qe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Aw(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return vN()?8:eL(ir())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new wb;return this.Xi(e,n,o).next(u=>{if(s.result=u,this.zi)return this.es(e,n,o,u.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(ah()<=Ke.DEBUG&&we("QueryEngine","SDK will not create cache indexes for query:",Yl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ee.resolve()):(ah()<=Ke.DEBUG&&we("QueryEngine","Query:",Yl(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ah()<=Ke.DEBUG&&we("QueryEngine","The SDK decides to create cache indexes for query:",Yl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zi(n))):ee.resolve())}Yi(e,n){if(_C(n))return ee.resolve(null);let r=Zi(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=E1(n,null,"F"),r=Zi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Qe(...s);return this.Ji.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(n,u);return this.ns(n,h,o,c.readTime)?this.Yi(e,E1(n,null,"F")):this.rs(e,h,n,c)}))})))}Zi(e,n,r,i){return _C(n)||i.isEqual(Ne.min())?ee.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?ee.resolve(null):(ah()<=Ke.DEBUG&&we("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Yl(n)),this.rs(e,o,n,QM(i,-1)).next(u=>u))})}ts(e,n){let r=new Un(X9(e));return n.forEach((i,s)=>{Hm(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return ah()<=Ke.DEBUG&&we("QueryEngine","Using full collection scan to execute query:",Yl(n)),this.Ji.getDocumentsMatchingQuery(e,n,Yo.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new en(st),this._s=new oc(s=>ww(s),Ew),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cb(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Tb(t,e,n,r){return new Sb(t,e,n,r)}async function yP(t,e){const n=De(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],u=[];let c=Qe();for(const h of i){o.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of s){u.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:u}))})})}function Cb(t,e){const n=De(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,h,p){const m=h.batch,_=m.keys();let E=ee.resolve();return _.forEach(S=>{E=E.next(()=>p.getEntry(c,S)).next(P=>{const N=h.docVersions.get(S);ht(N!==null),P.version.compareTo(N)<0&&(m.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),E.next(()=>u.mutationQueue.removeMutationBatch(c,m))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=Qe();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(c=c.add(u.batch.mutations[h].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function wP(t){const e=De(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function Ib(t,e){const n=De(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((p,m)=>{const _=i.get(m);if(!_)return;u.push(n.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(s,p.addedDocuments,m)));let E=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?E=E.withResumeToken(Bn.EMPTY_BYTE_STRING,Ne.min()).withLastLimboFreeSnapshotVersion(Ne.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),i=i.insert(m,E),function(P,N,R){return P.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(_,E,p)&&u.push(n.Ur.updateTargetData(s,E))});let c=qs(),h=Qe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(Pb(s,o,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(Ne.min())){const p=n.Ur.getLastRemoteSnapshotVersion(s).next(m=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return ee.waitFor(u).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(n.os=i,s))}function Pb(t,e,n){let r=Qe(),i=Qe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=qs();return n.forEach((u,c)=>{const h=s.get(u);c.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Ne.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):we("LocalStore","Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function Rb(t,e){const n=De(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kb(t,e){const n=De(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,ee.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new No(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function P1(t,e,n){const r=De(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!jd(o))throw o;we("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function kC(t,e,n){const r=De(t);let i=Ne.min(),s=Qe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,h,p){const m=De(c),_=m._s.get(p);return _!==void 0?ee.resolve(m.os.get(_)):m.Ur.getTargetData(h,p)}(r,o,Zi(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:Ne.min(),n?s:Qe())).next(u=>(Ab(r,vL(e),u),{documents:u,Ts:s})))}function Ab(t,e,n){let r=t.us.get(e)||Ne.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class AC{constructor(){this.activeTargetIds=CL()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xb{constructor(){this.so=new AC,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new AC,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){we("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){we("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kp=null;function jv(){return kp===null?kp=function(){return 268435456+Math.round(2147483648*Math.random())}():kp++,"0x"+kp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Db={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn="WebChannelConnection";class Mb extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const u=jv(),c=this.xo(n,r.toUriEncodedString());we("RestConnection",`Sending RPC '${n}' ${u}:`,c,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,o),this.No(n,c,h,i).then(p=>(we("RestConnection",`Received RPC '${n}' ${u}: `,p),p),p=>{throw Mu("RestConnection",`RPC '${n}' ${u} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(n,r,i,s,o,u){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ic}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=Db[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=jv();return new Promise((o,u)=>{const c=new O9;c.setWithCredentials(!0),c.listenOnce(M9.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case eg.NO_ERROR:const p=c.getResponseJson();we(Zn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),o(p);break;case eg.TIMEOUT:we(Zn,`RPC '${e}' ${s} timed out`),u(new ge(Z.DEADLINE_EXCEEDED,"Request time out"));break;case eg.HTTP_ERROR:const m=c.getStatus();if(we(Zn,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let _=c.getResponseJson();Array.isArray(_)&&(_=_[0]);const E=_==null?void 0:_.error;if(E&&E.status&&E.message){const S=function(N){const R=N.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(R)>=0?R:Z.UNKNOWN}(E.status);u(new ge(S,E.message))}else u(new ge(Z.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new ge(Z.UNAVAILABLE,"Connection failed."));break;default:Ae()}}finally{we(Zn,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);we(Zn,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",h,r,15)})}Bo(e,n,r){const i=jv(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=F9(),u=b9(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=s.join("");we(Zn,`Creating RPC '${e}' stream ${i}: ${p}`,c);const m=o.createWebChannel(p,c);let _=!1,E=!1;const S=new Ob({Io:N=>{E?we(Zn,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(_||(we(Zn,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),we(Zn,`RPC '${e}' stream ${i} sending:`,N),m.send(N))},To:()=>m.close()}),P=(N,R,k)=>{N.listen(R,w=>{try{k(w)}catch(A){setTimeout(()=>{throw A},0)}})};return P(m,wh.EventType.OPEN,()=>{E||(we(Zn,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),P(m,wh.EventType.CLOSE,()=>{E||(E=!0,we(Zn,`RPC '${e}' stream ${i} transport closed`),S.So())}),P(m,wh.EventType.ERROR,N=>{E||(E=!0,Mu(Zn,`RPC '${e}' stream ${i} transport errored:`,N),S.So(new ge(Z.UNAVAILABLE,"The operation could not be completed")))}),P(m,wh.EventType.MESSAGE,N=>{var R;if(!E){const k=N.data[0];ht(!!k);const w=k,A=w.error||((R=w[0])===null||R===void 0?void 0:R.error);if(A){we(Zn,`RPC '${e}' stream ${i} received error:`,A);const V=A.status;let U=function(D){const x=Xt[D];if(x!==void 0)return uP(x)}(V),O=A.message;U===void 0&&(U=Z.INTERNAL,O="Unknown error status: "+V+" with message "+A.message),E=!0,S.So(new ge(U,O)),m.close()}else we(Zn,`RPC '${e}' stream ${i} received:`,k),S.bo(k)}}),P(u,L9.STAT_EVENT,N=>{N.stat===p1.PROXY?we(Zn,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===p1.NOPROXY&&we(Zn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}function Gv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(t){return new WL(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&we("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,n,r,i,s,o,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new EP(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Z.RESOURCE_EXHAUSTED?($s(n.toString()),$s("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ge(Z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return we("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(we("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Lb extends SP{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=qL(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ne.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ne.min():o.readTime?es(o.readTime):Ne.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=I1(this.serializer),n.addTarget=function(s,o){let u;const c=o.target;if(u=y1(c)?{documents:YL(s,c)}:{query:XL(s,c)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=dP(s,o.resumeToken);const h=S1(s,o.expectedCount);h!==null&&(u.expectedCount=h)}else if(o.snapshotVersion.compareTo(Ne.min())>0){u.readTime=qg(s,o.snapshotVersion.toTimestamp());const h=S1(s,o.expectedCount);h!==null&&(u.expectedCount=h)}return u}(this.serializer,e);const r=ZL(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=I1(this.serializer),n.removeTarget=e,this.a_(n)}}class bb extends SP{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ht(!!e.streamToken),this.lastStreamToken=e.streamToken,ht(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ht(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=QL(e.writeResults,e.commitTime),r=es(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=I1(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>KL(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ge(Z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,T1(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ge(Z.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Lo(e,T1(n,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ge(Z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Vb{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?($s(n),this.D_=!1):we("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{hl(this)&&(we("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=De(c);h.L_.add(4),await $d(h),h.q_.set("Unknown"),h.L_.delete(4),await Ym(h)}(this))})}),this.q_=new Vb(r,i)}}async function Ym(t){if(hl(t))for(const e of t.B_)await e(!0)}async function $d(t){for(const e of t.B_)await e(!1)}function TP(t,e){const n=De(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ow(n)?Dw(n):ac(n).r_()&&Nw(n,e))}function xw(t,e){const n=De(t),r=ac(n);n.N_.delete(e),r.r_()&&CP(n,e),n.N_.size===0&&(r.r_()?r.o_():hl(n)&&n.q_.set("Unknown"))}function Nw(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ac(t).A_(e)}function CP(t,e){t.Q_.xe(e),ac(t).R_(e)}function Dw(t){t.Q_=new zL({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ac(t).start(),t.q_.v_()}function Ow(t){return hl(t)&&!ac(t).n_()&&t.N_.size>0}function hl(t){return De(t).L_.size===0}function IP(t){t.Q_=void 0}async function zb(t){t.q_.set("Online")}async function Bb(t){t.N_.forEach((e,n)=>{Nw(t,e)})}async function jb(t,e){IP(t),Ow(t)?(t.q_.M_(e),Dw(t)):t.q_.set("Unknown")}async function Gb(t,e,n){if(t.q_.set("Online"),e instanceof hP&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const u of s.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){we("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kg(t,r)}else if(e instanceof rg?t.Q_.Ke(e):e instanceof cP?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ne.min()))try{const r=await wP(t.localStore);n.compareTo(r)>=0&&await function(s,o){const u=s.Q_.rt(o);return u.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,h)=>{const p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Bn.EMPTY_BYTE_STRING,p.snapshotVersion)),CP(s,c);const m=new No(p.target,c,h,p.sequenceNumber);Nw(s,m)}),s.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){we("RemoteStore","Failed to raise snapshot:",r),await Kg(t,r)}}async function Kg(t,e,n){if(!jd(e))throw e;t.L_.add(1),await $d(t),t.q_.set("Offline"),n||(n=()=>wP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{we("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Ym(t)})}function PP(t,e){return e().catch(n=>Kg(t,n,e))}async function Xm(t){const e=De(t),n=Jo(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Wb(e);)try{const i=await Rb(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,Hb(e,i)}catch(i){await Kg(e,i)}RP(e)&&kP(e)}function Wb(t){return hl(t)&&t.O_.length<10}function Hb(t,e){t.O_.push(e);const n=Jo(t);n.r_()&&n.V_&&n.m_(e.mutations)}function RP(t){return hl(t)&&!Jo(t).n_()&&t.O_.length>0}function kP(t){Jo(t).start()}async function $b(t){Jo(t).p_()}async function qb(t){const e=Jo(t);for(const n of t.O_)e.m_(n.mutations)}async function Kb(t,e,n){const r=t.O_.shift(),i=Cw.from(r,e,n);await PP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Xm(t)}async function Qb(t,e){e&&Jo(t).V_&&await async function(r,i){if(function(o){return FL(o)&&o!==Z.ABORTED}(i.code)){const s=r.O_.shift();Jo(r).s_(),await PP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Xm(r)}}(t,e),RP(t)&&kP(t)}async function NC(t,e){const n=De(t);n.asyncQueue.verifyOperationInProgress(),we("RemoteStore","RemoteStore received new credentials");const r=hl(n);n.L_.add(3),await $d(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Ym(n)}async function Yb(t,e){const n=De(t);e?(n.L_.delete(2),await Ym(n)):e||(n.L_.add(2),await $d(n),n.q_.set("Unknown"))}function ac(t){return t.K_||(t.K_=function(n,r,i){const s=De(n);return s.w_(),new Lb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:zb.bind(null,t),Ro:Bb.bind(null,t),mo:jb.bind(null,t),d_:Gb.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ow(t)?Dw(t):t.q_.set("Unknown")):(await t.K_.stop(),IP(t))})),t.K_}function Jo(t){return t.U_||(t.U_=function(n,r,i){const s=De(n);return s.w_(),new bb(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:$b.bind(null,t),mo:Qb.bind(null,t),f_:qb.bind(null,t),g_:Kb.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Xm(t)):(await t.U_.stop(),t.O_.length>0&&(we("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new bs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,u=new Mw(e,n,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lw(t,e){if($s("AsyncQueue",`${e}: ${t}`),jd(t))return new ge(Z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Se.comparator(n.key,r.key):(n,r)=>Se.comparator(n.key,r.key),this.keyedMap=Eh(),this.sortedSet=new en(this.comparator)}static emptySet(e){return new Eu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Eu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Eu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.W_=new en(Se.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Ae():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Uu{constructor(e,n,r,i,s,o,u,c,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(u=>{o.push({type:0,doc:u})}),new Uu(e,n,Eu.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Jb{constructor(){this.queries=OC(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=De(n),s=i.queries;i.queries=OC(),s.forEach((o,u)=>{for(const c of u.j_)c.onError(r)})})(this,new ge(Z.ABORTED,"Firestore shutting down"))}}function OC(){return new oc(t=>Y9(t),Wm)}async function AP(t,e){const n=De(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new Xb,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const u=Lw(o,`Initialization of query '${Yl(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&bw(n)}async function xP(t,e){const n=De(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Zb(t,e){const n=De(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const u of o.j_)u.X_(i)&&(r=!0);o.z_=i}}r&&bw(n)}function eF(t,e,n){const r=De(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function bw(t){t.Y_.forEach(e=>{e.next()})}var R1,MC;(MC=R1||(R1={})).ea="default",MC.Cache="cache";class NP{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Uu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Uu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==R1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.key=e}}class OP{constructor(e){this.key=e}}class tF{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Qe(),this.mutatedKeys=Qe(),this.Aa=X9(e),this.Ra=new Eu(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new DC,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{const _=i.get(p),E=Hm(this.query,m)?m:null,S=!!_&&this.mutatedKeys.has(_.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let N=!1;_&&E?_.data.isEqual(E.data)?S!==P&&(r.track({type:3,doc:E}),N=!0):this.ga(_,E)||(r.track({type:2,doc:E}),N=!0,(c&&this.Aa(E,c)>0||h&&this.Aa(E,h)<0)&&(u=!0)):!_&&E?(r.track({type:0,doc:E}),N=!0):_&&!E&&(r.track({type:1,doc:_}),N=!0,(c||h)&&(u=!0)),N&&(E?(o=o.add(E),s=P?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:o,fa:r,ns:u,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((p,m)=>function(E,S){const P=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae()}};return P(E)-P(S)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,h=c!==this.Ea;return this.Ea=c,o.length!==0||h?{snapshot:new Uu(this.query,e.Ra,s,o,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new DC,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Qe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new OP(r))}),this.da.forEach(r=>{e.has(r)||n.push(new DP(r))}),n}ba(e){this.Ta=e.Ts,this.da=Qe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Uu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class nF{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class rF{constructor(e){this.key=e,this.va=!1}}class iF{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new oc(u=>Y9(u),Wm),this.Ma=new Map,this.xa=new Set,this.Oa=new en(Se.comparator),this.Na=new Map,this.La=new Rw,this.Ba={},this.ka=new Map,this.qa=Vu.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function sF(t,e,n=!0){const r=UP(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await MP(r,e,n,!0),i}async function oF(t,e){const n=UP(t);await MP(n,e,!0,!1)}async function MP(t,e,n,r){const i=await kb(t.localStore,Zi(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let u;return r&&(u=await aF(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&TP(t.remoteStore,i),u}async function aF(t,e,n,r,i){t.Ka=(m,_,E)=>async function(P,N,R,k){let w=N.view.ma(R);w.ns&&(w=await kC(P.localStore,N.query,!1).then(({documents:O})=>N.view.ma(O,w)));const A=k&&k.targetChanges.get(N.targetId),V=k&&k.targetMismatches.get(N.targetId)!=null,U=N.view.applyChanges(w,P.isPrimaryClient,A,V);return bC(P,N.targetId,U.wa),U.snapshot}(t,m,_,E);const s=await kC(t.localStore,e,!0),o=new tF(e,s.Ts),u=o.ma(s.documents),c=Hd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),h=o.applyChanges(u,t.isPrimaryClient,c);bC(t,n,h.wa);const p=new nF(e,n,o);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function lF(t,e,n){const r=De(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Wm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await P1(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&xw(r.remoteStore,i.targetId),k1(r,i.targetId)}).catch(Bd)):(k1(r,i.targetId),await P1(r.localStore,i.targetId,!0))}async function uF(t,e){const n=De(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),xw(n.remoteStore,r.targetId))}async function cF(t,e,n){const r=_F(t);try{const i=await function(o,u){const c=De(o),h=un.now(),p=u.reduce((E,S)=>E.add(S.key),Qe());let m,_;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let S=qs(),P=Qe();return c.cs.getEntries(E,p).next(N=>{S=N,S.forEach((R,k)=>{k.isValidDocument()||(P=P.add(R))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,S)).next(N=>{m=N;const R=[];for(const k of u){const w=DL(k,m.get(k.key).overlayedDocument);w!=null&&R.push(new cl(k.key,w,j9(w.value.mapValue),Fs.exists(!0)))}return c.mutationQueue.addMutationBatch(E,h,R,u)}).next(N=>{_=N;const R=N.applyToLocalDocumentSet(m,P);return c.documentOverlayCache.saveOverlays(E,N.batchId,R)})}).then(()=>({batchId:_.batchId,changes:Z9(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let h=o.Ba[o.currentUser.toKey()];h||(h=new en(st)),h=h.insert(u,c),o.Ba[o.currentUser.toKey()]=h}(r,i.batchId,n),await qd(r,i.changes),await Xm(r.remoteStore)}catch(i){const s=Lw(i,"Failed to persist write");n.reject(s)}}async function LP(t,e){const n=De(t);try{const r=await Ib(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(ht(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?ht(o.va):i.removedDocuments.size>0&&(ht(o.va),o.va=!1))}),await qd(n,r,e)}catch(r){await Bd(r)}}function LC(t,e,n){const r=De(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const u=o.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){const c=De(o);c.onlineState=u;let h=!1;c.queries.forEach((p,m)=>{for(const _ of m.j_)_.Z_(u)&&(h=!0)}),h&&bw(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function hF(t,e,n){const r=De(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new en(Se.comparator);o=o.insert(s,nr.newNoDocument(s,Ne.min()));const u=Qe().add(s),c=new Km(Ne.min(),new Map,new en(st),o,u);await LP(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Fw(r)}else await P1(r.localStore,e,!1).then(()=>k1(r,e,n)).catch(Bd)}async function dF(t,e){const n=De(t),r=e.batch.batchId;try{const i=await Cb(n.localStore,e);FP(n,r,null),bP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await qd(n,i)}catch(i){await Bd(i)}}async function fF(t,e,n){const r=De(t);try{const i=await function(o,u){const c=De(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,u).next(m=>(ht(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);FP(r,e,n),bP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await qd(r,i)}catch(i){await Bd(i)}}function bP(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function FP(t,e,n){const r=De(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function k1(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||VP(t,r)})}function VP(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(xw(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Fw(t))}function bC(t,e,n){for(const r of n)r instanceof DP?(t.La.addReference(r.key,e),pF(t,r)):r instanceof OP?(we("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||VP(t,r.key)):Ae()}function pF(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(we("SyncEngine","New document in limbo: "+n),t.xa.add(r),Fw(t))}function Fw(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Se(It.fromString(e)),r=t.qa.next();t.Na.set(r,new rF(n)),t.Oa=t.Oa.insert(n,r),TP(t.remoteStore,new No(Zi(Sw(n.path)),r,"TargetPurposeLimboResolution",mw.oe))}}async function qd(t,e,n){const r=De(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{o.push(r.Ka(c,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const m=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){i.push(h);const m=Aw.Wi(c.targetId,h);s.push(m)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(c,h){const p=De(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>ee.forEach(h,_=>ee.forEach(_.$i,E=>p.persistence.referenceDelegate.addReference(m,_.targetId,E)).next(()=>ee.forEach(_.Ui,E=>p.persistence.referenceDelegate.removeReference(m,_.targetId,E)))))}catch(m){if(!jd(m))throw m;we("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const E=p.os.get(_),S=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(S);p.os=p.os.insert(_,P)}}}(r.localStore,s))}async function gF(t,e){const n=De(t);if(!n.currentUser.isEqual(e)){we("SyncEngine","User change. New user:",e.toKey());const r=await yP(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(u=>{u.forEach(c=>{c.reject(new ge(Z.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await qd(n,r.hs)}}function mF(t,e){const n=De(t),r=n.Na.get(e);if(r&&r.va)return Qe().add(r.key);{let i=Qe();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const u=n.Fa.get(o);i=i.unionWith(u.view.Va)}return i}}function UP(t){const e=De(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=LP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hF.bind(null,e),e.Ca.d_=Zb.bind(null,e.eventManager),e.Ca.$a=eF.bind(null,e.eventManager),e}function _F(t){const e=De(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fF.bind(null,e),e}class Qg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Tb(this.persistence,new Eb,e.initialUser,this.serializer)}Ga(e){return new vb(kw.Zr,this.serializer)}Wa(e){return new xb}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qg.provider={build:()=>new Qg};class A1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>LC(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gF.bind(null,this.syncEngine),await Yb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Jb}()}createDatastore(e){const n=Qm(e.databaseInfo.databaseId),r=function(s){return new Mb(s)}(e.databaseInfo);return function(s,o,u,c){return new Fb(s,o,u,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,u){return new Ub(r,i,s,o,u)}(this.localStore,this.datastore,e.asyncQueue,n=>LC(this.syncEngine,n,0),function(){return xC.D()?new xC:new Nb}())}createSyncEngine(e,n){return function(i,s,o,u,c,h,p){const m=new iF(i,s,o,u,c,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=De(i);we("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await $d(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}A1.provider={build:()=>new A1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):$s("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vF{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=er.UNAUTHENTICATED,this.clientId=U9.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{we("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(we("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new bs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Lw(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Wv(t,e){t.asyncQueue.verifyOperationInProgress(),we("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await yP(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function FC(t,e){t.asyncQueue.verifyOperationInProgress();const n=await yF(t);we("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>NC(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>NC(e.remoteStore,i)),t._onlineComponents=e}async function yF(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){we("FirestoreClient","Using user provided OfflineComponentProvider");try{await Wv(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Z.FAILED_PRECONDITION||i.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Mu("Error using user provided cache. Falling back to memory cache: "+n),await Wv(t,new Qg)}}else we("FirestoreClient","Using default OfflineComponentProvider"),await Wv(t,new Qg);return t._offlineComponents}async function BP(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(we("FirestoreClient","Using user provided OnlineComponentProvider"),await FC(t,t._uninitializedComponentsProvider._online)):(we("FirestoreClient","Using default OnlineComponentProvider"),await FC(t,new A1))),t._onlineComponents}function wF(t){return BP(t).then(e=>e.syncEngine)}async function jP(t){const e=await BP(t),n=e.eventManager;return n.onListen=sF.bind(null,e.syncEngine),n.onUnlisten=lF.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=oF.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=uF.bind(null,e.syncEngine),n}function EF(t,e,n={}){const r=new bs;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,h){const p=new zP({next:_=>{p.Za(),o.enqueueAndForget(()=>xP(s,m));const E=_.docs.has(u);!E&&_.fromCache?h.reject(new ge(Z.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&_.fromCache&&c&&c.source==="server"?h.reject(new ge(Z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new NP(Sw(u.path),p,{includeMetadataChanges:!0,_a:!0});return AP(s,m)}(await jP(t),t.asyncQueue,e,n,r)),r.promise}function SF(t,e,n={}){const r=new bs;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,u,c,h){const p=new zP({next:_=>{p.Za(),o.enqueueAndForget(()=>xP(s,m)),_.fromCache&&c.source==="server"?h.reject(new ge(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new NP(u,p,{includeMetadataChanges:!0,_a:!0});return AP(s,m)}(await jP(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GP(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(t,e,n){if(!n)throw new ge(Z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function TF(t,e,n,r){if(e===!0&&r===!0)throw new ge(Z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function UC(t){if(!Se.isDocumentKey(t))throw new ge(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zC(t){if(Se.isDocumentKey(t))throw new ge(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Jm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ae()}function zu(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ge(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Jm(t);throw new ge(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ge(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ge(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ge(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zm{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BC({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BC(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new zM;switch(r.type){case"firstParty":return new WM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ge(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=VC.get(n);r&&(we("ComponentProvider","Removing Datastore"),VC.delete(n),r.terminate())}(this),Promise.resolve()}}function CF(t,e,n,r={}){var i;const s=(t=zu(t,Zm))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Mu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=er.MOCK_USER;else{u=q6(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new ge(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new er(h)}t._authCredentials=new BM(new V9(u,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lc(this.firestore,e,this._query)}}class Fr{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ho(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fr(this.firestore,e,this._key)}}class Ho extends lc{constructor(e,n,r){super(e,n,Sw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fr(this.firestore,null,new Se(e))}withConverter(e){return new Ho(this.firestore,e,this._path)}}function x1(t,e,...n){if(t=cn(t),WP("collection","path",e),t instanceof Zm){const r=It.fromString(e,...n);return zC(r),new Ho(t,null,r)}{if(!(t instanceof Fr||t instanceof Ho))throw new ge(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(It.fromString(e,...n));return zC(r),new Ho(t.firestore,null,r)}}function HP(t,e,...n){if(t=cn(t),arguments.length===1&&(e=U9.newId()),WP("doc","path",e),t instanceof Zm){const r=It.fromString(e,...n);return UC(r),new Fr(t,null,new Se(r))}{if(!(t instanceof Fr||t instanceof Ho))throw new ge(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(It.fromString(e,...n));return UC(r),new Fr(t.firestore,t instanceof Ho?t.converter:null,new Se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new EP(this,"async_queue_retry"),this.Vu=()=>{const r=Gv();r&&we("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Gv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Gv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new bs;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!jd(e))throw e;we("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw $s("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Mw.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class e0 extends Zm{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new jC,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new jC(e),this._firestoreClient=void 0,await e}}}function IF(t,e){const n=typeof t=="object"?t:rw(),r=typeof t=="string"?t:"(default)",i=Um(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=W6("firestore");s&&CF(i,...s)}return i}function Vw(t){if(t._terminated)throw new ge(Z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||PF(t),t._firestoreClient}function PF(t){var e,n,r;const i=t._freezeSettings(),s=function(u,c,h,p){return new rL(u,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,GP(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new vF(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bu(Bn.fromBase64String(e))}catch(n){throw new ge(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Bu(Bn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ge(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ge(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ge(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RF=/^__.*__$/;class kF{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new cl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wd(e,this.data,n,this.fieldTransforms)}}function $P(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae()}}class Gw{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Gw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yg(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if($P(this.Cu)&&RF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class AF{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Qm(e)}Qu(e,n,r,i=!1){return new Gw({Cu:e,methodName:n,qu:r,path:Fn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qP(t){const e=t._freezeSettings(),n=Qm(t._databaseId);return new AF(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xF(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);YP("Data must be an object, but it was:",o,r);const u=KP(r,o);let c,h;if(s.merge)c=new wi(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const _=DF(e,m,n);if(!o.contains(_))throw new ge(Z.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);MF(p,_)||p.push(_)}c=new wi(p),h=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=o.fieldTransforms;return new kF(new Zr(u),c,h)}class Ww extends zw{_toFieldTransform(e){return new kL(e.path,new _d)}isEqual(e){return e instanceof Ww}}function NF(t,e,n,r=!1){return Hw(n,t.Qu(r?4:3,e))}function Hw(t,e){if(QP(t=cn(t)))return YP("Unsupported field value:",e,t),KP(t,e);if(t instanceof zw)return function(r,i){if(!$P(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const u of r){let c=Hw(u,i.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=cn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return IL(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=un.fromDate(r);return{timestampValue:qg(i.serializer,s)}}if(r instanceof un){const s=new un(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qg(i.serializer,s)}}if(r instanceof Bw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Bu)return{bytesValue:dP(i.serializer,r._byteString)};if(r instanceof Fr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Pw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof jw)return function(o,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return Tw(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Jm(r)}`)}(t,e)}function KP(t,e){const n={};return z9(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):sc(t,(r,i)=>{const s=Hw(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function QP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof un||t instanceof Bw||t instanceof Bu||t instanceof Fr||t instanceof zw||t instanceof jw)}function YP(t,e,n){if(!QP(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Jm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function DF(t,e,n){if((e=cn(e))instanceof Uw)return e._internalPath;if(typeof e=="string")return XP(t,e);throw Yg("Field path arguments must be of type string or ",t,!1,void 0,n)}const OF=new RegExp("[~\\*/\\[\\]]");function XP(t,e,n){if(e.search(OF)>=0)throw Yg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Uw(...e.split("."))._internalPath}catch{throw Yg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yg(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ge(Z.INVALID_ARGUMENT,u+t+c)}function MF(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field($w("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class LF extends JP{data(){return super.data()}}function $w(t,e){return typeof e=="string"?XP(t,e):e instanceof Uw?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bF(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ge(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qw{}class FF extends qw{}function GC(t,e,...n){let r=[];e instanceof qw&&r.push(e),r=r.concat(n),function(s){const o=s.filter(c=>c instanceof Kw).length,u=s.filter(c=>c instanceof t0).length;if(o>1||o>0&&u>0)throw new ge(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class t0 extends FF{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t0(e,n,r)}_apply(e){const n=this._parse(e);return ZP(e._query,n),new lc(e.firestore,e.converter,w1(e._query,n))}_parse(e){const n=qP(e.firestore);return function(s,o,u,c,h,p,m){let _;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new ge(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){HC(m,p);const E=[];for(const S of m)E.push(WC(c,s,S));_={arrayValue:{values:E}}}else _=WC(c,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||HC(m,p),_=NF(u,o,m,p==="in"||p==="not-in");return Zt.create(h,p,_)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Hv(t,e,n){const r=e,i=$w("where",t);return t0._create(i,r,n)}class Kw extends qw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Kw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ki.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const u=s.getFlattenedFilters();for(const c of u)ZP(o,c),o=w1(o,c)}(e._query,n),new lc(e.firestore,e.converter,w1(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function WC(t,e,n){if(typeof(n=cn(n))=="string"){if(n==="")throw new ge(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Q9(e)&&n.indexOf("/")!==-1)throw new ge(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(It.fromString(n));if(!Se.isDocumentKey(r))throw new ge(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hC(t,new Se(r))}if(n instanceof Fr)return hC(t,n._key);throw new ge(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Jm(n)}.`)}function HC(t,e){if(!Array.isArray(t)||t.length===0)throw new ge(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ZP(t,e){const n=function(i,s){for(const o of i)for(const u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ge(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class VF{convertValue(e,n="none"){switch(tl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(el(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return sc(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Wt(o.doubleValue));return new jw(s)}convertGeoPoint(e){return new Bw(Wt(e.latitude),Wt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vw(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(pd(e));default:return null}}convertTimestamp(e){const n=Xo(e);return new un(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=It.fromString(e);ht(vP(r));const i=new gd(r.get(1),r.get(3)),s=new Se(r.popFirst(5));return i.isEqual(n)||$s(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class e8 extends JP{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ig(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field($w("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ig extends e8{data(e={}){return super.data(e)}}class zF{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Th(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ig(this._firestore,this._userDataWriter,r.key,r,new Th(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ge(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{const c=new ig(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Th(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{const c=new ig(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Th(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return u.type!==0&&(h=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:BF(u.type),doc:c,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function BF(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(t){t=zu(t,Fr);const e=zu(t.firestore,e0);return EF(Vw(e),t._key).then(n=>HF(e,t,n))}class t8 extends VF{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bu(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fr(this.firestore,null,n)}}function $C(t){t=zu(t,lc);const e=zu(t.firestore,e0),n=Vw(e),r=new t8(e);return bF(t._query),SF(n,t._query).then(i=>new zF(e,r,t,i))}function GF(t,e){const n=zu(t.firestore,e0),r=HP(t),i=UF(t.converter,e);return WF(n,[xF(qP(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Fs.exists(!1))]).then(()=>r)}function WF(t,e){return function(r,i){const s=new bs;return r.asyncQueue.enqueueAndForget(async()=>cF(await wF(r),i,s)),s.promise}(Vw(t),e)}function HF(t,e,n){const r=n.docs.get(e._key),i=new t8(t);return new e8(t,i,e._key,r,new Th(n.hasPendingWrites,n.fromCache),e.converter)}function qC(){return new Ww("serverTimestamp")}(function(e,n=!0){(function(i){ic=i})(ul),Xa(new Qo("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),u=new e0(new jM(r.getProvider("auth-internal")),new $M(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ge(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gd(h.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Xi(oC,"4.7.3",e),Xi(oC,"4.7.3","esm2017")})();var KC={};const QC="@firebase/database",YC="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n8="";function $F(t){n8=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Cn(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:cd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return rs(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r8=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new qF(e)}}catch{}return new KF},Ba=r8("localStorage"),QF=r8("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=new Vm("@firebase/database"),YF=function(){let t=1;return function(){return t++}}(),i8=function(t){const e=xN(t),n=new PN;n.update(e);const r=n.digest();return ew.encodeByteArray(r)},Kd=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Kd.apply(null,r):typeof r=="object"?e+=Cn(r):e+=r,e+=" "}return e};let zh=null,XC=!0;const XF=function(t,e){ae(!0,"Can't turn on custom loggers persistently."),Su.logLevel=Ke.VERBOSE,zh=Su.log.bind(Su)},bn=function(...t){if(XC===!0&&(XC=!1,zh===null&&QF.get("logging_enabled")===!0&&XF()),zh){const e=Kd.apply(null,t);zh(e)}},Qd=function(t){return function(...e){bn(t,...e)}},N1=function(...t){const e="FIREBASE INTERNAL ERROR: "+Kd(...t);Su.error(e)},Ks=function(...t){const e=`FIREBASE FATAL ERROR: ${Kd(...t)}`;throw Su.error(e),new Error(e)},fr=function(...t){const e="FIREBASE WARNING: "+Kd(...t);Su.warn(e)},JF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&fr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Qw=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},ZF=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ju="[MIN_NAME]",nl="[MAX_NAME]",dl=function(t,e){if(t===e)return 0;if(t===ju||e===nl)return-1;if(e===ju||t===nl)return 1;{const n=JC(t),r=JC(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},eV=function(t,e){return t===e?0:t<e?-1:1},lh=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Cn(e))},Yw=function(t){if(typeof t!="object"||t===null)return Cn(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Cn(e[r]),n+=":",n+=Yw(t[e[r]]);return n+="}",n},s8=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function jn(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const o8=function(t){ae(!Qw(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,u,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(u=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=u+r,o=Math.round(t*Math.pow(2,n-u)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const h=[];for(c=n;c;c-=1)h.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)h.push(s%2?1:0),s=Math.floor(s/2);h.push(i?1:0),h.reverse();const p=h.join("");let m="";for(c=0;c<64;c+=8){let _=parseInt(p.substr(c,8),2).toString(16);_.length===1&&(_="0"+_),m=m+_}return m.toLowerCase()},tV=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},nV=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function rV(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const iV=new RegExp("^-?(0*)\\d{1,10}$"),sV=-2147483648,oV=2147483647,JC=function(t){if(iV.test(t)){const e=Number(t);if(e>=sV&&e<=oV)return e}return null},uc=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw fr("Exception was thrown by user callback.",n),e},Math.floor(0))}},aV=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Bh=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){fr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(bn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',fr(e)}}class sg{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}sg.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw="5",a8="v",l8="s",u8="r",c8="f",h8=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,d8="ls",f8="p",D1="ac",p8="websocket",g8="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e,n,r,i,s=!1,o="",u=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ba.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ba.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function cV(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function _8(t,e,n){ae(typeof e=="string","typeof type must == string"),ae(typeof n=="object","typeof params must == object");let r;if(e===p8)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===g8)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);cV(t)&&(n.ns=t.namespace);const i=[];return jn(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(){this.counters_={}}incrementCounter(e,n=1){rs(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return aN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v={},qv={};function Jw(t){const e=t.toString();return $v[e]||($v[e]=new hV),$v[e]}function dV(t,e){const n=t.toString();return qv[n]||(qv[n]=e()),qv[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&uc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="start",pV="close",gV="pLPCommand",mV="pRTLPCB",v8="id",y8="pw",w8="ser",_V="cb",vV="seg",yV="ts",wV="d",EV="dframe",E8=1870,S8=30,SV=E8-S8,TV=25e3,CV=3e4;class hu{constructor(e,n,r,i,s,o,u){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qd(e),this.stats_=Jw(n),this.urlFn=c=>(this.appCheckToken&&(c[D1]=this.appCheckToken),_8(n,g8,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new fV(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(CV)),ZF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Zw((...s)=>{const[o,u,c,h,p]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===ZC)this.id=u,this.password=c;else if(o===pV)u?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(u,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,u]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,u)},()=>{this.onClosed_()},this.urlFn);const r={};r[ZC]="t",r[w8]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[_V]=this.scriptTagHolder.uniqueCallbackIdentifier),r[a8]=Xw,this.transportSessionId&&(r[l8]=this.transportSessionId),this.lastSessionId&&(r[d8]=this.lastSessionId),this.applicationId&&(r[f8]=this.applicationId),this.appCheckToken&&(r[D1]=this.appCheckToken),typeof location<"u"&&location.hostname&&h8.test(location.hostname)&&(r[u8]=c8);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){hu.forceAllow_=!0}static forceDisallow(){hu.forceDisallow_=!0}static isAvailable(){return hu.forceAllow_?!0:!hu.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!tV()&&!nV()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Cn(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=B6(n),i=s8(r,SV);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[EV]="t",r[v8]=e,r[y8]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Cn(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Zw{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=YF(),window[gV+this.uniqueCallbackIdentifier]=e,window[mV+this.uniqueCallbackIdentifier]=n,this.myIFrame=Zw.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){bn("frame writing exception"),u.stack&&bn(u.stack),bn(u)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||bn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[v8]=this.myID,e[y8]=this.myPW,e[w8]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+S8+r.length<=E8;){const o=this.pendingSegs.shift();r=r+"&"+vV+i+"="+o.seg+"&"+yV+i+"="+o.ts+"&"+wV+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(TV)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{bn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=16384,PV=45e3;let Xg=null;typeof MozWebSocket<"u"?Xg=MozWebSocket:typeof WebSocket<"u"&&(Xg=WebSocket);class yi{constructor(e,n,r,i,s,o,u){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qd(this.connId),this.stats_=Jw(n),this.connURL=yi.connectionURL_(n,o,u,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[a8]=Xw,typeof location<"u"&&location.hostname&&h8.test(location.hostname)&&(o[u8]=c8),n&&(o[l8]=n),r&&(o[d8]=r),i&&(o[D1]=i),s&&(o[f8]=s),_8(e,p8,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ba.set("previous_websocket_failure",!0);try{let r;_N(),this.mySock=new Xg(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){yi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Xg!==null&&!yi.forceDisallow_}static previouslyFailed(){return Ba.isInMemoryStorage||Ba.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ba.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=cd(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ae(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Cn(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=s8(n,IV);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(PV))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}yi.responsesRequiredToBeHealthy=2;yi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[hu,yi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=yi&&yi.isAvailable();let r=n&&!yi.previouslyFailed();if(e.webSocketOnly&&(n||fr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[yi];else{const i=this.transports_=[];for(const s of wd.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);wd.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}wd.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV=6e4,kV=5e3,AV=10*1024,xV=100*1024,Kv="t",e3="d",NV="s",t3="r",DV="e",n3="o",r3="a",i3="n",s3="p",OV="h";class MV{constructor(e,n,r,i,s,o,u,c,h,p){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=c,this.onKill_=h,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qd("c:"+this.id+":"),this.transportManager_=new wd(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Bh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>xV?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>AV?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Kv in e){const n=e[Kv];n===r3?this.upgradeIfSecondaryHealthy_():n===t3?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===n3&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=lh("t",e),r=lh("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:s3,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:r3,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:i3,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=lh("t",e),r=lh("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=lh(Kv,e);if(e3 in e){const r=e[e3];if(n===OV){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===i3){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===NV?this.onConnectionShutdown_(r):n===t3?this.onReset_(r):n===DV?N1("Server Error: "+r):n===n3?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):N1("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Xw!==r&&fr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Bh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(RV))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(kV))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:s3,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ba.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C8{constructor(e){this.allowedEvents_=e,this.listeners_={},ae(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){ae(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg extends C8{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!tw()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Jg}getInitialEvent(e){return ae(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3=32,a3=768;let gt=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ot(){return new gt("")}function Be(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Zo(t){return t.pieces_.length-t.pieceNum_}function Et(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new gt(t.pieces_,e)}function eE(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function LV(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ed(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function I8(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new gt(e,0)}function Ft(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof gt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new gt(n,0)}function Ge(t){return t.pieceNum_>=t.pieces_.length}function Rr(t,e){const n=Be(t),r=Be(e);if(n===null)return e;if(n===r)return Rr(Et(t),Et(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function bV(t,e){const n=Ed(t,0),r=Ed(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=dl(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function tE(t,e){if(Zo(t)!==Zo(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function ti(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Zo(t)>Zo(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class FV{constructor(e,n){this.errorPrefix_=n,this.parts_=Ed(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Fm(this.parts_[r]);P8(this)}}function VV(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Fm(e),P8(t)}function UV(t){const e=t.parts_.pop();t.byteLength_-=Fm(e),t.parts_.length>0&&(t.byteLength_-=1)}function P8(t){if(t.byteLength_>a3)throw new Error(t.errorPrefix_+"has a key path longer than "+a3+" bytes ("+t.byteLength_+").");if(t.parts_.length>o3)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+o3+") or object contains a cycle "+La(t))}function La(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE extends C8{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new nE}getInitialEvent(e){return ae(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=1e3,zV=60*5*1e3,l3=30*1e3,BV=1.3,jV=3e4,GV="server_kill",u3=3;class Vs extends T8{constructor(e,n,r,i,s,o,u,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=Vs.nextPersistentConnectionId_++,this.log_=Qd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=uh,this.maxReconnectDelay_=zV,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");nE.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Jg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(Cn(s)),ae(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new bd,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const u=o.d;o.s==="ok"?n.resolve(u):n.reject(u)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ae(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const u={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,u),this.connected_&&this.sendListen_(u)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,u=>{const c=u.d,h=u.s;Vs.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",u),h!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(h,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&rs(e,"w")){const r=Du(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();fr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||IN(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=l3)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=CN(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),ae(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Cn(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):N1("Unrecognized action received from server: "+Cn(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ae(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=uh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=uh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>jV&&(this.reconnectDelay_=uh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*BV)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Vs.nextConnectionId_++,s=this.lastSessionId;let o=!1,u=null;const c=function(){u?u.close():(o=!0,r())},h=function(m){ae(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(m)};this.realtime_={close:c,sendRequest:h};const p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[m,_]=await Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);o?bn("getToken() completed but was canceled"):(bn("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=_&&_.token,u=new MV(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,E=>{fr(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(GV)},s))}catch(m){this.log_("Failed to get token: "+m),o||(this.repoInfo_.nodeAdmin&&fr(m),c())}}}interrupt(e){bn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){bn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],s1(this.interruptReasons_)&&(this.reconnectDelay_=uh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>Yw(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new gt(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){bn("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=u3&&(this.reconnectDelay_=l3,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){bn("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=u3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+n8.replace(/\./g,"-")]=1,tw()?e["framework.cordova"]=1:K6()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Jg.getInstance().currentlyOnline();return s1(this.interruptReasons_)&&e}}Vs.nextPersistentConnectionId_=0;Vs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new je(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new je(ju,e),i=new je(ju,n);return this.compare(r,i)!==0}minPost(){return je.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ap;class R8 extends n0{static get __EMPTY_NODE(){return Ap}static set __EMPTY_NODE(e){Ap=e}compare(e,n){return dl(e.name,n.name)}isDefinedOn(e){throw tc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return je.MIN}maxPost(){return new je(nl,Ap)}makePost(e,n){return ae(typeof e=="string","KeyIndex indexValue must always be a string."),new je(e,Ap)}toString(){return".key"}}const Tu=new R8;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Sn{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Sn.RED,this.left=i??kr.EMPTY_NODE,this.right=s??kr.EMPTY_NODE}copy(e,n,r,i,s){return new Sn(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return kr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return kr.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Sn.RED=!0;Sn.BLACK=!1;class WV{copy(e,n,r,i,s){return this}insert(e,n,r){return new Sn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kr{constructor(e,n=kr.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new kr(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Sn.BLACK,null,null))}remove(e){return new kr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Sn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new xp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new xp(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new xp(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new xp(this.root_,null,this.comparator_,!0,e)}}kr.EMPTY_NODE=new WV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(t,e){return dl(t.name,e.name)}function rE(t,e){return dl(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O1;function $V(t){O1=t}const k8=function(t){return typeof t=="number"?"number:"+o8(t):"string:"+t},A8=function(t){if(t.isLeafNode()){const e=t.val();ae(typeof e=="string"||typeof e=="number"||typeof e=="object"&&rs(e,".sv"),"Priority must be a string or number.")}else ae(t===O1||t.isEmpty(),"priority of unexpected type.");ae(t===O1||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c3;class yn{constructor(e,n=yn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,ae(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),A8(this.priorityNode_)}static set __childrenNodeConstructor(e){c3=e}static get __childrenNodeConstructor(){return c3}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new yn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ge(e)?this:Be(e)===".priority"?this.priorityNode_:yn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:yn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=Be(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(ae(r!==".priority"||Zo(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,yn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Et(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+k8(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=o8(this.value_):e+=this.value_,this.lazyHash_=i8(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===yn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof yn.__childrenNodeConstructor?-1:(ae(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=yn.VALUE_TYPE_ORDER.indexOf(n),s=yn.VALUE_TYPE_ORDER.indexOf(r);return ae(i>=0,"Unknown leaf type: "+n),ae(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}yn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x8,N8;function qV(t){x8=t}function KV(t){N8=t}class QV extends n0{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?dl(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return je.MIN}maxPost(){return new je(nl,new yn("[PRIORITY-POST]",N8))}makePost(e,n){const r=x8(e);return new je(n,new yn("[PRIORITY-POST]",r))}toString(){return".priority"}}const Vt=new QV;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=Math.log(2);class XV{constructor(e){const n=s=>parseInt(Math.log(s)/YV,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Zg=function(t,e,n,r){t.sort(e);const i=function(c,h){const p=h-c;let m,_;if(p===0)return null;if(p===1)return m=t[c],_=n?n(m):m,new Sn(_,m.node,Sn.BLACK,null,null);{const E=parseInt(p/2,10)+c,S=i(c,E),P=i(E+1,h);return m=t[E],_=n?n(m):m,new Sn(_,m.node,Sn.BLACK,S,P)}},s=function(c){let h=null,p=null,m=t.length;const _=function(S,P){const N=m-S,R=m;m-=S;const k=i(N+1,R),w=t[N],A=n?n(w):w;E(new Sn(A,w.node,P,null,k))},E=function(S){h?(h.left=S,h=S):(p=S,h=S)};for(let S=0;S<c.count;++S){const P=c.nextBitIsOne(),N=Math.pow(2,c.count-(S+1));P?_(N,Sn.BLACK):(_(N,Sn.BLACK),_(N,Sn.RED))}return p},o=new XV(t.length),u=s(o);return new kr(r||e,u)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qv;const $l={};class Ms{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return ae($l&&Vt,"ChildrenNode.ts has not been loaded"),Qv=Qv||new Ms({".priority":$l},{".priority":Vt}),Qv}get(e){const n=Du(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof kr?n:null}hasIndex(e){return rs(this.indexSet_,e.toString())}addIndex(e,n){ae(e!==Tu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(je.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let u;i?u=Zg(r,e.getCompare()):u=$l;const c=e.toString(),h=Object.assign({},this.indexSet_);h[c]=e;const p=Object.assign({},this.indexes_);return p[c]=u,new Ms(p,h)}addToIndexes(e,n){const r=Lg(this.indexes_,(i,s)=>{const o=Du(this.indexSet_,s);if(ae(o,"Missing index implementation for "+s),i===$l)if(o.isDefinedOn(e.node)){const u=[],c=n.getIterator(je.Wrap);let h=c.getNext();for(;h;)h.name!==e.name&&u.push(h),h=c.getNext();return u.push(e),Zg(u,o.getCompare())}else return $l;else{const u=n.get(e.name);let c=i;return u&&(c=c.remove(new je(e.name,u))),c.insert(e,e.node)}});return new Ms(r,this.indexSet_)}removeFromIndexes(e,n){const r=Lg(this.indexes_,i=>{if(i===$l)return i;{const s=n.get(e.name);return s?i.remove(new je(e.name,s)):i}});return new Ms(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ch;class Re{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&A8(this.priorityNode_),this.children_.isEmpty()&&ae(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ch||(ch=new Re(new kr(rE),null,Ms.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ch}updatePriority(e){return this.children_.isEmpty()?this:new Re(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?ch:n}}getChild(e){const n=Be(e);return n===null?this:this.getImmediateChild(n).getChild(Et(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(ae(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new je(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?ch:this.priorityNode_;return new Re(i,o,s)}}updateChild(e,n){const r=Be(e);if(r===null)return n;{ae(Be(e)!==".priority"||Zo(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Et(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(Vt,(o,u)=>{n[o]=u.val(e),r++,s&&Re.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const u in n)o[u]=n[u];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+k8(this.getPriority().val())+":"),this.forEachChild(Vt,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":i8(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new je(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new je(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new je(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,je.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,je.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Yd?-1:0}withIndex(e){if(e===Tu||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Re(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Tu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Vt),i=n.getIterator(Vt);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Tu?null:this.indexMap_.get(e.toString())}}Re.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class JV extends Re{constructor(){super(new kr(rE),Re.EMPTY_NODE,Ms.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Re.EMPTY_NODE}isEmpty(){return!1}}const Yd=new JV;Object.defineProperties(je,{MIN:{value:new je(ju,Re.EMPTY_NODE)},MAX:{value:new je(nl,Yd)}});R8.__EMPTY_NODE=Re.EMPTY_NODE;yn.__childrenNodeConstructor=Re;$V(Yd);KV(Yd);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZV=!0;function Tn(t,e=null){if(t===null)return Re.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),ae(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new yn(n,Tn(e))}if(!(t instanceof Array)&&ZV){const n=[];let r=!1;if(jn(t,(o,u)=>{if(o.substring(0,1)!=="."){const c=Tn(u);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new je(o,c)))}}),n.length===0)return Re.EMPTY_NODE;const s=Zg(n,HV,o=>o.name,rE);if(r){const o=Zg(n,Vt.getCompare());return new Re(s,Tn(e),new Ms({".priority":o},{".priority":Vt}))}else return new Re(s,Tn(e),Ms.Default)}else{let n=Re.EMPTY_NODE;return jn(t,(r,i)=>{if(rs(t,r)&&r.substring(0,1)!=="."){const s=Tn(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Tn(e))}}qV(Tn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU extends n0{constructor(e){super(),this.indexPath_=e,ae(!Ge(e)&&Be(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?dl(e.name,n.name):s}makePost(e,n){const r=Tn(e),i=Re.EMPTY_NODE.updateChild(this.indexPath_,r);return new je(n,i)}maxPost(){const e=Re.EMPTY_NODE.updateChild(this.indexPath_,Yd);return new je(nl,e)}toString(){return Ed(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU extends n0{compare(e,n){const r=e.node.compareTo(n.node);return r===0?dl(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return je.MIN}maxPost(){return je.MAX}makePost(e,n){const r=Tn(e);return new je(n,r)}toString(){return".value"}}const nU=new tU;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D8(t){return{type:"value",snapshotNode:t}}function Gu(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Sd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Td(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function rU(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){ae(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const u=e.getImmediateChild(n);return u.getChild(i).equals(r.getChild(i))&&u.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Sd(n,u)):ae(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):u.isEmpty()?o.trackChildChange(Gu(n,r)):o.trackChildChange(Td(n,r,u))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Vt,(i,s)=>{n.hasChild(i)||r.trackChildChange(Sd(i,s))}),n.isLeafNode()||n.forEachChild(Vt,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Td(i,s,o))}else r.trackChildChange(Gu(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Re.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e){this.indexedFilter_=new iE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Cd.getStartPost_(e),this.endPost_=Cd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new je(n,r))||(r=Re.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Re.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Re.EMPTY_NODE);const s=this;return n.forEachChild(Vt,(o,u)=>{s.matches(new je(o,u))||(i=i.updateImmediateChild(o,Re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Cd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new je(n,r))||(r=Re.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Re.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=Re.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const u=s.getNext();if(this.withinDirectionalStart(u))if(this.withinDirectionalEnd(u))i=i.updateImmediateChild(u.name,u.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(Re.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const u=s.getNext();o<this.limit_&&this.withinDirectionalStart(u)&&this.withinDirectionalEnd(u)?o++:i=i.updateImmediateChild(u.name,Re.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const m=this.index_.getCompare();o=(_,E)=>m(E,_)}else o=this.index_.getCompare();const u=e;ae(u.numChildren()===this.limit_,"");const c=new je(n,r),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),p=this.rangedFilter_.matches(c);if(u.hasChild(n)){const m=u.getImmediateChild(n);let _=i.getChildAfterChild(this.index_,h,this.reverse_);for(;_!=null&&(_.name===n||u.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const E=_==null?1:o(_,c);if(p&&!r.isEmpty()&&E>=0)return s!=null&&s.trackChildChange(Td(n,r,m)),u.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(Sd(n,m));const P=u.updateImmediateChild(n,Re.EMPTY_NODE);return _!=null&&this.rangedFilter_.matches(_)?(s!=null&&s.trackChildChange(Gu(_.name,_.node)),P.updateImmediateChild(_.name,_.node)):P}}else return r.isEmpty()?e:p&&o(h,c)>=0?(s!=null&&(s.trackChildChange(Sd(h.name,h.node)),s.trackChildChange(Gu(n,r))),u.updateImmediateChild(n,r).updateImmediateChild(h.name,Re.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Vt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ae(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ae(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ju}hasEnd(){return this.endSet_}getIndexEndValue(){return ae(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ae(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:nl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ae(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Vt}copy(){const e=new sE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function sU(t){return t.loadsAllData()?new iE(t.getIndex()):t.hasLimit()?new iU(t):new Cd(t)}function h3(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Vt?n="$priority":t.index_===nU?n="$value":t.index_===Tu?n="$key":(ae(t.index_ instanceof eU,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Cn(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=Cn(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Cn(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Cn(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Cn(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function d3(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Vt&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em extends T8{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Qd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(ae(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=em.getListenId_(e,r),u={};this.listens_[o]=u;const c=h3(e._queryParams);this.restRequest_(s+".json",c,(h,p)=>{let m=p;if(h===404&&(m=null,h=null),h===null&&this.onDataUpdate_(s,m,!1,r),Du(this.listens_,o)===u){let _;h?h===401?_="permission_denied":_="rest_error:"+h:_="ok",i(_,null)}})}unlisten(e,n){const r=em.getListenId_(e,n);delete this.listens_[r]}get(e){const n=h3(e._queryParams),r=e._path.toString(),i=new bd;return this.restRequest_(r+".json",n,(s,o)=>{let u=o;s===404&&(u=null,s=null),s===null?(this.onDataUpdate_(r,u,!1,null),i.resolve(u)):i.reject(new Error(u))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+nc(n);this.log_("Sending REST request for "+o);const u=new XMLHttpRequest;u.onreadystatechange=()=>{if(r&&u.readyState===4){this.log_("REST Response for "+o+" received. status:",u.status,"response:",u.responseText);let c=null;if(u.status>=200&&u.status<300){try{c=cd(u.responseText)}catch{fr("Failed to parse JSON response for "+o+": "+u.responseText)}r(null,c)}else u.status!==401&&u.status!==404&&fr("Got unsuccessful REST response for "+o+" Status: "+u.status),r(u.status);r=null}},u.open("GET",o,!0),u.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(){this.rootNode_=Re.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(){return{value:null,children:new Map}}function O8(t,e,n){if(Ge(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=Be(e);t.children.has(r)||t.children.set(r,tm());const i=t.children.get(r);e=Et(e),O8(i,e,n)}}function M1(t,e,n){t.value!==null?n(e,t.value):aU(t,(r,i)=>{const s=new gt(e.toString()+"/"+r);M1(i,s,n)})}function aU(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&jn(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=10*1e3,uU=30*1e3,cU=5*60*1e3;class hU{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new lU(e);const r=f3+(uU-f3)*Math.random();Bh(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;jn(e,(i,s)=>{s>0&&rs(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Bh(this.reportStats_.bind(this),Math.floor(Math.random()*2*cU))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ei;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ei||(Ei={}));function oE(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function aE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function lE(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Ei.ACK_USER_WRITE,this.source=oE()}operationForChild(e){if(Ge(this.path)){if(this.affectedTree.value!=null)return ae(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new gt(e));return new nm(ot(),n,this.revert)}}else return ae(Be(this.path)===e,"operationForChild called for unrelated child."),new nm(Et(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,n){this.source=e,this.path=n,this.type=Ei.LISTEN_COMPLETE}operationForChild(e){return Ge(this.path)?new Id(this.source,ot()):new Id(this.source,Et(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Ei.OVERWRITE}operationForChild(e){return Ge(this.path)?new rl(this.source,ot(),this.snap.getImmediateChild(e)):new rl(this.source,Et(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Ei.MERGE}operationForChild(e){if(Ge(this.path)){const n=this.children.subtree(new gt(e));return n.isEmpty()?null:n.value?new rl(this.source,ot(),n.value):new Wu(this.source,ot(),n)}else return ae(Be(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Wu(this.source,Et(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ge(e))return this.isFullyInitialized()&&!this.filtered_;const n=Be(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function fU(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(rU(o.childName,o.snapshotNode))}),hh(t,i,"child_removed",e,r,n),hh(t,i,"child_added",e,r,n),hh(t,i,"child_moved",s,r,n),hh(t,i,"child_changed",e,r,n),hh(t,i,"value",e,r,n),i}function hh(t,e,n,r,i,s){const o=r.filter(u=>u.type===n);o.sort((u,c)=>gU(t,u,c)),o.forEach(u=>{const c=pU(t,u,s);i.forEach(h=>{h.respondsTo(u.type)&&e.push(h.createEvent(c,t.query_))})})}function pU(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function gU(t,e,n){if(e.childName==null||n.childName==null)throw tc("Should only compare child_ events.");const r=new je(e.childName,e.snapshotNode),i=new je(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(t,e){return{eventCache:t,serverCache:e}}function jh(t,e,n,r){return r0(new il(e,n,r),t.serverCache)}function M8(t,e,n,r){return r0(t.eventCache,new il(e,n,r))}function L1(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function sl(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yv;const mU=()=>(Yv||(Yv=new kr(eV)),Yv);class wt{constructor(e,n=mU()){this.value=e,this.children=n}static fromObject(e){let n=new wt(null);return jn(e,(r,i)=>{n=n.set(new gt(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ot(),value:this.value};if(Ge(e))return null;{const r=Be(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Et(e),n);return s!=null?{path:Ft(new gt(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ge(e))return this;{const n=Be(e),r=this.children.get(n);return r!==null?r.subtree(Et(e)):new wt(null)}}set(e,n){if(Ge(e))return new wt(n,this.children);{const r=Be(e),s=(this.children.get(r)||new wt(null)).set(Et(e),n),o=this.children.insert(r,s);return new wt(this.value,o)}}remove(e){if(Ge(e))return this.children.isEmpty()?new wt(null):new wt(null,this.children);{const n=Be(e),r=this.children.get(n);if(r){const i=r.remove(Et(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new wt(null):new wt(this.value,s)}else return this}}get(e){if(Ge(e))return this.value;{const n=Be(e),r=this.children.get(n);return r?r.get(Et(e)):null}}setTree(e,n){if(Ge(e))return n;{const r=Be(e),s=(this.children.get(r)||new wt(null)).setTree(Et(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new wt(this.value,o)}}fold(e){return this.fold_(ot(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ft(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ot(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(Ge(e))return null;{const s=Be(e),o=this.children.get(s);return o?o.findOnPath_(Et(e),Ft(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ot(),n)}foreachOnPath_(e,n,r){if(Ge(e))return this;{this.value&&r(n,this.value);const i=Be(e),s=this.children.get(i);return s?s.foreachOnPath_(Et(e),Ft(n,i),r):new wt(null)}}foreach(e){this.foreach_(ot(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ft(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this.writeTree_=e}static empty(){return new Ii(new wt(null))}}function Gh(t,e,n){if(Ge(e))return new Ii(new wt(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Rr(i,e);return s=s.updateChild(o,n),new Ii(t.writeTree_.set(i,s))}else{const i=new wt(n),s=t.writeTree_.setTree(e,i);return new Ii(s)}}}function b1(t,e,n){let r=t;return jn(n,(i,s)=>{r=Gh(r,Ft(e,i),s)}),r}function p3(t,e){if(Ge(e))return Ii.empty();{const n=t.writeTree_.setTree(e,new wt(null));return new Ii(n)}}function F1(t,e){return fl(t,e)!=null}function fl(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Rr(n.path,e)):null}function g3(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Vt,(r,i)=>{e.push(new je(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new je(r,i.value))}),e}function $o(t,e){if(Ge(e))return t;{const n=fl(t,e);return n!=null?new Ii(new wt(n)):new Ii(t.writeTree_.subtree(e))}}function V1(t){return t.writeTree_.isEmpty()}function Hu(t,e){return L8(ot(),t.writeTree_,e)}function L8(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(ae(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=L8(Ft(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ft(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(t,e){return U8(e,t)}function _U(t,e,n,r,i){ae(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Gh(t.visibleWrites,e,n)),t.lastWriteId=r}function vU(t,e,n,r){ae(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=b1(t.visibleWrites,e,n),t.lastWriteId=r}function yU(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function wU(t,e){const n=t.allWrites.findIndex(u=>u.writeId===e);ae(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const u=t.allWrites[o];u.visible&&(o>=n&&EU(u,r.path)?i=!1:ti(r.path,u.path)&&(s=!0)),o--}if(i){if(s)return SU(t),!0;if(r.snap)t.visibleWrites=p3(t.visibleWrites,r.path);else{const u=r.children;jn(u,c=>{t.visibleWrites=p3(t.visibleWrites,Ft(r.path,c))})}return!0}else return!1}function EU(t,e){if(t.snap)return ti(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ti(Ft(t.path,n),e))return!0;return!1}function SU(t){t.visibleWrites=b8(t.allWrites,TU,ot()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function TU(t){return t.visible}function b8(t,e,n){let r=Ii.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let u;if(s.snap)ti(n,o)?(u=Rr(n,o),r=Gh(r,u,s.snap)):ti(o,n)&&(u=Rr(o,n),r=Gh(r,ot(),s.snap.getChild(u)));else if(s.children){if(ti(n,o))u=Rr(n,o),r=b1(r,u,s.children);else if(ti(o,n))if(u=Rr(o,n),Ge(u))r=b1(r,ot(),s.children);else{const c=Du(s.children,Be(u));if(c){const h=c.getChild(Et(u));r=Gh(r,ot(),h)}}}else throw tc("WriteRecord should have .snap or .children")}}return r}function F8(t,e,n,r,i){if(!r&&!i){const s=fl(t.visibleWrites,e);if(s!=null)return s;{const o=$o(t.visibleWrites,e);if(V1(o))return n;if(n==null&&!F1(o,ot()))return null;{const u=n||Re.EMPTY_NODE;return Hu(o,u)}}}else{const s=$o(t.visibleWrites,e);if(!i&&V1(s))return n;if(!i&&n==null&&!F1(s,ot()))return null;{const o=function(h){return(h.visible||i)&&(!r||!~r.indexOf(h.writeId))&&(ti(h.path,e)||ti(e,h.path))},u=b8(t.allWrites,o,e),c=n||Re.EMPTY_NODE;return Hu(u,c)}}}function CU(t,e,n){let r=Re.EMPTY_NODE;const i=fl(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Vt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=$o(t.visibleWrites,e);return n.forEachChild(Vt,(o,u)=>{const c=Hu($o(s,new gt(o)),u);r=r.updateImmediateChild(o,c)}),g3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=$o(t.visibleWrites,e);return g3(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function IU(t,e,n,r,i){ae(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ft(e,n);if(F1(t.visibleWrites,s))return null;{const o=$o(t.visibleWrites,s);return V1(o)?i.getChild(n):Hu(o,i.getChild(n))}}function PU(t,e,n,r){const i=Ft(e,n),s=fl(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=$o(t.visibleWrites,i);return Hu(o,r.getNode().getImmediateChild(n))}else return null}function RU(t,e){return fl(t.visibleWrites,e)}function kU(t,e,n,r,i,s,o){let u;const c=$o(t.visibleWrites,e),h=fl(c,ot());if(h!=null)u=h;else if(n!=null)u=Hu(c,n);else return[];if(u=u.withIndex(o),!u.isEmpty()&&!u.isLeafNode()){const p=[],m=o.getCompare(),_=s?u.getReverseIteratorFrom(r,o):u.getIteratorFrom(r,o);let E=_.getNext();for(;E&&p.length<i;)m(E,r)!==0&&p.push(E),E=_.getNext();return p}else return[]}function AU(){return{visibleWrites:Ii.empty(),allWrites:[],lastWriteId:-1}}function rm(t,e,n,r){return F8(t.writeTree,t.treePath,e,n,r)}function cE(t,e){return CU(t.writeTree,t.treePath,e)}function m3(t,e,n,r){return IU(t.writeTree,t.treePath,e,n,r)}function im(t,e){return RU(t.writeTree,Ft(t.treePath,e))}function xU(t,e,n,r,i,s){return kU(t.writeTree,t.treePath,e,n,r,i,s)}function hE(t,e,n){return PU(t.writeTree,t.treePath,e,n)}function V8(t,e){return U8(Ft(t.treePath,e),t.writeTree)}function U8(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;ae(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),ae(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Td(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Sd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Gu(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Td(r,e.snapshotNode,i.oldSnap));else throw tc("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const z8=new DU;class dE{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new il(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return hE(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:sl(this.viewCache_),s=xU(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OU(t){return{filter:t}}function MU(t,e){ae(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),ae(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function LU(t,e,n,r,i){const s=new NU;let o,u;if(n.type===Ei.OVERWRITE){const h=n;h.source.fromUser?o=U1(t,e,h.path,h.snap,r,i,s):(ae(h.source.fromServer,"Unknown source."),u=h.source.tagged||e.serverCache.isFiltered()&&!Ge(h.path),o=sm(t,e,h.path,h.snap,r,i,u,s))}else if(n.type===Ei.MERGE){const h=n;h.source.fromUser?o=FU(t,e,h.path,h.children,r,i,s):(ae(h.source.fromServer,"Unknown source."),u=h.source.tagged||e.serverCache.isFiltered(),o=z1(t,e,h.path,h.children,r,i,u,s))}else if(n.type===Ei.ACK_USER_WRITE){const h=n;h.revert?o=zU(t,e,h.path,r,i,s):o=VU(t,e,h.path,h.affectedTree,r,i,s)}else if(n.type===Ei.LISTEN_COMPLETE)o=UU(t,e,n.path,r,s);else throw tc("Unknown operation type: "+n.type);const c=s.getChanges();return bU(e,o,c),{viewCache:o,changes:c}}function bU(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=L1(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(D8(L1(e)))}}function B8(t,e,n,r,i,s){const o=e.eventCache;if(im(r,n)!=null)return e;{let u,c;if(Ge(n))if(ae(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const h=sl(e),p=h instanceof Re?h:Re.EMPTY_NODE,m=cE(r,p);u=t.filter.updateFullNode(e.eventCache.getNode(),m,s)}else{const h=rm(r,sl(e));u=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const h=Be(n);if(h===".priority"){ae(Zo(n)===1,"Can't have a priority with additional path components");const p=o.getNode();c=e.serverCache.getNode();const m=m3(r,n,p,c);m!=null?u=t.filter.updatePriority(p,m):u=o.getNode()}else{const p=Et(n);let m;if(o.isCompleteForChild(h)){c=e.serverCache.getNode();const _=m3(r,n,o.getNode(),c);_!=null?m=o.getNode().getImmediateChild(h).updateChild(p,_):m=o.getNode().getImmediateChild(h)}else m=hE(r,h,e.serverCache);m!=null?u=t.filter.updateChild(o.getNode(),h,m,p,i,s):u=o.getNode()}}return jh(e,u,o.isFullyInitialized()||Ge(n),t.filter.filtersNodes())}}function sm(t,e,n,r,i,s,o,u){const c=e.serverCache;let h;const p=o?t.filter:t.filter.getIndexedFilter();if(Ge(n))h=p.updateFullNode(c.getNode(),r,null);else if(p.filtersNodes()&&!c.isFiltered()){const E=c.getNode().updateChild(n,r);h=p.updateFullNode(c.getNode(),E,null)}else{const E=Be(n);if(!c.isCompleteForPath(n)&&Zo(n)>1)return e;const S=Et(n),N=c.getNode().getImmediateChild(E).updateChild(S,r);E===".priority"?h=p.updatePriority(c.getNode(),N):h=p.updateChild(c.getNode(),E,N,S,z8,null)}const m=M8(e,h,c.isFullyInitialized()||Ge(n),p.filtersNodes()),_=new dE(i,m,s);return B8(t,m,n,i,_,u)}function U1(t,e,n,r,i,s,o){const u=e.eventCache;let c,h;const p=new dE(i,e,s);if(Ge(n))h=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=jh(e,h,!0,t.filter.filtersNodes());else{const m=Be(n);if(m===".priority")h=t.filter.updatePriority(e.eventCache.getNode(),r),c=jh(e,h,u.isFullyInitialized(),u.isFiltered());else{const _=Et(n),E=u.getNode().getImmediateChild(m);let S;if(Ge(_))S=r;else{const P=p.getCompleteChild(m);P!=null?eE(_)===".priority"&&P.getChild(I8(_)).isEmpty()?S=P:S=P.updateChild(_,r):S=Re.EMPTY_NODE}if(E.equals(S))c=e;else{const P=t.filter.updateChild(u.getNode(),m,S,_,p,o);c=jh(e,P,u.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function _3(t,e){return t.eventCache.isCompleteForChild(e)}function FU(t,e,n,r,i,s,o){let u=e;return r.foreach((c,h)=>{const p=Ft(n,c);_3(e,Be(p))&&(u=U1(t,u,p,h,i,s,o))}),r.foreach((c,h)=>{const p=Ft(n,c);_3(e,Be(p))||(u=U1(t,u,p,h,i,s,o))}),u}function v3(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function z1(t,e,n,r,i,s,o,u){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,h;Ge(n)?h=r:h=new wt(null).setTree(n,r);const p=e.serverCache.getNode();return h.children.inorderTraversal((m,_)=>{if(p.hasChild(m)){const E=e.serverCache.getNode().getImmediateChild(m),S=v3(t,E,_);c=sm(t,c,new gt(m),S,i,s,o,u)}}),h.children.inorderTraversal((m,_)=>{const E=!e.serverCache.isCompleteForChild(m)&&_.value===null;if(!p.hasChild(m)&&!E){const S=e.serverCache.getNode().getImmediateChild(m),P=v3(t,S,_);c=sm(t,c,new gt(m),P,i,s,o,u)}}),c}function VU(t,e,n,r,i,s,o){if(im(i,n)!=null)return e;const u=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Ge(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return sm(t,e,n,c.getNode().getChild(n),i,s,u,o);if(Ge(n)){let h=new wt(null);return c.getNode().forEachChild(Tu,(p,m)=>{h=h.set(new gt(p),m)}),z1(t,e,n,h,i,s,u,o)}else return e}else{let h=new wt(null);return r.foreach((p,m)=>{const _=Ft(n,p);c.isCompleteForPath(_)&&(h=h.set(p,c.getNode().getChild(_)))}),z1(t,e,n,h,i,s,u,o)}}function UU(t,e,n,r,i){const s=e.serverCache,o=M8(e,s.getNode(),s.isFullyInitialized()||Ge(n),s.isFiltered());return B8(t,o,n,r,z8,i)}function zU(t,e,n,r,i,s){let o;if(im(r,n)!=null)return e;{const u=new dE(r,e,i),c=e.eventCache.getNode();let h;if(Ge(n)||Be(n)===".priority"){let p;if(e.serverCache.isFullyInitialized())p=rm(r,sl(e));else{const m=e.serverCache.getNode();ae(m instanceof Re,"serverChildren would be complete if leaf node"),p=cE(r,m)}p=p,h=t.filter.updateFullNode(c,p,s)}else{const p=Be(n);let m=hE(r,p,e.serverCache);m==null&&e.serverCache.isCompleteForChild(p)&&(m=c.getImmediateChild(p)),m!=null?h=t.filter.updateChild(c,p,m,Et(n),u,s):e.eventCache.getNode().hasChild(p)?h=t.filter.updateChild(c,p,Re.EMPTY_NODE,Et(n),u,s):h=c,h.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=rm(r,sl(e)),o.isLeafNode()&&(h=t.filter.updateFullNode(h,o,s)))}return o=e.serverCache.isFullyInitialized()||im(r,ot())!=null,jh(e,h,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new iE(r.getIndex()),s=sU(r);this.processor_=OU(s);const o=n.serverCache,u=n.eventCache,c=i.updateFullNode(Re.EMPTY_NODE,o.getNode(),null),h=s.updateFullNode(Re.EMPTY_NODE,u.getNode(),null),p=new il(c,o.isFullyInitialized(),i.filtersNodes()),m=new il(h,u.isFullyInitialized(),s.filtersNodes());this.viewCache_=r0(m,p),this.eventGenerator_=new dU(this.query_)}get query(){return this.query_}}function jU(t){return t.viewCache_.serverCache.getNode()}function GU(t,e){const n=sl(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ge(e)&&!n.getImmediateChild(Be(e)).isEmpty())?n.getChild(e):null}function y3(t){return t.eventRegistrations_.length===0}function WU(t,e){t.eventRegistrations_.push(e)}function w3(t,e,n){const r=[];if(n){ae(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function E3(t,e,n,r){e.type===Ei.MERGE&&e.source.queryId!==null&&(ae(sl(t.viewCache_),"We should always have a full cache before handling merges"),ae(L1(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=LU(t.processor_,i,e,n,r);return MU(t.processor_,s.viewCache),ae(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,j8(t,s.changes,s.viewCache.eventCache.getNode(),null)}function HU(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Vt,(s,o)=>{r.push(Gu(s,o))}),n.isFullyInitialized()&&r.push(D8(n.getNode())),j8(t,r,n.getNode(),e)}function j8(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return fU(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let om;class $U{constructor(){this.views=new Map}}function qU(t){ae(!om,"__referenceConstructor has already been defined"),om=t}function KU(){return ae(om,"Reference.ts has not been loaded"),om}function QU(t){return t.views.size===0}function fE(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return ae(s!=null,"SyncTree gave us an op for an invalid query."),E3(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(E3(o,e,n,r));return s}}function YU(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let u=rm(n,i?r:null),c=!1;u?c=!0:r instanceof Re?(u=cE(n,r),c=!1):(u=Re.EMPTY_NODE,c=!1);const h=r0(new il(u,c,!1),new il(r,i,!1));return new BU(e,h)}return o}function XU(t,e,n,r,i,s){const o=YU(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),WU(o,n),HU(o,n)}function JU(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const u=ea(t);if(i==="default")for(const[c,h]of t.views.entries())o=o.concat(w3(h,n,r)),y3(h)&&(t.views.delete(c),h.query._queryParams.loadsAllData()||s.push(h.query));else{const c=t.views.get(i);c&&(o=o.concat(w3(c,n,r)),y3(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return u&&!ea(t)&&s.push(new(KU())(e._repo,e._path)),{removed:s,events:o}}function G8(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Cu(t,e){let n=null;for(const r of t.views.values())n=n||GU(r,e);return n}function W8(t,e){if(e._queryParams.loadsAllData())return i0(t);{const r=e._queryIdentifier;return t.views.get(r)}}function H8(t,e){return W8(t,e)!=null}function ea(t){return i0(t)!=null}function i0(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let am;function ZU(t){ae(!am,"__referenceConstructor has already been defined"),am=t}function ez(){return ae(am,"Reference.ts has not been loaded"),am}let tz=1;class S3{constructor(e){this.listenProvider_=e,this.syncPointTree_=new wt(null),this.pendingWriteTree_=AU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $8(t,e,n,r,i){return _U(t.pendingWriteTree_,e,n,r,i),i?cc(t,new rl(oE(),e,n)):[]}function nz(t,e,n,r){vU(t.pendingWriteTree_,e,n,r);const i=wt.fromObject(n);return cc(t,new Wu(oE(),e,i))}function Do(t,e,n=!1){const r=yU(t.pendingWriteTree_,e);if(wU(t.pendingWriteTree_,e)){let s=new wt(null);return r.snap!=null?s=s.set(ot(),!0):jn(r.children,o=>{s=s.set(new gt(o),!0)}),cc(t,new nm(r.path,s,n))}else return[]}function s0(t,e,n){return cc(t,new rl(aE(),e,n))}function rz(t,e,n){const r=wt.fromObject(n);return cc(t,new Wu(aE(),e,r))}function iz(t,e){return cc(t,new Id(aE(),e))}function sz(t,e,n){const r=gE(t,n);if(r){const i=mE(r),s=i.path,o=i.queryId,u=Rr(s,e),c=new Id(lE(o),u);return _E(t,s,c)}else return[]}function B1(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let u=[];if(o&&(e._queryIdentifier==="default"||H8(o,e))){const c=JU(o,e,n,r);QU(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const h=c.removed;if(u=c.events,!i){const p=h.findIndex(_=>_._queryParams.loadsAllData())!==-1,m=t.syncPointTree_.findOnPath(s,(_,E)=>ea(E));if(p&&!m){const _=t.syncPointTree_.subtree(s);if(!_.isEmpty()){const E=lz(_);for(let S=0;S<E.length;++S){const P=E[S],N=P.query,R=Q8(t,P);t.listenProvider_.startListening(Wh(N),lm(t,N),R.hashFn,R.onComplete)}}}!m&&h.length>0&&!r&&(p?t.listenProvider_.stopListening(Wh(e),null):h.forEach(_=>{const E=t.queryToTagMap.get(o0(_));t.listenProvider_.stopListening(Wh(_),E)}))}uz(t,h)}return u}function oz(t,e,n,r){const i=gE(t,r);if(i!=null){const s=mE(i),o=s.path,u=s.queryId,c=Rr(o,e),h=new rl(lE(u),c,n);return _E(t,o,h)}else return[]}function az(t,e,n,r){const i=gE(t,r);if(i){const s=mE(i),o=s.path,u=s.queryId,c=Rr(o,e),h=wt.fromObject(n),p=new Wu(lE(u),c,h);return _E(t,o,p)}else return[]}function T3(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(_,E)=>{const S=Rr(_,i);s=s||Cu(E,S),o=o||ea(E)});let u=t.syncPointTree_.get(i);u?(o=o||ea(u),s=s||Cu(u,ot())):(u=new $U,t.syncPointTree_=t.syncPointTree_.set(i,u));let c;s!=null?c=!0:(c=!1,s=Re.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((E,S)=>{const P=Cu(S,ot());P&&(s=s.updateImmediateChild(E,P))}));const h=H8(u,e);if(!h&&!e._queryParams.loadsAllData()){const _=o0(e);ae(!t.queryToTagMap.has(_),"View does not exist, but we have a tag");const E=cz();t.queryToTagMap.set(_,E),t.tagToQueryMap.set(E,_)}const p=uE(t.pendingWriteTree_,i);let m=XU(u,e,n,p,s,c);if(!h&&!o&&!r){const _=W8(u,e);m=m.concat(hz(t,e,_))}return m}function pE(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,u)=>{const c=Rr(o,e),h=Cu(u,c);if(h)return h});return F8(i,e,s,n,!0)}function cc(t,e){return q8(e,t.syncPointTree_,null,uE(t.pendingWriteTree_,ot()))}function q8(t,e,n,r){if(Ge(t.path))return K8(t,e,n,r);{const i=e.get(ot());n==null&&i!=null&&(n=Cu(i,ot()));let s=[];const o=Be(t.path),u=t.operationForChild(o),c=e.children.get(o);if(c&&u){const h=n?n.getImmediateChild(o):null,p=V8(r,o);s=s.concat(q8(u,c,h,p))}return i&&(s=s.concat(fE(i,t,r,n))),s}}function K8(t,e,n,r){const i=e.get(ot());n==null&&i!=null&&(n=Cu(i,ot()));let s=[];return e.children.inorderTraversal((o,u)=>{const c=n?n.getImmediateChild(o):null,h=V8(r,o),p=t.operationForChild(o);p&&(s=s.concat(K8(p,u,c,h)))}),i&&(s=s.concat(fE(i,t,r,n))),s}function Q8(t,e){const n=e.query,r=lm(t,n);return{hashFn:()=>(jU(e)||Re.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?sz(t,n._path,r):iz(t,n._path);{const s=rV(i,n);return B1(t,n,null,s)}}}}function lm(t,e){const n=o0(e);return t.queryToTagMap.get(n)}function o0(t){return t._path.toString()+"$"+t._queryIdentifier}function gE(t,e){return t.tagToQueryMap.get(e)}function mE(t){const e=t.indexOf("$");return ae(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new gt(t.substr(0,e))}}function _E(t,e,n){const r=t.syncPointTree_.get(e);ae(r,"Missing sync point for query tag that we're tracking");const i=uE(t.pendingWriteTree_,e);return fE(r,n,i,null)}function lz(t){return t.fold((e,n,r)=>{if(n&&ea(n))return[i0(n)];{let i=[];return n&&(i=G8(n)),jn(r,(s,o)=>{i=i.concat(o)}),i}})}function Wh(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(ez())(t._repo,t._path):t}function uz(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=o0(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function cz(){return tz++}function hz(t,e,n){const r=e._path,i=lm(t,e),s=Q8(t,n),o=t.listenProvider_.startListening(Wh(e),i,s.hashFn,s.onComplete),u=t.syncPointTree_.subtree(r);if(i)ae(!ea(u.value),"If we're adding a query, it shouldn't be shadowed");else{const c=u.fold((h,p,m)=>{if(!Ge(h)&&p&&ea(p))return[i0(p).query];{let _=[];return p&&(_=_.concat(G8(p).map(E=>E.query))),jn(m,(E,S)=>{_=_.concat(S)}),_}});for(let h=0;h<c.length;++h){const p=c[h];t.listenProvider_.stopListening(Wh(p),lm(t,p))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new vE(n)}node(){return this.node_}}class yE{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ft(this.path_,e);return new yE(this.syncTree_,n)}node(){return pE(this.syncTree_,this.path_)}}const dz=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},C3=function(t,e,n){if(!t||typeof t!="object")return t;if(ae(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return fz(t[".sv"],e,n);if(typeof t[".sv"]=="object")return pz(t[".sv"],e);ae(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},fz=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:ae(!1,"Unexpected server value: "+t)}},pz=function(t,e,n){t.hasOwnProperty("increment")||ae(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&ae(!1,"Unexpected increment value: "+r);const i=e.node();if(ae(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},Y8=function(t,e,n,r){return wE(e,new yE(n,t),r)},X8=function(t,e,n){return wE(t,new vE(e),n)};function wE(t,e,n){const r=t.getPriority().val(),i=C3(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,u=C3(o.getValue(),e,n);return u!==o.getValue()||i!==o.getPriority().val()?new yn(u,Tn(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new yn(i))),o.forEachChild(Vt,(u,c)=>{const h=wE(c,e.getImmediateChild(u),n);h!==c&&(s=s.updateImmediateChild(u,h))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function SE(t,e){let n=e instanceof gt?e:new gt(e),r=t,i=Be(n);for(;i!==null;){const s=Du(r.node.children,i)||{children:{},childCount:0};r=new EE(i,r,s),n=Et(n),i=Be(n)}return r}function hc(t){return t.node.value}function J8(t,e){t.node.value=e,j1(t)}function Z8(t){return t.node.childCount>0}function gz(t){return hc(t)===void 0&&!Z8(t)}function a0(t,e){jn(t.node.children,(n,r)=>{e(new EE(n,t,r))})}function eR(t,e,n,r){n&&e(t),a0(t,i=>{eR(i,e,!0)})}function mz(t,e,n){let r=t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Xd(t){return new gt(t.parent===null?t.name:Xd(t.parent)+"/"+t.name)}function j1(t){t.parent!==null&&_z(t.parent,t.name,t)}function _z(t,e,n){const r=gz(n),i=rs(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,j1(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,j1(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vz=/[\[\].#$\/\u0000-\u001F\u007F]/,yz=/[\[\].#$\u0000-\u001F\u007F]/,Xv=10*1024*1024,TE=function(t){return typeof t=="string"&&t.length!==0&&!vz.test(t)},tR=function(t){return typeof t=="string"&&t.length!==0&&!yz.test(t)},wz=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),tR(t)},Ez=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Qw(t)||t&&typeof t=="object"&&rs(t,".sv")},Sz=function(t,e,n,r){l0(bm(t,"value"),e,n)},l0=function(t,e,n){const r=n instanceof gt?new FV(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+La(r));if(typeof e=="function")throw new Error(t+"contains a function "+La(r)+" with contents = "+e.toString());if(Qw(e))throw new Error(t+"contains "+e.toString()+" "+La(r));if(typeof e=="string"&&e.length>Xv/3&&Fm(e)>Xv)throw new Error(t+"contains a string greater than "+Xv+" utf8 bytes "+La(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(jn(e,(o,u)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!TE(o)))throw new Error(t+" contains an invalid key ("+o+") "+La(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);VV(r,o),l0(t,u,r),UV(r)}),i&&s)throw new Error(t+' contains ".value" child '+La(r)+" in addition to actual children.")}},Tz=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=Ed(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!TE(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(bV);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&ti(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},Cz=function(t,e,n,r){const i=bm(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];jn(e,(o,u)=>{const c=new gt(o);if(l0(i,u,Ft(n,c)),eE(c)===".priority"&&!Ez(u))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),Tz(i,s)},nR=function(t,e,n,r){if(!tR(n))throw new Error(bm(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Iz=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),nR(t,e,n)},Pz=function(t,e){if(Be(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Rz=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!TE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!wz(n))throw new Error(bm(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kz{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function u0(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!tE(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function rR(t,e,n){u0(t,n),iR(t,r=>tE(r,e))}function Ai(t,e,n){u0(t,n),iR(t,r=>ti(r,e)||ti(e,r))}function iR(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(Az(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Az(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();zh&&bn("event: "+n.toString()),uc(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xz="repo_interrupt",Nz=25;class Dz{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new kz,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tm(),this.transactionQueueTree_=new EE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Oz(t,e,n){if(t.stats_=Jw(t.repoInfo_),t.forceRestClient_||aV())t.server_=new em(t.repoInfo_,(r,i,s,o)=>{I3(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>P3(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Cn(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Vs(t.repoInfo_,e,(r,i,s,o)=>{I3(t,r,i,s,o)},r=>{P3(t,r)},r=>{Lz(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=dV(t.repoInfo_,()=>new hU(t.stats_,t.server_)),t.infoData_=new oU,t.infoSyncTree_=new S3({startListening:(r,i,s,o)=>{let u=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(u=s0(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),u},stopListening:()=>{}}),CE(t,"connected",!1),t.serverSyncTree_=new S3({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(u,c)=>{const h=o(u,c);Ai(t.eventQueue_,r._path,h)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function Mz(t){const n=t.infoData_.getNode(new gt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function c0(t){return dz({timestamp:Mz(t)})}function I3(t,e,n,r,i){t.dataUpdateCount++;const s=new gt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const c=Lg(n,h=>Tn(h));o=az(t.serverSyncTree_,s,c,i)}else{const c=Tn(n);o=oz(t.serverSyncTree_,s,c,i)}else if(r){const c=Lg(n,h=>Tn(h));o=rz(t.serverSyncTree_,s,c)}else{const c=Tn(n);o=s0(t.serverSyncTree_,s,c)}let u=s;o.length>0&&(u=$u(t,s)),Ai(t.eventQueue_,u,o)}function P3(t,e){CE(t,"connected",e),e===!1&&Vz(t)}function Lz(t,e){jn(e,(n,r)=>{CE(t,n,r)})}function CE(t,e,n){const r=new gt("/.info/"+e),i=Tn(n);t.infoData_.updateSnapshot(r,i);const s=s0(t.infoSyncTree_,r,i);Ai(t.eventQueue_,r,s)}function IE(t){return t.nextWriteId_++}function bz(t,e,n,r,i){h0(t,"set",{path:e.toString(),value:n,priority:r});const s=c0(t),o=Tn(n,r),u=pE(t.serverSyncTree_,e),c=X8(o,u,s),h=IE(t),p=$8(t.serverSyncTree_,e,c,h,!0);u0(t.eventQueue_,p),t.server_.put(e.toString(),o.val(!0),(_,E)=>{const S=_==="ok";S||fr("set at "+e+" failed: "+_);const P=Do(t.serverSyncTree_,h,!S);Ai(t.eventQueue_,e,P),G1(t,i,_,E)});const m=RE(t,e);$u(t,m),Ai(t.eventQueue_,m,[])}function Fz(t,e,n,r){h0(t,"update",{path:e.toString(),value:n});let i=!0;const s=c0(t),o={};if(jn(n,(u,c)=>{i=!1,o[u]=Y8(Ft(e,u),Tn(c),t.serverSyncTree_,s)}),i)bn("update() called with empty data.  Don't do anything."),G1(t,r,"ok",void 0);else{const u=IE(t),c=nz(t.serverSyncTree_,e,o,u);u0(t.eventQueue_,c),t.server_.merge(e.toString(),n,(h,p)=>{const m=h==="ok";m||fr("update at "+e+" failed: "+h);const _=Do(t.serverSyncTree_,u,!m),E=_.length>0?$u(t,e):e;Ai(t.eventQueue_,E,_),G1(t,r,h,p)}),jn(n,h=>{const p=RE(t,Ft(e,h));$u(t,p)}),Ai(t.eventQueue_,e,[])}}function Vz(t){h0(t,"onDisconnectEvents");const e=c0(t),n=tm();M1(t.onDisconnect_,ot(),(i,s)=>{const o=Y8(i,s,t.serverSyncTree_,e);O8(n,i,o)});let r=[];M1(n,ot(),(i,s)=>{r=r.concat(s0(t.serverSyncTree_,i,s));const o=RE(t,i);$u(t,o)}),t.onDisconnect_=tm(),Ai(t.eventQueue_,ot(),r)}function Uz(t,e,n){let r;Be(e._path)===".info"?r=T3(t.infoSyncTree_,e,n):r=T3(t.serverSyncTree_,e,n),rR(t.eventQueue_,e._path,r)}function zz(t,e,n){let r;Be(e._path)===".info"?r=B1(t.infoSyncTree_,e,n):r=B1(t.serverSyncTree_,e,n),rR(t.eventQueue_,e._path,r)}function Bz(t){t.persistentConnection_&&t.persistentConnection_.interrupt(xz)}function h0(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),bn(n,...e)}function G1(t,e,n,r){e&&uc(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function sR(t,e,n){return pE(t.serverSyncTree_,e,n)||Re.EMPTY_NODE}function PE(t,e=t.transactionQueueTree_){if(e||d0(t,e),hc(e)){const n=aR(t,e);ae(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&jz(t,Xd(e),n)}else Z8(e)&&a0(e,n=>{PE(t,n)})}function jz(t,e,n){const r=n.map(h=>h.currentWriteId),i=sR(t,e,r);let s=i;const o=i.hash();for(let h=0;h<n.length;h++){const p=n[h];ae(p.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),p.status=1,p.retryCount++;const m=Rr(e,p.path);s=s.updateChild(m,p.currentOutputSnapshotRaw)}const u=s.val(!0),c=e;t.server_.put(c.toString(),u,h=>{h0(t,"transaction put response",{path:c.toString(),status:h});let p=[];if(h==="ok"){const m=[];for(let _=0;_<n.length;_++)n[_].status=2,p=p.concat(Do(t.serverSyncTree_,n[_].currentWriteId)),n[_].onComplete&&m.push(()=>n[_].onComplete(null,!0,n[_].currentOutputSnapshotResolved)),n[_].unwatcher();d0(t,SE(t.transactionQueueTree_,e)),PE(t,t.transactionQueueTree_),Ai(t.eventQueue_,e,p);for(let _=0;_<m.length;_++)uc(m[_])}else{if(h==="datastale")for(let m=0;m<n.length;m++)n[m].status===3?n[m].status=4:n[m].status=0;else{fr("transaction at "+c.toString()+" failed: "+h);for(let m=0;m<n.length;m++)n[m].status=4,n[m].abortReason=h}$u(t,e)}},o)}function $u(t,e){const n=oR(t,e),r=Xd(n),i=aR(t,n);return Gz(t,i,r),r}function Gz(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(u=>u.status===0).map(u=>u.currentWriteId);for(let u=0;u<e.length;u++){const c=e[u],h=Rr(n,c.path);let p=!1,m;if(ae(h!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)p=!0,m=c.abortReason,i=i.concat(Do(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=Nz)p=!0,m="maxretry",i=i.concat(Do(t.serverSyncTree_,c.currentWriteId,!0));else{const _=sR(t,c.path,o);c.currentInputSnapshot=_;const E=e[u].update(_.val());if(E!==void 0){l0("transaction failed: Data returned ",E,c.path);let S=Tn(E);typeof E=="object"&&E!=null&&rs(E,".priority")||(S=S.updatePriority(_.getPriority()));const N=c.currentWriteId,R=c0(t),k=X8(S,_,R);c.currentOutputSnapshotRaw=S,c.currentOutputSnapshotResolved=k,c.currentWriteId=IE(t),o.splice(o.indexOf(N),1),i=i.concat($8(t.serverSyncTree_,c.path,k,c.currentWriteId,c.applyLocally)),i=i.concat(Do(t.serverSyncTree_,N,!0))}else p=!0,m="nodata",i=i.concat(Do(t.serverSyncTree_,c.currentWriteId,!0))}Ai(t.eventQueue_,n,i),i=[],p&&(e[u].status=2,function(_){setTimeout(_,Math.floor(0))}(e[u].unwatcher),e[u].onComplete&&(m==="nodata"?r.push(()=>e[u].onComplete(null,!1,e[u].currentInputSnapshot)):r.push(()=>e[u].onComplete(new Error(m),!1,null))))}d0(t,t.transactionQueueTree_);for(let u=0;u<r.length;u++)uc(r[u]);PE(t,t.transactionQueueTree_)}function oR(t,e){let n,r=t.transactionQueueTree_;for(n=Be(e);n!==null&&hc(r)===void 0;)r=SE(r,n),e=Et(e),n=Be(e);return r}function aR(t,e){const n=[];return lR(t,e,n),n.sort((r,i)=>r.order-i.order),n}function lR(t,e,n){const r=hc(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);a0(e,i=>{lR(t,i,n)})}function d0(t,e){const n=hc(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,J8(e,n.length>0?n:void 0)}a0(e,r=>{d0(t,r)})}function RE(t,e){const n=Xd(oR(t,e)),r=SE(t.transactionQueueTree_,e);return mz(r,i=>{Jv(t,i)}),Jv(t,r),eR(r,i=>{Jv(t,i)}),n}function Jv(t,e){const n=hc(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(ae(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(ae(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Do(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?J8(e,void 0):n.length=s+1,Ai(t.eventQueue_,Xd(e),i);for(let o=0;o<r.length;o++)uc(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wz(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Hz(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):fr(`Invalid query segment '${n}' in query '${t}'`)}return e}const R3=function(t,e){const n=$z(t),r=n.namespace;n.domain==="firebase.com"&&Ks(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Ks("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||JF();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new m8(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new gt(n.pathString)}},$z=function(t){let e="",n="",r="",i="",s="",o=!0,u="https",c=443;if(typeof t=="string"){let h=t.indexOf("//");h>=0&&(u=t.substring(0,h-1),t=t.substring(h+2));let p=t.indexOf("/");p===-1&&(p=t.length);let m=t.indexOf("?");m===-1&&(m=t.length),e=t.substring(0,Math.min(p,m)),p<m&&(i=Wz(t.substring(p,m)));const _=Hz(t.substring(Math.min(t.length,m)));h=e.indexOf(":"),h>=0?(o=u==="https"||u==="wss",c=parseInt(e.substring(h+1),10)):h=e.length;const E=e.slice(0,h);if(E.toLowerCase()==="localhost")n="localhost";else if(E.split(".").length<=2)n=E;else{const S=e.indexOf(".");r=e.substring(0,S).toLowerCase(),n=e.substring(S+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:u,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Cn(this.snapshot.exportVal())}}class Kz{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return ae(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return Ge(this._path)?null:eE(this._path)}get ref(){return new oa(this._repo,this._path)}get _queryIdentifier(){const e=d3(this._queryParams),n=Yw(e);return n==="{}"?"default":n}get _queryObject(){return d3(this._queryParams)}isEqual(e){if(e=cn(e),!(e instanceof kE))return!1;const n=this._repo===e._repo,r=tE(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+LV(this._path)}}class oa extends kE{constructor(e,n){super(e,n,new sE,!1)}get parent(){const e=I8(this._path);return e===null?null:new oa(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class um{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new gt(e),r=W1(this.ref,e);return new um(this._node.getChild(n),r,Vt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new um(i,W1(this.ref,r),Vt)))}hasChild(e){const n=new gt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function cm(t,e){return t=cn(t),t._checkNotDeleted("ref"),e!==void 0?W1(t._root,e):t._root}function W1(t,e){return t=cn(t),Be(t._path)===null?Iz("child","path",e):nR("child","path",e),new oa(t._repo,Ft(t._path,e))}function Yz(t,e){t=cn(t),Pz("set",t._path),Sz("set",e,t._path);const n=new bd;return bz(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Xz(t,e){Cz("update",e,t._path);const n=new bd;return Fz(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}class AE{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new qz("value",this,new um(e.snapshotNode,new oa(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Kz(this,e,n):null}matches(e){return e instanceof AE?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Jz(t,e,n,r,i){const s=new Qz(n,void 0),o=new AE(s);return Uz(t._repo,t,o),()=>zz(t._repo,t,o)}function uR(t,e,n,r){return Jz(t,"value",e)}qU(oa);ZU(oa);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zz="FIREBASE_DATABASE_EMULATOR_HOST",H1={};let eB=!1;function tB(t,e,n,r){t.repoInfo_=new m8(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function nB(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Ks("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),bn("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=R3(s,i),u=o.repoInfo,c;typeof process<"u"&&KC&&(c=KC[Zz]),c?(s=`http://${c}?ns=${u.namespace}`,o=R3(s,i),u=o.repoInfo):o.repoInfo.secure;const h=new uV(t.name,t.options,e);Rz("Invalid Firebase Database URL",o),Ge(o.path)||Ks("Database URL must point to the root of a Firebase Database (not including a child path).");const p=iB(u,t,h,new lV(t.name,n));return new sB(p,t)}function rB(t,e){const n=H1[e];(!n||n[t.key]!==t)&&Ks(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Bz(t),delete n[t.key]}function iB(t,e,n,r){let i=H1[e.name];i||(i={},H1[e.name]=i);let s=i[t.toURLString()];return s&&Ks("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Dz(t,eB,n,r),i[t.toURLString()]=s,s}class sB{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Oz(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new oa(this._repo,ot())),this._rootInternal}_delete(){return this._rootInternal!==null&&(rB(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ks("Cannot call "+e+" on a deleted database.")}}function oB(t=rw(),e){const n=Um(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=W6("database");r&&aB(n,...r)}return n}function aB(t,e,n,r={}){t=cn(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Ks("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ks('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new sg(sg.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:q6(r.mockUserToken,t.app.options.projectId);s=new sg(o)}tB(i,e,n,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lB(t){$F(ul),Xa(new Qo("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return nB(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Xi(QC,YC,t),Xi(QC,YC,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uB={".sv":"timestamp"};function cB(){return uB}Vs.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Vs.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};lB();const hB={apiKey:"AIzaSyDf4XaY5tRthfcIy5ssjcAKlCYgB7ZkMjU",authDomain:"goplace-f33c9.firebaseapp.com",databaseURL:"https://goplace-f33c9-default-rtdb.europe-west1.firebasedatabase.app",projectId:"goplace-f33c9",storageBucket:"goplace-f33c9.firebasestorage.app",messagingSenderId:"978391795944",appId:"1:978391795944:web:342789484e502bfb19a15d"},xE=J6(hB),NE=bM(xE),dB=new Rs,hm=IF(xE),dm=oB(xE),fB=({user:t})=>{const e=async()=>{try{await IO(NE)}catch(n){console.error("Error signing out:",n)}};return K.jsx("nav",{className:"reddit-navbar",children:K.jsxs("div",{className:"container mx-auto flex justify-between items-center px-2",children:[K.jsxs(xo,{to:"/",className:"flex items-center gap-2",children:[K.jsx("div",{className:"text-reddit-orange font-bold text-2xl",children:"r/Place"}),K.jsx("div",{className:"text-reddit-text font-semibold hidden sm:block",children:"Clone"})]}),K.jsxs("div",{className:"flex gap-3 items-center",children:[K.jsx(xo,{to:"/",className:"hover:text-white",children:"Home"}),t?K.jsxs(K.Fragment,{children:[K.jsx(xo,{to:"/create",className:"reddit-btn-secondary hidden sm:block",children:"Create Canvas"}),K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-8 h-8 rounded-full border border-reddit-border"}),K.jsx("span",{className:"hidden md:inline text-reddit-text",children:t.displayName})]}),K.jsx("button",{onClick:e,className:"bg-reddit-orange hover:bg-reddit-orangeHover text-white px-3 py-1 rounded",children:"Logout"})]}):K.jsx(xo,{to:"/login",className:"bg-reddit-orange hover:bg-reddit-orangeHover text-white px-3 py-1 rounded",children:"Login"})]})]})})},pB=({canvasId:t,size:e})=>{const n=X.useRef(null),[r,i]=X.useState(!1);return X.useEffect(()=>{const s=n.current;if(!s)return;const o=s.getContext("2d"),u=s.width/e[0];o.fillStyle="#FFFFFF",o.fillRect(0,0,s.width,s.height),o.strokeStyle="#343536",o.lineWidth=1,o.strokeRect(0,0,s.width,s.height);const c=cm(dm,`canvases/${t}/pixels`),h=uR(c,p=>{const m=p.val()||{};Object.entries(m).forEach(([_,E])=>{const[S,P]=_.split(",").map(Number);o.fillStyle=E,o.fillRect(S*u,P*u,u,u)}),i(!0)});return()=>h()},[t,e]),K.jsxs("div",{className:"relative w-[100px] h-[100px]",children:[!r&&K.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-reddit-highlight text-reddit-muted text-xs",children:"Loading..."}),K.jsx("canvas",{ref:n,width:100,height:100,className:"canvas-preview"})]})},gB=({user:t})=>{const[e,n]=X.useState([]),[r,i]=X.useState(!0);return X.useEffect(()=>{(async()=>{try{const o=GC(x1(hm,"canvases"),Hv("public","==",!0)),u=await $C(o),c=[];if(u.forEach(h=>{c.push({id:h.id,...h.data()})}),t){const h=GC(x1(hm,"canvases"),Hv("createdBy","==",t.uid),Hv("public","==",!1));(await $C(h)).forEach(m=>{c.push({id:m.id,...m.data()})})}n(c)}catch(o){console.error("Error fetching canvases:",o)}finally{i(!1)}})()},[t]),r?K.jsx("div",{className:"reddit-loading h-screen",children:"Loading canvases..."}):K.jsxs("div",{className:"container mx-auto p-4 dark-mode min-h-screen",children:[K.jsx("h1",{className:"text-2xl font-bold mb-6 reddit-title",children:"Available Canvases"}),t&&K.jsx(xo,{to:"/create",className:"reddit-btn mb-6 inline-block",children:"Create New Canvas"}),e.length===0?K.jsxs("div",{className:"text-center mt-8 text-reddit-text",children:[K.jsx("p",{children:"No canvases available."}),!t&&K.jsxs("p",{className:"mt-2",children:[K.jsx(xo,{to:"/login",className:"text-reddit-blue hover:underline",children:"Login"})," to create your own canvas!"]})]}):K.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(s=>K.jsx(xo,{to:`/canvas/${s.id}`,children:K.jsxs("div",{className:"canvas-card",children:[K.jsx("h2",{className:"text-lg font-bold mb-2 reddit-title",children:s.name}),K.jsxs("p",{className:"text-sm text-reddit-muted mb-2",children:[s.size[0],"  ",s.size[1]]}),K.jsx(pB,{canvasId:s.id,size:s.size}),K.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[K.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.public?"bg-reddit-blue/20 text-reddit-blue":"bg-reddit-orange/20 text-reddit-orange"}`,children:s.public?"Public":"Private"}),K.jsxs("span",{className:"text-xs text-reddit-muted",children:["Created ",new Date(s.createdAt).toLocaleDateString()]})]})]})},s.id))})]})};var cR={exports:{}},f0={},fm={},Ve={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof f4<"u"?f4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.2.3",isBrowser:n(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const r=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=r,t.Konva._injectGlobal(t.Konva)})(Ve);var Lt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=Ve;class n{constructor(A=[1,0,0,1,0,0]){this.dirty=!1,this.m=A&&A.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(A){A.m[0]=this.m[0],A.m[1]=this.m[1],A.m[2]=this.m[2],A.m[3]=this.m[3],A.m[4]=this.m[4],A.m[5]=this.m[5]}point(A){var V=this.m;return{x:V[0]*A.x+V[2]*A.y+V[4],y:V[1]*A.x+V[3]*A.y+V[5]}}translate(A,V){return this.m[4]+=this.m[0]*A+this.m[2]*V,this.m[5]+=this.m[1]*A+this.m[3]*V,this}scale(A,V){return this.m[0]*=A,this.m[1]*=A,this.m[2]*=V,this.m[3]*=V,this}rotate(A){var V=Math.cos(A),U=Math.sin(A),O=this.m[0]*V+this.m[2]*U,C=this.m[1]*V+this.m[3]*U,D=this.m[0]*-U+this.m[2]*V,x=this.m[1]*-U+this.m[3]*V;return this.m[0]=O,this.m[1]=C,this.m[2]=D,this.m[3]=x,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(A,V){var U=this.m[0]+this.m[2]*V,O=this.m[1]+this.m[3]*V,C=this.m[2]+this.m[0]*A,D=this.m[3]+this.m[1]*A;return this.m[0]=U,this.m[1]=O,this.m[2]=C,this.m[3]=D,this}multiply(A){var V=this.m[0]*A.m[0]+this.m[2]*A.m[1],U=this.m[1]*A.m[0]+this.m[3]*A.m[1],O=this.m[0]*A.m[2]+this.m[2]*A.m[3],C=this.m[1]*A.m[2]+this.m[3]*A.m[3],D=this.m[0]*A.m[4]+this.m[2]*A.m[5]+this.m[4],x=this.m[1]*A.m[4]+this.m[3]*A.m[5]+this.m[5];return this.m[0]=V,this.m[1]=U,this.m[2]=O,this.m[3]=C,this.m[4]=D,this.m[5]=x,this}invert(){var A=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),V=this.m[3]*A,U=-this.m[1]*A,O=-this.m[2]*A,C=this.m[0]*A,D=A*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),x=A*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=V,this.m[1]=U,this.m[2]=O,this.m[3]=C,this.m[4]=D,this.m[5]=x,this}getMatrix(){return this.m}decompose(){var A=this.m[0],V=this.m[1],U=this.m[2],O=this.m[3],C=this.m[4],D=this.m[5],x=A*O-V*U;let M={x:C,y:D,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(A!=0||V!=0){var z=Math.sqrt(A*A+V*V);M.rotation=V>0?Math.acos(A/z):-Math.acos(A/z),M.scaleX=z,M.scaleY=x/z,M.skewX=(A*U+V*O)/x,M.skewY=0}else if(U!=0||O!=0){var b=Math.sqrt(U*U+O*O);M.rotation=Math.PI/2-(O>0?Math.acos(-U/b):-Math.acos(U/b)),M.scaleX=x/b,M.scaleY=b,M.skewX=0,M.skewY=(A*U+V*O)/x}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=n;var r="[object Array]",i="[object Number]",s="[object String]",o="[object Boolean]",u=Math.PI/180,c=180/Math.PI,h="#",p="",m="0",_="Konva warning: ",E="Konva error: ",S="rgb(",P={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},N=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,R=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};t.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===r},_isNumber(w){return Object.prototype.toString.call(w)===i&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===s},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;var A=w[0];return A==="#"||A==="."||A===A.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){R.push(w),R.length===1&&k(function(){const A=R;R=[],A.forEach(function(V){V()})})},createCanvasElement(){var w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,A){var V=t.Util.createImageElement();V.onload=function(){A(V)},V.src=w},_rgbToHex(w,A,V){return((1<<24)+(w<<16)+(A<<8)+V).toString(16).slice(1)},_hexToRgb(w){w=w.replace(h,p);var A=parseInt(w,16);return{r:A>>16&255,g:A>>8&255,b:A&255}},getRandomColor(){for(var w=(Math.random()*16777215<<0).toString(16);w.length<6;)w=m+w;return h+w},getRGB(w){var A;return w in P?(A=P[w],{r:A[0],g:A[1],b:A[2]}):w[0]===h?this._hexToRgb(w.substring(1)):w.substr(0,4)===S?(A=N.exec(w.replace(/ /g,"")),{r:parseInt(A[1],10),g:parseInt(A[2],10),b:parseInt(A[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",t.Util._namedColorToRBA(w)||t.Util._hex3ColorToRGBA(w)||t.Util._hex4ColorToRGBA(w)||t.Util._hex6ColorToRGBA(w)||t.Util._hex8ColorToRGBA(w)||t.Util._rgbColorToRGBA(w)||t.Util._rgbaColorToRGBA(w)||t.Util._hslColorToRGBA(w)},_namedColorToRBA(w){var A=P[w.toLowerCase()];return A?{r:A[0],g:A[1],b:A[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];var A=w.split(/ *, */).map(Number);return{r:A[0],g:A[1],b:A[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];var A=w.split(/ *, */).map((V,U)=>V.slice(-1)==="%"?U===3?parseInt(V)/100:parseInt(V)/100*255:Number(V));return{r:A[0],g:A[1],b:A[2],a:A[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[A,...V]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),U=Number(V[0])/360,O=Number(V[1])/100,C=Number(V[2])/100;let D,x,M;if(O===0)return M=C*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};C<.5?D=C*(1+O):D=C+O-C*O;const z=2*C-D,b=[0,0,0];for(let oe=0;oe<3;oe++)x=U+1/3*-(oe-1),x<0&&x++,x>1&&x--,6*x<1?M=z+(D-z)*6*x:2*x<1?M=D:3*x<2?M=z+(D-z)*(2/3-x)*6:M=z,b[oe]=M*255;return{r:Math.round(b[0]),g:Math.round(b[1]),b:Math.round(b[2]),a:1}}},haveIntersection(w,A){return!(A.x>w.x+w.width||A.x+A.width<w.x||A.y>w.y+w.height||A.y+A.height<w.y)},cloneObject(w){var A={};for(var V in w)this._isPlainObject(w[V])?A[V]=this.cloneObject(w[V]):this._isArray(w[V])?A[V]=this.cloneArray(w[V]):A[V]=w[V];return A},cloneArray(w){return w.slice(0)},degToRad(w){return w*u},radToDeg(w){return w*c},_degToRad(w){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(w)},_radToDeg(w){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?t.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(E+w)},error(w){console.error(E+w)},warn(w){e.Konva.showWarnings&&console.warn(_+w)},each(w,A){for(var V in w)A(V,w[V])},_inRange(w,A,V){return A<=w&&w<V},_getProjectionToSegment(w,A,V,U,O,C){var D,x,M,z=(w-V)*(w-V)+(A-U)*(A-U);if(z==0)D=w,x=A,M=(O-V)*(O-V)+(C-U)*(C-U);else{var b=((O-w)*(V-w)+(C-A)*(U-A))/z;b<0?(D=w,x=A,M=(w-O)*(w-O)+(A-C)*(A-C)):b>1?(D=V,x=U,M=(V-O)*(V-O)+(U-C)*(U-C)):(D=w+b*(V-w),x=A+b*(U-A),M=(D-O)*(D-O)+(x-C)*(x-C))}return[D,x,M]},_getProjectionToLine(w,A,V){var U=t.Util.cloneObject(w),O=Number.MAX_VALUE;return A.forEach(function(C,D){if(!(!V&&D===A.length-1)){var x=A[(D+1)%A.length],M=t.Util._getProjectionToSegment(C.x,C.y,x.x,x.y,w.x,w.y),z=M[0],b=M[1],oe=M[2];oe<O&&(U.x=z,U.y=b,O=oe)}}),U},_prepareArrayForTween(w,A,V){var U,O=[],C=[];if(w.length>A.length){var D=A;A=w,w=D}for(U=0;U<w.length;U+=2)O.push({x:w[U],y:w[U+1]});for(U=0;U<A.length;U+=2)C.push({x:A[U],y:A[U+1]});var x=[];return C.forEach(function(M){var z=t.Util._getProjectionToLine(M,O,V);x.push(z.x),x.push(z.y)}),x},_prepareToStringify(w){var A;w.visitedByCircularReferenceRemoval=!0;for(var V in w)if(w.hasOwnProperty(V)&&w[V]&&typeof w[V]=="object"){if(A=Object.getOwnPropertyDescriptor(w,V),w[V].visitedByCircularReferenceRemoval||t.Util._isElement(w[V]))if(A.configurable)delete w[V];else return null;else if(t.Util._prepareToStringify(w[V])===null)if(A.configurable)delete w[V];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,A){for(var V in A)w[V]=A[V];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(A=>{A.width=0,A.height=0})},drawRoundedRectPath(w,A,V,U){let O=0,C=0,D=0,x=0;typeof U=="number"?O=C=D=x=Math.min(U,A/2,V/2):(O=Math.min(U[0]||0,A/2,V/2),C=Math.min(U[1]||0,A/2,V/2),x=Math.min(U[2]||0,A/2,V/2),D=Math.min(U[3]||0,A/2,V/2)),w.moveTo(O,0),w.lineTo(A-C,0),w.arc(A-C,C,C,Math.PI*3/2,0,!1),w.lineTo(A,V-x),w.arc(A-x,V-x,x,0,Math.PI/2,!1),w.lineTo(D,V),w.arc(D,V-D,D,Math.PI/2,Math.PI,!1),w.lineTo(0,O),w.arc(O,O,O,Math.PI,Math.PI*3/2,!1)}}})(Lt);var At={},Ue={},Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.getComponentValidator=Ee.getBooleanValidator=Ee.getNumberArrayValidator=Ee.getFunctionValidator=Ee.getStringOrGradientValidator=Ee.getStringValidator=Ee.getNumberOrAutoValidator=Ee.getNumberOrArrayOfNumbersValidator=Ee.getNumberValidator=Ee.alphaComponent=Ee.RGBComponent=void 0;const Js=Ve,Ut=Lt;function Zs(t){return Ut.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Ut.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function mB(t){return t>255?255:t<0?0:Math.round(t)}Ee.RGBComponent=mB;function _B(t){return t>1?1:t<1e-4?1e-4:t}Ee.alphaComponent=_B;function vB(){if(Js.Konva.isUnminified)return function(t,e){return Ut.Util._isNumber(t)||Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}Ee.getNumberValidator=vB;function yB(t){if(Js.Konva.isUnminified)return function(e,n){let r=Ut.Util._isNumber(e),i=Ut.Util._isArray(e)&&e.length==t;return!r&&!i&&Ut.Util.warn(Zs(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}Ee.getNumberOrArrayOfNumbersValidator=yB;function wB(){if(Js.Konva.isUnminified)return function(t,e){var n=Ut.Util._isNumber(t),r=t==="auto";return n||r||Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}Ee.getNumberOrAutoValidator=wB;function EB(){if(Js.Konva.isUnminified)return function(t,e){return Ut.Util._isString(t)||Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}Ee.getStringValidator=EB;function SB(){if(Js.Konva.isUnminified)return function(t,e){const n=Ut.Util._isString(t),r=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||r||Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}Ee.getStringOrGradientValidator=SB;function TB(){if(Js.Konva.isUnminified)return function(t,e){return Ut.Util._isFunction(t)||Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}Ee.getFunctionValidator=TB;function CB(){if(Js.Konva.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(Ut.Util._isArray(t)?t.forEach(function(r){Ut.Util._isNumber(r)||Ut.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}Ee.getNumberArrayValidator=CB;function IB(){if(Js.Konva.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||Ut.Util.warn(Zs(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}Ee.getBooleanValidator=IB;function PB(t){if(Js.Konva.isUnminified)return function(e,n){return e==null||Ut.Util.isObject(e)||Ut.Util.warn(Zs(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}Ee.getComponentValidator=PB;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Lt,n=Ee;var r="get",i="set";t.Factory={addGetterSetter(s,o,u,c,h){t.Factory.addGetter(s,o,u),t.Factory.addSetter(s,o,c,h),t.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,u){var c=r+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){var h=this.attrs[o];return h===void 0?u:h}},addSetter(s,o,u,c){var h=i+e.Util._capitalize(o);s.prototype[h]||t.Factory.overWriteSetter(s,o,u,c)},overWriteSetter(s,o,u,c){var h=i+e.Util._capitalize(o);s.prototype[h]=function(p){return u&&p!==void 0&&p!==null&&(p=u.call(this,p,o)),this._setAttr(o,p),c&&c.call(this),this}},addComponentsGetterSetter(s,o,u,c,h){var p=u.length,m=e.Util._capitalize,_=r+m(o),E=i+m(o),S,P;s.prototype[_]=function(){var R={};for(S=0;S<p;S++)P=u[S],R[P]=this.getAttr(o+m(P));return R};var N=(0,n.getComponentValidator)(u);s.prototype[E]=function(R){var k=this.attrs[o],w;c&&(R=c.call(this,R)),N&&N.call(this,R,o);for(w in R)R.hasOwnProperty(w)&&this._setAttr(o+m(w),R[w]);return R||u.forEach(A=>{this._setAttr(o+m(A),void 0)}),this._fireChangeEvent(o,k,R),h&&h.call(this),this},t.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){var u=e.Util._capitalize(o),c=i+u,h=r+u;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[h]()}},addDeprecatedGetterSetter(s,o,u,c){e.Util.error("Adding deprecated "+o);var h=r+e.Util._capitalize(o),p=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[h]=function(){e.Util.error(p);var m=this.attrs[o];return m===void 0?u:m},t.Factory.addSetter(s,o,c,function(){e.Util.error(p)}),t.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(u,c){var h=s.prototype[c],p=r+e.Util._capitalize(u),m=i+e.Util._capitalize(u);function _(){h.apply(this,arguments),e.Util.error('"'+u+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[u]=_,s.prototype[p]=_,s.prototype[m]=_})},afterSetFilter(){this._filterUpToDate=!1}}})(Ue);var Pi={},Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.HitContext=Us.SceneContext=Us.Context=void 0;const hR=Lt,RB=Ve;function kB(t){var e=[],n=t.length,r=hR.Util,i,s;for(i=0;i<n;i++)s=t[i],r._isNumber(s)?s=Math.round(s*1e3)/1e3:r._isString(s)||(s=s+""),e.push(s);return e}var k3=",",AB="(",xB=")",NB="([",DB="])",OB=";",MB="()",LB="=",A3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],bB=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const FB=100;class p0{constructor(e){this.canvas=e,RB.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){var r=this.traceArr,i=r.length,s="",o,u,c,h;for(o=0;o<i;o++)u=r[o],c=u.method,c?(h=u.args,s+=c,e?s+=MB:hR.Util._isArray(h[0])?s+=NB+h.join(k3)+DB:(n&&(h=h.map(p=>typeof p=="number"?Math.floor(p):p)),s+=AB+h.join(k3)+xB)):(s+=u.property,e||(s+=LB+u.val)),s+=OB;return s}clearTrace(){this.traceArr=[]}_trace(e){var n=this.traceArr,r;n.push(e),r=n.length,r>=FB&&n.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){var n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,r,i,s,o){this._context.arc(e,n,r,i,s,o)}arcTo(e,n,r,i,s){this._context.arcTo(e,n,r,i,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,i,s,o){this._context.bezierCurveTo(e,n,r,i,s,o)}clearRect(e,n,r,i){this._context.clearRect(e,n,r,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){var r=arguments;if(r.length===2)return this._context.createImageData(e,n);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,r,i){return this._context.createLinearGradient(e,n,r,i)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,i,s,o){return this._context.createRadialGradient(e,n,r,i,s,o)}drawImage(e,n,r,i,s,o,u,c,h){var p=arguments,m=this._context;p.length===3?m.drawImage(e,n,r):p.length===5?m.drawImage(e,n,r,i,s):p.length===9&&m.drawImage(e,n,r,i,s,o,u,c,h)}ellipse(e,n,r,i,s,o,u,c){this._context.ellipse(e,n,r,i,s,o,u,c)}isPointInPath(e,n,r,i){return r?this._context.isPointInPath(r,e,n,i):this._context.isPointInPath(e,n,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,r,i){this._context.fillRect(e,n,r,i)}strokeRect(e,n,r,i){this._context.strokeRect(e,n,r,i)}fillText(e,n,r,i){i?this._context.fillText(e,n,r,i):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,i){return this._context.getImageData(e,n,r,i)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,r,i){this._context.rect(e,n,r,i)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,i){this._context.quadraticCurveTo(e,n,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,r,i,s,o){this._context.setTransform(e,n,r,i,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,i){this._context.strokeText(e,n,r,i)}transform(e,n,r,i,s,o){this._context.transform(e,n,r,i,s,o)}translate(e,n){this._context.translate(e,n)}_enableTrace(){var e=this,n=A3.length,r=this.setAttr,i,s,o=function(u){var c=e[u],h;e[u]=function(){return s=kB(Array.prototype.slice.call(arguments,0)),h=c.apply(e,arguments),e._trace({method:u,args:s}),h}};for(i=0;i<n;i++)o(A3[i]);e.setAttr=function(){r.apply(e,arguments);var u=arguments[0],c=arguments[1];(u==="shadowOffsetX"||u==="shadowOffsetY"||u==="shadowBlur")&&(c=c/this.canvas.getPixelRatio()),e._trace({property:u,val:c})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;var r=!n||n==="source-over";r||this.setAttr("globalCompositeOperation",n)}}Us.Context=p0;bB.forEach(function(t){Object.defineProperty(p0.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class VB extends p0{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){var n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),r=e.getFillPriority();if(n&&r==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&r==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):i?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(n.x,n.y,r.x,r.y);if(i){for(var o=0;o<i.length;o+=2)s.addColorStop(i[o],i[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){var n=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var s=e.getStrokeLinearGradientColorStops();s?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var n,r,i,s=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,u=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},c=e.getAbsoluteScale(),h=this.canvas.getPixelRatio(),p=c.x*h,m=c.y*h;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",u.x*p),this.setAttr("shadowOffsetY",u.y*m)}}Us.SceneContext=VB;class UB extends p0{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const s=e.getStrokeScaleEnabled();if(!s){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(e);var r=e.hitStrokeWidth(),i=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),s||this.restore()}}}Us.HitContext=UB;Object.defineProperty(Pi,"__esModule",{value:!0});Pi.HitCanvas=Pi.SceneCanvas=Pi.Canvas=void 0;const pm=Lt,dR=Us,fR=Ve,zB=Ue,BB=Ee;var Np;function jB(){if(Np)return Np;var t=pm.Util.createCanvasElement(),e=t.getContext("2d");return Np=function(){var n=fR.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r}(),pm.Util.releaseCanvas(t),Np}let g0=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var n=e||{},r=n.pixelRatio||fR.Konva.pixelRatio||jB();this.pixelRatio=r,this._canvas=pm.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var n=this.pixelRatio,r=this.getContext()._context;r.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var n=this.pixelRatio,r=this.getContext()._context;r.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(i){return pm.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Pi.Canvas=g0;zB.Factory.addGetterSetter(g0,"pixelRatio",void 0,(0,BB.getNumberValidator)());class GB extends g0{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new dR.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Pi.SceneCanvas=GB;class WB extends g0{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new dR.HitContext(this),this.setSize(e.width,e.height)}}Pi.HitCanvas=WB;var m0={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=Ve,n=Lt;t.DD={get isDragging(){var r=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){var r;return t.DD._dragElements.forEach(i=>{r=i.node}),r},_dragElements:new Map,_drag(r){const i=[];t.DD._dragElements.forEach((s,o)=>{const{node:u}=s,c=u.getStage();c.setPointersPositions(r),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(r));const h=c._changedPointerPositions.find(_=>_.id===s.pointerId);if(h){if(s.dragStatus!=="dragging"){var p=u.dragDistance(),m=Math.max(Math.abs(h.x-s.startPointerPos.x),Math.abs(h.y-s.startPointerPos.y));if(m<p||(u.startDrag({evt:r}),!u.isDragging()))return}u._setDragPosition(r,s),i.push(u)}}),i.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:r},!0)})},_endDragBefore(r){const i=[];t.DD._dragElements.forEach(s=>{const{node:o}=s,u=o.getStage();if(r&&u.setPointersPositions(r),!u._changedPointerPositions.find(p=>p.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const h=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;h&&i.indexOf(h)===-1&&i.push(h)}),i.forEach(s=>{s.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((i,s)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:r},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1))})(m0);Object.defineProperty(At,"__esModule",{value:!0});At.Node=void 0;const qe=Lt,Jd=Ue,Dp=Pi,xa=Ve,Yr=m0,qt=Ee;var og="absoluteOpacity",Op="allEventListeners",Cs="absoluteTransform",x3="absoluteScale",Na="canvas",HB="Change",$B="children",qB="konva",$1="listening",N3="mouseenter",D3="mouseleave",O3="set",M3="Shape",ag=" ",L3="stage",yo="transform",KB="Stage",q1="visible",QB=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(ag);let YB=1;class xe{constructor(e){this._id=YB++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===yo||e===Cs)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){var r=this._cache.get(e),i=e===yo||e===Cs,s=r===void 0||i&&r.dirty===!0;return s&&(r=n.call(this),this._cache.set(e,r)),r}_calculate(e,n,r){if(!this._attachedDepsListeners.get(e)){const i=n.map(s=>s+"Change.konva").join(ag);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Na)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Cs&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Na)){const{scene:e,filter:n,hit:r}=this._cache.get(Na);qe.Util.releaseCanvas(e,n,r),this._cache.delete(Na)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var n=e||{},r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var i=Math.ceil(n.width||r.width),s=Math.ceil(n.height||r.height),o=n.pixelRatio,u=n.x===void 0?Math.floor(r.x):n.x,c=n.y===void 0?Math.floor(r.y):n.y,h=n.offset||0,p=n.drawBorder||!1,m=n.hitCanvasPixelRatio||1;if(!i||!s){qe.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}i+=h*2+1,s+=h*2+1,u-=h,c-=h;var _=new Dp.SceneCanvas({pixelRatio:o,width:i,height:s}),E=new Dp.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),S=new Dp.HitCanvas({pixelRatio:m,width:i,height:s}),P=_.getContext(),N=S.getContext();return S.isCache=!0,_.isCache=!0,this._cache.delete(Na),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(_.getContext()._context.imageSmoothingEnabled=!1,E.getContext()._context.imageSmoothingEnabled=!1),P.save(),N.save(),P.translate(-u,-c),N.translate(-u,-c),this._isUnderCache=!0,this._clearSelfAndDescendantCache(og),this._clearSelfAndDescendantCache(x3),this.drawScene(_,this),this.drawHit(S,this),this._isUnderCache=!1,P.restore(),N.restore(),p&&(P.save(),P.beginPath(),P.rect(0,0,i,s),P.closePath(),P.setAttr("strokeStyle","red"),P.setAttr("lineWidth",5),P.stroke(),P.restore()),this._cache.set(Na,{scene:_,filter:E,hit:S,x:u,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(Na)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){var r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],i=1/0,s=1/0,o=-1/0,u=-1/0,c=this.getAbsoluteTransform(n);return r.forEach(function(h){var p=c.point(h);i===void 0&&(i=o=p.x,s=u=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),u=Math.max(u,p.y)}),{x:i,y:s,width:o-i,height:u-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);var r=this._getCachedSceneCanvas(),i=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/i,r.height/i),e.restore()}_drawCachedHitCanvas(e){var n=this._getCanvasCache(),r=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e=this.filters(),n=this._getCanvasCache(),r=n.scene,i=n.filter,s=i.getContext(),o,u,c,h;if(e){if(!this._filterUpToDate){var p=r.pixelRatio;i.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(r._canvas,0,0,r.getWidth()/p,r.getHeight()/p),u=s.getImageData(0,0,i.getWidth(),i.getHeight()),c=0;c<o;c++){if(h=e[c],typeof h!="function"){qe.Util.error("Filter should be type of function, but got "+typeof h+" instead. Please check correct filters");continue}h.call(this,u),s.putImageData(u,0,0)}}catch(m){qe.Util.error("Unable to apply filter. "+m.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return r}on(e,n){if(this._cache&&this._cache.delete(Op),arguments.length===3)return this._delegate.apply(this,arguments);var r=e.split(ag),i=r.length,s,o,u,c,h;for(s=0;s<i;s++)o=r[s],u=o.split("."),c=u[0],h=u[1]||"",this.eventListeners[c]||(this.eventListeners[c]=[]),this.eventListeners[c].push({name:h,handler:n});return this}off(e,n){var r=(e||"").split(ag),i=r.length,s,o,u,c,h,p;if(this._cache&&this._cache.delete(Op),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<i;s++)if(u=r[s],c=u.split("."),h=c[0],p=c[1],h)this.eventListeners[h]&&this._off(h,p,n);else for(o in this.eventListeners)this._off(o,p,n);return this}dispatchEvent(e){var n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(r){n.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,r){var i=this;this.on(e,function(s){for(var o=s.target.findAncestors(n,!0,i),u=0;u<o.length;u++)s=qe.Util.cloneObject(s),s.currentTarget=o[u],r.call(o[u],s)})}remove(){return this.isDragging()&&this.stopDrag(),Yr.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Cs),this._clearSelfAndDescendantCache(og),this._clearSelfAndDescendantCache(x3),this._clearSelfAndDescendantCache(L3),this._clearSelfAndDescendantCache(q1),this._clearSelfAndDescendantCache($1)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var n="get"+qe.Util._capitalize(e);return qe.Util._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),n=[];e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var n,r;if(!e)return this;for(n in e)n!==$B&&(r=O3+qe.Util._capitalize(n),qe.Util._isFunction(this[r])?this[r](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache($1,this._isListening)}_isListening(e){if(!this.listening())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isListening(e):!0}isVisible(){return this._getCache(q1,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const r=this.getParent();return r&&r!==e&&this!==e?r._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);var r=this.getLayer(),i=!1;Yr.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(i=!0)});var s=!n&&!xa.Konva.hitOnDragEnabled&&i;return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e=this.getDepth(),n=this,r=0,i,s,o,u;function c(p){for(i=[],s=p.length,o=0;o<s;o++)u=p[o],r++,u.nodeType!==M3&&(i=i.concat(u.getChildren().slice())),u._id===n._id&&(o=s);i.length>0&&i[0].getDepth()<=e&&c(i)}const h=this.getStage();return n.nodeType!==KB&&h&&c(h.getChildren()),r}getDepth(){for(var e=0,n=this.parent;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(yo),this._clearSelfAndDescendantCache(Cs)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;var n=e.getPointerPosition();if(!n)return null;var r=this.getAbsoluteTransform().copy();return r.invert(),r.point(n)}getAbsolutePosition(e){let n=!1,r=this.parent;for(;r;){if(r.isCached()){n=!0;break}r=r.parent}n&&!e&&(e=!0);var i=this.getAbsoluteTransform(e).getMatrix(),s=new qe.Transform,o=this.offset();return s.m=i.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){const{x:n,y:r,...i}=this._clearTransform();this.attrs.x=n,this.attrs.y=r,this._clearCache(yo);var s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(yo),this._clearSelfAndDescendantCache(Cs),this}_setTransform(e){var n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var n=e.x,r=e.y,i=this.x(),s=this.y();return n!==void 0&&(i+=n),r!==void 0&&(s+=r),this.setPosition({x:i,y:s}),this}_eachAncestorReverse(e,n){var r=[],i=this.getParent(),s,o;if(!(n&&n._id===this._id)){for(r.unshift(this);i&&(!n||i._id!==n._id);)r.unshift(i),i=i.parent;for(s=r.length,o=0;o<s;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return qe.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return qe.Util.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return qe.Util.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return qe.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return qe.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&qe.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(og,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e={},n=this.getAttrs(),r,i,s,o,u;e.attrs={};for(r in n)i=n[r],u=qe.Util.isObject(i)&&!qe.Util._isPlainObject(i)&&!qe.Util._isArray(i),!u&&(s=typeof this[r]=="function"&&this[r],delete n[r],o=s?s.call(this):null,n[r]=i,o!==i&&(e.attrs[r]=i));return e.className=this.getClassName(),qe.Util._prepareToStringify(e)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,r){var i=[];n&&this._isMatch(e)&&i.push(this);for(var s=this.parent;s;){if(s===r)return i;s._isMatch(e)&&i.push(s),s=s.parent}return i}isAncestorOf(e){return!1}findAncestor(e,n,r){return this.findAncestors(e,n,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);var n=e.replace(/ /g,"").split(","),r=n.length,i,s;for(i=0;i<r;i++)if(s=n[i],qe.Util.isValidSelector(s)||(qe.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),qe.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),qe.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(L3,this._getStage)}_getStage(){var e=this.getParent();return e?e.getStage():null}fire(e,n={},r){return n.target=n.target||this,r?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Cs,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var n;if(e)return n=new qe.Transform,this._eachAncestorReverse(function(i){var s=i.transformsEnabled();s==="all"?n.multiply(i.getTransform()):s==="position"&&n.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},e),n;n=this._cache.get(Cs)||new qe.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();var r=this.transformsEnabled();if(r==="all")n.multiply(this.getTransform());else if(r==="position"){const i=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,u=this.attrs.offsetY||0;n.translate(i-o,s-u)}return n.dirty=!1,n}getAbsoluteScale(e){for(var n=this;n;)n._isUnderCache&&(e=n),n=n.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(yo,this._getTransform)}_getTransform(){var e,n,r=this._cache.get(yo)||new qe.Transform;r.reset();var i=this.x(),s=this.y(),o=xa.Konva.getAngle(this.rotation()),u=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,c=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,h=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,_=this.attrs.offsetY||0;return(i!==0||s!==0)&&r.translate(i,s),o!==0&&r.rotate(o),(h!==0||p!==0)&&r.skew(h,p),(u!==1||c!==1)&&r.scale(u,c),(m!==0||_!==0)&&r.translate(-1*m,-1*_),r.dirty=!1,r}clone(e){var n=qe.Util.cloneObject(this.attrs),r,i,s,o,u;for(r in e)n[r]=e[r];var c=new this.constructor(n);for(r in this.eventListeners)for(i=this.eventListeners[r],s=i.length,o=0;o<s;o++)u=i[o],u.name.indexOf(qB)<0&&(c.eventListeners[r]||(c.eventListeners[r]=[]),c.eventListeners[r].push(u));return c}_toKonvaCanvas(e){e=e||{};var n=this.getClientRect(),r=this.getStage(),i=e.x!==void 0?e.x:Math.floor(n.x),s=e.y!==void 0?e.y:Math.floor(n.y),o=e.pixelRatio||1,u=new Dp.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:o}),c=u.getContext();return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||s)&&c.translate(-1*i,-1*s),this.drawScene(u),c.restore(),u}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};var n=e.mimeType||null,r=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(n,r);return e.callback&&e.callback(i),i}toImage(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,qe.Util._urlToImage(this.toDataURL(e),function(s){n(s),i==null||i(s)})}catch(i){r(i)}})}toBlob(e){return new Promise((n,r)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(s=>{n(s),i==null||i(s)})}catch(i){r(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():xa.Konva.dragDistance}_off(e,n,r){var i=this.eventListeners[e],s,o,u;for(s=0;s<i.length;s++)if(o=i[s].name,u=i[s].handler,(o!=="konva"||n==="konva")&&(!n||o===n)&&(!r||r===u)){if(i.splice(s,1),i.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,n,r){this._fire(e+HB,{oldVal:n,newVal:r})}addName(e){if(!this.hasName(e)){var n=this.name(),r=n?n+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const n=this.name();if(!n)return!1;var r=(n||"").split(/\s/g);return r.indexOf(e)!==-1}removeName(e){var n=(this.name()||"").split(/\s/g),r=n.indexOf(e);return r!==-1&&(n.splice(r,1),this.name(n.join(" "))),this}setAttr(e,n){var r=this[O3+qe.Util._capitalize(e)];return qe.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(xa.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){var r=this.attrs[e];r===n&&!qe.Util.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,n),this._requestDraw())}_setComponentAttr(e,n,r){var i;r!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=r,this._fireChangeEvent(e,i,r))}_fireAndBubble(e,n,r){n&&this.nodeType===M3&&(n.target=this);var i=(e===N3||e===D3)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r);if(!i){this._fire(e,n);var s=(e===N3||e===D3)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!s&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,n,r):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,r,i;const s=(n=this._cache.get(Op))!==null&&n!==void 0?n:{};let o=s==null?void 0:s[e];if(o===void 0){o=[];let u=Object.getPrototypeOf(this);for(;u;){const c=(i=(r=u.eventListeners)===null||r===void 0?void 0:r[e])!==null&&i!==void 0?i:[];o.push(...c),u=Object.getPrototypeOf(u)}s[e]=o,this._cache.set(Op,s)}return o}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const r=this._getProtoListeners(e);if(r)for(var i=0;i<r.length;i++)r[i].handler.call(this,n);const s=this.eventListeners[e];if(s)for(var i=0;i<s.length;i++)s[i].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var n=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(r){var s=r._getPointerById(n)||r._changedPointerPositions[0]||i;Yr.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-i.x,y:s.y-i.y},dragStatus:"ready",pointerId:n})}}startDrag(e,n=!0){Yr.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Yr.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const r=this.getStage()._getPointerById(n.pointerId);if(r){var i={x:r.x-n.offset.x,y:r.y-n.offset.y},s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,i,e);o?i=o:qe.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}}stopDrag(e){const n=Yr.DD._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Yr.DD._endDragBefore(e),Yr.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Yr.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){var n=e.evt.button!==void 0,r=!n||xa.Konva.dragButtons.indexOf(e.evt.button)>=0;if(r&&!this.isDragging()){var i=!1;Yr.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(i=!0)}),i||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage();if(!e)return;const n=Yr.DD._dragElements.get(this._id),r=n&&n.dragStatus==="dragging",i=n&&n.dragStatus==="ready";r?this.stopDrag():i&&Yr.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const r={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return qe.Util.haveIntersection(r,this.getClientRect())}static create(e,n){return qe.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){var r=xe.prototype.getClassName.call(e),i=e.children,s,o,u;n&&(e.attrs.container=n),xa.Konva[r]||(qe.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const c=xa.Konva[r];if(s=new c(e.attrs),i)for(o=i.length,u=0;u<o;u++)s.add(xe._createNode(i[u]));return s}}At.Node=xe;xe.prototype.nodeType="Node";xe.prototype._attrsAffectingSize=[];xe.prototype.eventListeners={};xe.prototype.on.call(xe.prototype,QB,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(yo),this._clearSelfAndDescendantCache(Cs)});xe.prototype.on.call(xe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(q1)});xe.prototype.on.call(xe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache($1)});xe.prototype.on.call(xe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(og)});const vt=Jd.Factory.addGetterSetter;vt(xe,"zIndex");vt(xe,"absolutePosition");vt(xe,"position");vt(xe,"x",0,(0,qt.getNumberValidator)());vt(xe,"y",0,(0,qt.getNumberValidator)());vt(xe,"globalCompositeOperation","source-over",(0,qt.getStringValidator)());vt(xe,"opacity",1,(0,qt.getNumberValidator)());vt(xe,"name","",(0,qt.getStringValidator)());vt(xe,"id","",(0,qt.getStringValidator)());vt(xe,"rotation",0,(0,qt.getNumberValidator)());Jd.Factory.addComponentsGetterSetter(xe,"scale",["x","y"]);vt(xe,"scaleX",1,(0,qt.getNumberValidator)());vt(xe,"scaleY",1,(0,qt.getNumberValidator)());Jd.Factory.addComponentsGetterSetter(xe,"skew",["x","y"]);vt(xe,"skewX",0,(0,qt.getNumberValidator)());vt(xe,"skewY",0,(0,qt.getNumberValidator)());Jd.Factory.addComponentsGetterSetter(xe,"offset",["x","y"]);vt(xe,"offsetX",0,(0,qt.getNumberValidator)());vt(xe,"offsetY",0,(0,qt.getNumberValidator)());vt(xe,"dragDistance",null,(0,qt.getNumberValidator)());vt(xe,"width",0,(0,qt.getNumberValidator)());vt(xe,"height",0,(0,qt.getNumberValidator)());vt(xe,"listening",!0,(0,qt.getBooleanValidator)());vt(xe,"preventDefault",!0,(0,qt.getBooleanValidator)());vt(xe,"filters",null,function(t){return this._filterUpToDate=!1,t});vt(xe,"visible",!0,(0,qt.getBooleanValidator)());vt(xe,"transformsEnabled","all",(0,qt.getStringValidator)());vt(xe,"size");vt(xe,"dragBoundFunc");vt(xe,"draggable",!1,(0,qt.getBooleanValidator)());Jd.Factory.backCompat(xe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.Container=void 0;const dc=Ue,Zv=At,_0=Ee;class gl extends Zv.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[];var r=[];return n.forEach(function(i){e(i)&&r.push(i)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(var n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){var r=[];return this._descendants(i=>{const s=i._isMatch(e);return s&&r.push(i),!!(s&&n)}),r}_descendants(e){let n=!1;const r=this.getChildren();for(const i of r){if(n=e(i),n)return!0;if(i.hasChildren()&&(n=i._descendants(e),n))return!0}return!1}toObject(){var e=Zv.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){for(var n=e.getParent();n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){var n=Zv.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){n.add(r.clone())}),n}getAllIntersections(e){var n=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&n.push(r)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,r){n.index=r}),this._requestDraw()}drawScene(e,n){var r=this.getLayer(),i=e||r&&r.getCanvas(),s=i&&i.getContext(),o=this._getCanvasCache(),u=o&&o.scene,c=i&&i.isCache;if(!this.isVisible()&&!c)return this;if(u){s.save();var h=this.getAbsoluteTransform(n).getMatrix();s.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",i,n);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;var r=this.getLayer(),i=e||r&&r.hitCanvas,s=i&&i.getContext(),o=this._getCanvasCache(),u=o&&o.hit;if(u){s.save();var c=this.getAbsoluteTransform(n).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",i,n);return this}_drawChildren(e,n,r){var i,s=n&&n.getContext(),o=this.clipWidth(),u=this.clipHeight(),c=this.clipFunc(),h=o&&u||c;const p=r===this;if(h){s.save();var m=this.getAbsoluteTransform(r),_=m.getMatrix();s.transform(_[0],_[1],_[2],_[3],_[4],_[5]),s.beginPath();let N;if(c)N=c.call(this,s,this);else{var E=this.clipX(),S=this.clipY();s.rect(E,S,o,u)}s.clip.apply(s,N),_=m.copy().invert().getMatrix(),s.transform(_[0],_[1],_[2],_[3],_[4],_[5])}var P=!p&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";P&&(s.save(),s._applyGlobalCompositeOperation(this)),(i=this.children)===null||i===void 0||i.forEach(function(N){N[e](n,r)}),P&&s.restore(),h&&s.restore()}getClientRect(e={}){var n,r=e.skipTransform,i=e.relativeTo,s,o,u,c,h={x:1/0,y:1/0,width:0,height:0},p=this;(n=this.children)===null||n===void 0||n.forEach(function(P){if(P.visible()){var N=P.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});N.width===0&&N.height===0||(s===void 0?(s=N.x,o=N.y,u=N.x+N.width,c=N.y+N.height):(s=Math.min(s,N.x),o=Math.min(o,N.y),u=Math.max(u,N.x+N.width),c=Math.max(c,N.y+N.height)))}});for(var m=this.find("Shape"),_=!1,E=0;E<m.length;E++){var S=m[E];if(S._isVisible(this)){_=!0;break}}return _&&s!==void 0?h={x:s,y:o,width:u-s,height:c-o}:h={x:0,y:0,width:0,height:0},r?h:this._transformedRect(h,i)}}pl.Container=gl;dc.Factory.addComponentsGetterSetter(gl,"clip",["x","y","width","height"]);dc.Factory.addGetterSetter(gl,"clipX",void 0,(0,_0.getNumberValidator)());dc.Factory.addGetterSetter(gl,"clipY",void 0,(0,_0.getNumberValidator)());dc.Factory.addGetterSetter(gl,"clipWidth",void 0,(0,_0.getNumberValidator)());dc.Factory.addGetterSetter(gl,"clipHeight",void 0,(0,_0.getNumberValidator)());dc.Factory.addGetterSetter(gl,"clipFunc");var pR={},Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.releaseCapture=Mr.setPointerCapture=Mr.hasPointerCapture=Mr.createEvent=Mr.getCapturedShape=void 0;const XB=Ve,Pd=new Map,gR=XB.Konva._global.PointerEvent!==void 0;function JB(t){return Pd.get(t)}Mr.getCapturedShape=JB;function DE(t){return{evt:t,pointerId:t.pointerId}}Mr.createEvent=DE;function ZB(t,e){return Pd.get(t)===e}Mr.hasPointerCapture=ZB;function ej(t,e){mR(t),e.getStage()&&(Pd.set(t,e),gR&&e._fire("gotpointercapture",DE(new PointerEvent("gotpointercapture"))))}Mr.setPointerCapture=ej;function mR(t,e){const n=Pd.get(t);if(!n)return;const r=n.getStage();r&&r.content,Pd.delete(t),gR&&n._fire("lostpointercapture",DE(new PointerEvent("lostpointercapture")))}Mr.releaseCapture=mR;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Lt,n=Ue,r=pl,i=Ve,s=Pi,o=m0,u=Ve,c=Mr;var h="Stage",p="string",m="px",_="mouseout",E="mouseleave",S="mouseover",P="mouseenter",N="mousemove",R="mousedown",k="mouseup",w="pointermove",A="pointerdown",V="pointerup",U="pointercancel",O="lostpointercapture",C="pointerout",D="pointerleave",x="pointerover",M="pointerenter",z="contextmenu",b="touchstart",oe="touchend",ye="touchmove",Te="touchcancel",Pe="wheel",J=5,ue=[[P,"_pointerenter"],[R,"_pointerdown"],[N,"_pointermove"],[k,"_pointerup"],[E,"_pointerleave"],[b,"_pointerdown"],[ye,"_pointermove"],[oe,"_pointerup"],[Te,"_pointercancel"],[S,"_pointerover"],[Pe,"_wheel"],[z,"_contextmenu"],[A,"_pointerdown"],[w,"_pointermove"],[V,"_pointerup"],[U,"_pointercancel"],[O,"_lostpointercapture"]];const te={mouse:{[C]:_,[D]:E,[x]:S,[M]:P,[w]:N,[A]:R,[V]:k,[U]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[D]:"touchleave",[x]:"touchover",[M]:"touchenter",[w]:ye,[A]:b,[V]:oe,[U]:Te,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[D]:D,[x]:x,[M]:M,[w]:w,[A]:A,[V]:V,[U]:U,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},le=ut=>ut.indexOf("pointer")>=0?"pointer":ut.indexOf("touch")>=0?"touch":"mouse",_e=ut=>{const B=le(ut);if(B==="pointer")return i.Konva.pointerEventsEnabled&&te.pointer;if(B==="touch")return te.touch;if(B==="mouse")return te.mouse};function Ce(ut={}){return(ut.clipFunc||ut.clipWidth||ut.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ut}const Le="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class yt extends r.Container{constructor(B){super(Ce(B)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Ce(this.attrs)}),this._checkVisibility()}_validateAdd(B){const Y=B.getType()==="Layer",re=B.getType()==="FastLayer";Y||re||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const B=this.visible()?"":"none";this.content.style.display=B}setContainer(B){if(typeof B===p){if(B.charAt(0)==="."){var Y=B.slice(1);B=document.getElementsByClassName(Y)[0]}else{var re;B.charAt(0)!=="#"?re=B:re=B.slice(1),B=document.getElementById(re)}if(!B)throw"Can not find container in document with id "+re}return this._setAttr("container",B),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),B.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var B=this.children,Y=B.length,re;for(re=0;re<Y;re++)B[re].clear();return this}clone(B){return B||(B={}),B.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,B)}destroy(){super.destroy();var B=this.content;B&&e.Util._isInDocument(B)&&this.container().removeChild(B);var Y=t.stages.indexOf(this);return Y>-1&&t.stages.splice(Y,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const B=this._pointerPositions[0]||this._changedPointerPositions[0];return B?{x:B.x,y:B.y}:(e.Util.warn(Le),null)}_getPointerById(B){return this._pointerPositions.find(Y=>Y.id===B)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(B){B=B||{},B.x=B.x||0,B.y=B.y||0,B.width=B.width||this.width(),B.height=B.height||this.height();var Y=new s.SceneCanvas({width:B.width,height:B.height,pixelRatio:B.pixelRatio||1}),re=Y.getContext()._context,ve=this.children;return(B.x||B.y)&&re.translate(-1*B.x,-1*B.y),ve.forEach(function(de){if(de.isVisible()){var be=de._toKonvaCanvas(B);re.drawImage(be._canvas,B.x,B.y,be.getWidth()/be.getPixelRatio(),be.getHeight()/be.getPixelRatio())}}),Y}getIntersection(B){if(!B)return null;var Y=this.children,re=Y.length,ve=re-1,de;for(de=ve;de>=0;de--){const be=Y[de].getIntersection(B);if(be)return be}return null}_resizeDOM(){var B=this.width(),Y=this.height();this.content&&(this.content.style.width=B+m,this.content.style.height=Y+m),this.bufferCanvas.setSize(B,Y),this.bufferHitCanvas.setSize(B,Y),this.children.forEach(re=>{re.setSize({width:B,height:Y}),re.draw()})}add(B,...Y){if(arguments.length>1){for(var re=0;re<arguments.length;re++)this.add(arguments[re]);return this}super.add(B);var ve=this.children.length;return ve>J&&e.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),B.setSize({width:this.width(),height:this.height()}),B.draw(),i.Konva.isBrowser&&this.content.appendChild(B.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(B){return c.hasPointerCapture(B,this)}setPointerCapture(B){c.setPointerCapture(B,this)}releaseCapture(B){c.releaseCapture(B,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&ue.forEach(([B,Y])=>{this.content.addEventListener(B,re=>{this[Y](re)},{passive:!1})})}_pointerenter(B){this.setPointersPositions(B);const Y=_e(B.type);Y&&this._fire(Y.pointerenter,{evt:B,target:this,currentTarget:this})}_pointerover(B){this.setPointersPositions(B);const Y=_e(B.type);Y&&this._fire(Y.pointerover,{evt:B,target:this,currentTarget:this})}_getTargetShape(B){let Y=this[B+"targetShape"];return Y&&!Y.getStage()&&(Y=null),Y}_pointerleave(B){const Y=_e(B.type),re=le(B.type);if(Y){this.setPointersPositions(B);var ve=this._getTargetShape(re),de=!o.DD.isDragging||i.Konva.hitOnDragEnabled;ve&&de?(ve._fireAndBubble(Y.pointerout,{evt:B}),ve._fireAndBubble(Y.pointerleave,{evt:B}),this._fire(Y.pointerleave,{evt:B,target:this,currentTarget:this}),this[re+"targetShape"]=null):de&&(this._fire(Y.pointerleave,{evt:B,target:this,currentTarget:this}),this._fire(Y.pointerout,{evt:B,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(B){const Y=_e(B.type),re=le(B.type);if(Y){this.setPointersPositions(B);var ve=!1;this._changedPointerPositions.forEach(de=>{var be=this.getIntersection(de);if(o.DD.justDragged=!1,i.Konva["_"+re+"ListenClick"]=!0,!be||!be.isListening())return;i.Konva.capturePointerEventsEnabled&&be.setPointerCapture(de.id),this[re+"ClickStartShape"]=be,be._fireAndBubble(Y.pointerdown,{evt:B,pointerId:de.id}),ve=!0;const He=B.type.indexOf("touch")>=0;be.preventDefault()&&B.cancelable&&He&&B.preventDefault()}),ve||this._fire(Y.pointerdown,{evt:B,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(B){const Y=_e(B.type),re=le(B.type);if(!Y)return;o.DD.isDragging&&o.DD.node.preventDefault()&&B.cancelable&&B.preventDefault(),this.setPointersPositions(B);var ve=!o.DD.isDragging||i.Konva.hitOnDragEnabled;if(!ve)return;var de={};let be=!1;var He=this._getTargetShape(re);this._changedPointerPositions.forEach(Bt=>{const Xe=c.getCapturedShape(Bt.id)||this.getIntersection(Bt),mr=Bt.id,Pn={evt:B,pointerId:mr};var Br=He!==Xe;if(Br&&He&&(He._fireAndBubble(Y.pointerout,{...Pn},Xe),He._fireAndBubble(Y.pointerleave,{...Pn},Xe)),Xe){if(de[Xe._id])return;de[Xe._id]=!0}Xe&&Xe.isListening()?(be=!0,Br&&(Xe._fireAndBubble(Y.pointerover,{...Pn},He),Xe._fireAndBubble(Y.pointerenter,{...Pn},He),this[re+"targetShape"]=Xe),Xe._fireAndBubble(Y.pointermove,{...Pn})):He&&(this._fire(Y.pointerover,{evt:B,target:this,currentTarget:this,pointerId:mr}),this[re+"targetShape"]=null)}),be||this._fire(Y.pointermove,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(B){const Y=_e(B.type),re=le(B.type);if(!Y)return;this.setPointersPositions(B);const ve=this[re+"ClickStartShape"],de=this[re+"ClickEndShape"];var be={};let He=!1;this._changedPointerPositions.forEach(Bt=>{const Xe=c.getCapturedShape(Bt.id)||this.getIntersection(Bt);if(Xe){if(Xe.releaseCapture(Bt.id),be[Xe._id])return;be[Xe._id]=!0}const mr=Bt.id,Pn={evt:B,pointerId:mr};let Br=!1;i.Konva["_"+re+"InDblClickWindow"]?(Br=!0,clearTimeout(this[re+"DblTimeout"])):o.DD.justDragged||(i.Konva["_"+re+"InDblClickWindow"]=!0,clearTimeout(this[re+"DblTimeout"])),this[re+"DblTimeout"]=setTimeout(function(){i.Konva["_"+re+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Xe&&Xe.isListening()?(He=!0,this[re+"ClickEndShape"]=Xe,Xe._fireAndBubble(Y.pointerup,{...Pn}),i.Konva["_"+re+"ListenClick"]&&ve&&ve===Xe&&(Xe._fireAndBubble(Y.pointerclick,{...Pn}),Br&&de&&de===Xe&&Xe._fireAndBubble(Y.pointerdblclick,{...Pn}))):(this[re+"ClickEndShape"]=null,i.Konva["_"+re+"ListenClick"]&&this._fire(Y.pointerclick,{evt:B,target:this,currentTarget:this,pointerId:mr}),Br&&this._fire(Y.pointerdblclick,{evt:B,target:this,currentTarget:this,pointerId:mr}))}),He||this._fire(Y.pointerup,{evt:B,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+re+"ListenClick"]=!1,B.cancelable&&re!=="touch"&&B.preventDefault()}_contextmenu(B){this.setPointersPositions(B);var Y=this.getIntersection(this.getPointerPosition());Y&&Y.isListening()?Y._fireAndBubble(z,{evt:B}):this._fire(z,{evt:B,target:this,currentTarget:this})}_wheel(B){this.setPointersPositions(B);var Y=this.getIntersection(this.getPointerPosition());Y&&Y.isListening()?Y._fireAndBubble(Pe,{evt:B}):this._fire(Pe,{evt:B,target:this,currentTarget:this})}_pointercancel(B){this.setPointersPositions(B);const Y=c.getCapturedShape(B.pointerId)||this.getIntersection(this.getPointerPosition());Y&&Y._fireAndBubble(V,c.createEvent(B)),c.releaseCapture(B.pointerId)}_lostpointercapture(B){c.releaseCapture(B.pointerId)}setPointersPositions(B){var Y=this._getContentPosition(),re=null,ve=null;B=B||window.event,B.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(B.touches,de=>{this._pointerPositions.push({id:de.identifier,x:(de.clientX-Y.left)/Y.scaleX,y:(de.clientY-Y.top)/Y.scaleY})}),Array.prototype.forEach.call(B.changedTouches||B.touches,de=>{this._changedPointerPositions.push({id:de.identifier,x:(de.clientX-Y.left)/Y.scaleX,y:(de.clientY-Y.top)/Y.scaleY})})):(re=(B.clientX-Y.left)/Y.scaleX,ve=(B.clientY-Y.top)/Y.scaleY,this.pointerPos={x:re,y:ve},this._pointerPositions=[{x:re,y:ve,id:e.Util._getFirstPointerId(B)}],this._changedPointerPositions=[{x:re,y:ve,id:e.Util._getFirstPointerId(B)}])}_setPointerPosition(B){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(B)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var B=this.content.getBoundingClientRect();return{top:B.top,left:B.left,scaleX:B.width/this.content.clientWidth||1,scaleY:B.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!i.Konva.isBrowser){var B=this.container();if(!B)throw"Stage has no container. A container is required.";B.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),B.appendChild(this.content),this._resizeDOM()}}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(B){B.batchDraw()}),this}}t.Stage=yt,yt.prototype.nodeType=h,(0,u._registerNode)(yt),n.Factory.addGetterSetter(yt,"container")})(pR);var Zd={},hn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=Ve,n=Lt,r=Ue,i=At,s=Ee,o=Ve,u=Mr;var c="hasShadow",h="shadowRGBA",p="patternImage",m="linearGradient",_="radialGradient";let E;function S(){return E||(E=n.Util.createCanvasElement().getContext("2d"),E)}t.shapes={};function P(D){const x=this.attrs.fillRule;x?D.fill(x):D.fill()}function N(D){D.stroke()}function R(D){D.fill()}function k(D){D.stroke()}function w(){this._clearCache(c)}function A(){this._clearCache(h)}function V(){this._clearCache(p)}function U(){this._clearCache(m)}function O(){this._clearCache(_)}class C extends i.Node{constructor(x){super(x);let M;for(;M=n.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(p,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var x=S();const M=x.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const z=new n.Transform;z.translate(this.fillPatternX(),this.fillPatternY()),z.rotate(e.Konva.getAngle(this.fillPatternRotation())),z.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),z.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const b=z.getMatrix(),oe=typeof DOMMatrix>"u"?{a:b[0],b:b[1],c:b[2],d:b[3],e:b[4],f:b[5]}:new DOMMatrix(b);M.setTransform(oe)}return M}}_getLinearGradient(){return this._getCache(m,this.__getLinearGradient)}__getLinearGradient(){var x=this.fillLinearGradientColorStops();if(x){for(var M=S(),z=this.fillLinearGradientStartPoint(),b=this.fillLinearGradientEndPoint(),oe=M.createLinearGradient(z.x,z.y,b.x,b.y),ye=0;ye<x.length;ye+=2)oe.addColorStop(x[ye],x[ye+1]);return oe}}_getRadialGradient(){return this._getCache(_,this.__getRadialGradient)}__getRadialGradient(){var x=this.fillRadialGradientColorStops();if(x){for(var M=S(),z=this.fillRadialGradientStartPoint(),b=this.fillRadialGradientEndPoint(),oe=M.createRadialGradient(z.x,z.y,this.fillRadialGradientStartRadius(),b.x,b.y,this.fillRadialGradientEndRadius()),ye=0;ye<x.length;ye+=2)oe.addColorStop(x[ye],x[ye+1]);return oe}}getShadowRGBA(){return this._getCache(h,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var x=n.Util.colorToRGBA(this.shadowColor());if(x)return"rgba("+x.r+","+x.g+","+x.b+","+x.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const x=this.hitStrokeWidth();return x==="auto"?this.hasStroke():this.strokeEnabled()&&!!x}intersects(x){var M=this.getStage();if(!M)return!1;const z=M.bufferHitCanvas;return z.getContext().clear(),this.drawHit(z,void 0,!0),z.context.getImageData(Math.round(x.x),Math.round(x.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(x){var M;if(!this.getStage()||!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const b=x||this.hasFill(),oe=this.hasStroke(),ye=this.getAbsoluteOpacity()!==1;if(b&&oe&&ye)return!0;const Te=this.hasShadow(),Pe=this.shadowForStrokeEnabled();return!!(b&&oe&&Te&&Pe)}setStrokeHitEnabled(x){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),x?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var x=this.size();return{x:this._centroid?-x.width/2:0,y:this._centroid?-x.height/2:0,width:x.width,height:x.height}}getClientRect(x={}){const M=x.skipTransform,z=x.relativeTo,b=this.getSelfRect(),ye=!x.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Te=b.width+ye,Pe=b.height+ye,J=!x.skipShadow&&this.hasShadow(),ue=J?this.shadowOffsetX():0,te=J?this.shadowOffsetY():0,le=Te+Math.abs(ue),_e=Pe+Math.abs(te),Ce=J&&this.shadowBlur()||0,Le=le+Ce*2,yt=_e+Ce*2,ut={width:Le,height:yt,x:-(ye/2+Ce)+Math.min(ue,0)+b.x,y:-(ye/2+Ce)+Math.min(te,0)+b.y};return M?ut:this._transformedRect(ut,z)}drawScene(x,M){var z=this.getLayer(),b=x||z.getCanvas(),oe=b.getContext(),ye=this._getCanvasCache(),Te=this.getSceneFunc(),Pe=this.hasShadow(),J,ue,te,le=b.isCache,_e=M===this;if(!this.isVisible()&&!_e)return this;if(ye){oe.save();var Ce=this.getAbsoluteTransform(M).getMatrix();return oe.transform(Ce[0],Ce[1],Ce[2],Ce[3],Ce[4],Ce[5]),this._drawCachedSceneCanvas(oe),oe.restore(),this}if(!Te)return this;if(oe.save(),this._useBufferCanvas()&&!le){J=this.getStage(),ue=J.bufferCanvas,te=ue.getContext(),te.clear(),te.save(),te._applyLineJoin(this);var Le=this.getAbsoluteTransform(M).getMatrix();te.transform(Le[0],Le[1],Le[2],Le[3],Le[4],Le[5]),Te.call(this,te,this),te.restore();var yt=ue.pixelRatio;Pe&&oe._applyShadow(this),oe._applyOpacity(this),oe._applyGlobalCompositeOperation(this),oe.drawImage(ue._canvas,0,0,ue.width/yt,ue.height/yt)}else{if(oe._applyLineJoin(this),!_e){var Le=this.getAbsoluteTransform(M).getMatrix();oe.transform(Le[0],Le[1],Le[2],Le[3],Le[4],Le[5]),oe._applyOpacity(this),oe._applyGlobalCompositeOperation(this)}Pe&&oe._applyShadow(this),Te.call(this,oe,this)}return oe.restore(),this}drawHit(x,M,z=!1){if(!this.shouldDrawHit(M,z))return this;var b=this.getLayer(),oe=x||b.hitCanvas,ye=oe&&oe.getContext(),Te=this.hitFunc()||this.sceneFunc(),Pe=this._getCanvasCache(),J=Pe&&Pe.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),J){ye.save();var ue=this.getAbsoluteTransform(M).getMatrix();return ye.transform(ue[0],ue[1],ue[2],ue[3],ue[4],ue[5]),this._drawCachedHitCanvas(ye),ye.restore(),this}if(!Te)return this;if(ye.save(),ye._applyLineJoin(this),!(this===M)){var le=this.getAbsoluteTransform(M).getMatrix();ye.transform(le[0],le[1],le[2],le[3],le[4],le[5])}return Te.call(this,ye,this),ye.restore(),this}drawHitFromCache(x=0){var M=this._getCanvasCache(),z=this._getCachedSceneCanvas(),b=M.hit,oe=b.getContext(),ye=b.getWidth(),Te=b.getHeight(),Pe,J,ue,te,le,_e;oe.clear(),oe.drawImage(z._canvas,0,0,ye,Te);try{for(Pe=oe.getImageData(0,0,ye,Te),J=Pe.data,ue=J.length,te=n.Util._hexToRgb(this.colorKey),le=0;le<ue;le+=4)_e=J[le+3],_e>x?(J[le]=te.r,J[le+1]=te.g,J[le+2]=te.b,J[le+3]=255):J[le+3]=0;oe.putImageData(Pe,0,0)}catch(Ce){n.Util.error("Unable to draw hit graph from cached scene canvas. "+Ce.message)}return this}hasPointerCapture(x){return u.hasPointerCapture(x,this)}setPointerCapture(x){u.setPointerCapture(x,this)}releaseCapture(x){u.releaseCapture(x,this)}}t.Shape=C,C.prototype._fillFunc=P,C.prototype._strokeFunc=N,C.prototype._fillFuncHit=R,C.prototype._strokeFuncHit=k,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",A),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",V),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",U),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",O),r.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),r.Factory.addGetterSetter(C,"lineJoin"),r.Factory.addGetterSetter(C,"lineCap"),r.Factory.addGetterSetter(C,"sceneFunc"),r.Factory.addGetterSetter(C,"hitFunc"),r.Factory.addGetterSetter(C,"dash"),r.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),r.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternImage"),r.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),r.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(C,"fillEnabled",!0),r.Factory.addGetterSetter(C,"strokeEnabled",!0),r.Factory.addGetterSetter(C,"shadowEnabled",!0),r.Factory.addGetterSetter(C,"dashEnabled",!0),r.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(C,"fillPriority","color"),r.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),r.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(C,"fillPatternRotation",0),r.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),r.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(hn);Object.defineProperty(Zd,"__esModule",{value:!0});Zd.Layer=void 0;const Ss=Lt,ey=pl,ql=At,OE=Ue,b3=Pi,tj=Ee,nj=hn,rj=Ve;var ij="#",sj="beforeDraw",oj="draw",_R=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],aj=_R.length;let fc=class extends ey.Container{constructor(e){super(e),this.canvas=new b3.SceneCanvas,this.hitCanvas=new b3.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);var n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){ql.Node.prototype.moveToTop.call(this);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var e=ql.Node.prototype.moveUp.call(this);if(!e)return!1;var n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(ql.Node.prototype.moveDown.call(this)){var e=this.getStage();if(e){var n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(ql.Node.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var e=this.getNativeCanvasElement();return ql.Node.prototype.remove.call(this),e&&e.parentNode&&Ss.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&Ss.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),ql.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Ss.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Ss.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Ss.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;for(var n=1,r=!1;;){for(let i=0;i<aj;i++){const s=_R[i],o=this._getIntersection({x:e.x+s.x*n,y:e.y+s.y*n}),u=o.shape;if(u)return u;if(r=!!o.antialiased,!o.antialiased)break}if(r)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,i=r[3];if(i===255){const s=Ss.Util._rgbToHex(r[0],r[1],r[2]),o=nj.shapes[ij+s];return o?{shape:o}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,n){var r=this.getLayer(),i=e||r&&r.getCanvas();return this._fire(sj,{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),ey.Container.prototype.drawScene.call(this,i,n),this._fire(oj,{node:this}),this}drawHit(e,n){var r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),ey.Container.prototype.drawHit.call(this,i,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Ss.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Ss.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var e=this.parent,n=!!this.hitCanvas._canvas.parentNode;n?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}}destroy(){return Ss.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Zd.Layer=fc;fc.prototype.nodeType="Layer";(0,rj._registerNode)(fc);OE.Factory.addGetterSetter(fc,"imageSmoothingEnabled",!0);OE.Factory.addGetterSetter(fc,"clearBeforeDraw",!0);OE.Factory.addGetterSetter(fc,"hitGraphEnabled",!0,(0,tj.getBooleanValidator)());var v0={};Object.defineProperty(v0,"__esModule",{value:!0});v0.FastLayer=void 0;const lj=Lt,uj=Zd,cj=Ve;class ME extends uj.Layer{constructor(e){super(e),this.listening(!1),lj.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}v0.FastLayer=ME;ME.prototype.nodeType="FastLayer";(0,cj._registerNode)(ME);var pc={};Object.defineProperty(pc,"__esModule",{value:!0});pc.Group=void 0;const hj=Lt,dj=pl,fj=Ve;class LE extends dj.Container{_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&hj.Util.throw("You may only add groups and shapes to groups.")}}pc.Group=LE;LE.prototype.nodeType="Group";(0,fj._registerNode)(LE);var gc={};Object.defineProperty(gc,"__esModule",{value:!0});gc.Animation=void 0;const ty=Ve,F3=Lt,ny=function(){return ty.glob.performance&&ty.glob.performance.now?function(){return ty.glob.performance.now()}:function(){return new Date().getTime()}}();class Ki{constructor(e,n){this.id=Ki.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:ny(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,r=n.length;for(let i=0;i<r;i++)if(n[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const n=Ki.animations,r=n.length;for(let i=0;i<r;i++)if(n[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=ny(),Ki._addAnimation(this),this}stop(){return Ki._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,r=this.animations,i=r.length;for(let s=0;s<i;s++)if(r[s].id===n){this.animations.splice(s,1);break}}static _runFrames(){const e={},n=this.animations;for(let r=0;r<n.length;r++){const i=n[r],s=i.layers,o=i.func;i._updateFrameObject(ny());const u=s.length;let c;if(o?c=o.call(i,i.frame)!==!1:c=!0,!!c)for(let h=0;h<u;h++){const p=s[h];p._id!==void 0&&(e[p._id]=p)}}for(let r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=Ki;e.animations.length?(e._runFrames(),F3.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,F3.Util.requestAnimFrame(this._animationLoop))}}gc.Animation=Ki;Ki.animations=[];Ki.animIdCounter=0;Ki.animRunning=!1;var vR={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Lt,n=gc,r=At,i=Ve;var s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,u=2,c=3,h=0,p=["fill","stroke","shadowColor"];class m{constructor(S,P,N,R,k,w,A){this.prop=S,this.propFunc=P,this.begin=R,this._pos=R,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=A,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=N,this._change=k-this.begin,this.pause()}fire(S){var P=this[S];P&&P()}setTime(S){S>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():S<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=S,this.update())}getTime(){return this._time}setPosition(S){this.prevPos=this._pos,this.propFunc(S),this._pos=S}getPosition(S){return S===void 0&&(S=this._time),this.func(S,this.begin,this._change,this.duration)}play(){this.state=u,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(S){this.pause(),this._time=S,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var S=this.getTimer()-this._startTime;this.state===u?this.setTime(S):this.state===c&&this.setTime(this.duration-S)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class _{constructor(S){var P=this,N=S.node,R=N._id,k,w=S.easing||t.Easings.Linear,A=!!S.yoyo,V;typeof S.duration>"u"?k=.3:S.duration===0?k=.001:k=S.duration,this.node=N,this._id=h++;var U=N.getLayer()||(N instanceof i.Konva.Stage?N.getLayers():null);U||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){P.tween.onEnterFrame()},U),this.tween=new m(V,function(O){P._tweenFunc(O)},w,0,1,k*1e3,A),this._addListeners(),_.attrs[R]||(_.attrs[R]={}),_.attrs[R][this._id]||(_.attrs[R][this._id]={}),_.tweens[R]||(_.tweens[R]={});for(V in S)s[V]===void 0&&this._addAttr(V,S[V]);this.reset(),this.onFinish=S.onFinish,this.onReset=S.onReset,this.onUpdate=S.onUpdate}_addAttr(S,P){var N=this.node,R=N._id,k,w,A,V,U,O,C,D;if(A=_.tweens[R][S],A&&delete _.attrs[R][A][S],k=N.getAttr(S),e.Util._isArray(P))if(w=[],U=Math.max(P.length,k.length),S==="points"&&P.length!==k.length&&(P.length>k.length?(C=k,k=e.Util._prepareArrayForTween(k,P,N.closed())):(O=P,P=e.Util._prepareArrayForTween(P,k,N.closed()))),S.indexOf("fill")===0)for(V=0;V<U;V++)if(V%2===0)w.push(P[V]-k[V]);else{var x=e.Util.colorToRGBA(k[V]);D=e.Util.colorToRGBA(P[V]),k[V]=x,w.push({r:D.r-x.r,g:D.g-x.g,b:D.b-x.b,a:D.a-x.a})}else for(V=0;V<U;V++)w.push(P[V]-k[V]);else p.indexOf(S)!==-1?(k=e.Util.colorToRGBA(k),D=e.Util.colorToRGBA(P),w={r:D.r-k.r,g:D.g-k.g,b:D.b-k.b,a:D.a-k.a}):w=P-k;_.attrs[R][this._id][S]={start:k,diff:w,end:P,trueEnd:O,trueStart:C},_.tweens[R][S]=this._id}_tweenFunc(S){var P=this.node,N=_.attrs[P._id][this._id],R,k,w,A,V,U,O,C;for(R in N){if(k=N[R],w=k.start,A=k.diff,C=k.end,e.Util._isArray(w))if(V=[],O=Math.max(w.length,C.length),R.indexOf("fill")===0)for(U=0;U<O;U++)U%2===0?V.push((w[U]||0)+A[U]*S):V.push("rgba("+Math.round(w[U].r+A[U].r*S)+","+Math.round(w[U].g+A[U].g*S)+","+Math.round(w[U].b+A[U].b*S)+","+(w[U].a+A[U].a*S)+")");else for(U=0;U<O;U++)V.push((w[U]||0)+A[U]*S);else p.indexOf(R)!==-1?V="rgba("+Math.round(w.r+A.r*S)+","+Math.round(w.g+A.g*S)+","+Math.round(w.b+A.b*S)+","+(w.a+A.a*S)+")":V=w+A*S;P.setAttr(R,V)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var S=this.node,P=_.attrs[S._id][this._id];P.points&&P.points.trueEnd&&S.setAttr("points",P.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var S=this.node,P=_.attrs[S._id][this._id];P.points&&P.points.trueStart&&S.points(P.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(S){return this.tween.seek(S*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var S=this.node._id,P=this._id,N=_.tweens[S],R;this.pause();for(R in N)delete _.tweens[S][R];delete _.attrs[S][P]}}t.Tween=_,_.attrs={},_.tweens={},r.Node.prototype.to=function(E){var S=E.onFinish;E.node=this,E.onFinish=function(){this.destroy(),S&&S()};var P=new _(E);P.play()},t.Easings={BackEaseIn(E,S,P,N){var R=1.70158;return P*(E/=N)*E*((R+1)*E-R)+S},BackEaseOut(E,S,P,N){var R=1.70158;return P*((E=E/N-1)*E*((R+1)*E+R)+1)+S},BackEaseInOut(E,S,P,N){var R=1.70158;return(E/=N/2)<1?P/2*(E*E*(((R*=1.525)+1)*E-R))+S:P/2*((E-=2)*E*(((R*=1.525)+1)*E+R)+2)+S},ElasticEaseIn(E,S,P,N,R,k){var w=0;return E===0?S:(E/=N)===1?S+P:(k||(k=N*.3),!R||R<Math.abs(P)?(R=P,w=k/4):w=k/(2*Math.PI)*Math.asin(P/R),-(R*Math.pow(2,10*(E-=1))*Math.sin((E*N-w)*(2*Math.PI)/k))+S)},ElasticEaseOut(E,S,P,N,R,k){var w=0;return E===0?S:(E/=N)===1?S+P:(k||(k=N*.3),!R||R<Math.abs(P)?(R=P,w=k/4):w=k/(2*Math.PI)*Math.asin(P/R),R*Math.pow(2,-10*E)*Math.sin((E*N-w)*(2*Math.PI)/k)+P+S)},ElasticEaseInOut(E,S,P,N,R,k){var w=0;return E===0?S:(E/=N/2)===2?S+P:(k||(k=N*(.3*1.5)),!R||R<Math.abs(P)?(R=P,w=k/4):w=k/(2*Math.PI)*Math.asin(P/R),E<1?-.5*(R*Math.pow(2,10*(E-=1))*Math.sin((E*N-w)*(2*Math.PI)/k))+S:R*Math.pow(2,-10*(E-=1))*Math.sin((E*N-w)*(2*Math.PI)/k)*.5+P+S)},BounceEaseOut(E,S,P,N){return(E/=N)<1/2.75?P*(7.5625*E*E)+S:E<2/2.75?P*(7.5625*(E-=1.5/2.75)*E+.75)+S:E<2.5/2.75?P*(7.5625*(E-=2.25/2.75)*E+.9375)+S:P*(7.5625*(E-=2.625/2.75)*E+.984375)+S},BounceEaseIn(E,S,P,N){return P-t.Easings.BounceEaseOut(N-E,0,P,N)+S},BounceEaseInOut(E,S,P,N){return E<N/2?t.Easings.BounceEaseIn(E*2,0,P,N)*.5+S:t.Easings.BounceEaseOut(E*2-N,0,P,N)*.5+P*.5+S},EaseIn(E,S,P,N){return P*(E/=N)*E+S},EaseOut(E,S,P,N){return-P*(E/=N)*(E-2)+S},EaseInOut(E,S,P,N){return(E/=N/2)<1?P/2*E*E+S:-P/2*(--E*(E-2)-1)+S},StrongEaseIn(E,S,P,N){return P*(E/=N)*E*E*E*E+S},StrongEaseOut(E,S,P,N){return P*((E=E/N-1)*E*E*E*E+1)+S},StrongEaseInOut(E,S,P,N){return(E/=N/2)<1?P/2*E*E*E*E*E+S:P/2*((E-=2)*E*E*E*E+2)+S},Linear(E,S,P,N){return P*E/N+S}}})(vR);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=Ve,n=Lt,r=At,i=pl,s=pR,o=Zd,u=v0,c=pc,h=m0,p=hn,m=gc,_=vR,E=Us,S=Pi;t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:i.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:u.FastLayer,Group:c.Group,DD:h.DD,Shape:p.Shape,shapes:p.shapes,Animation:m.Animation,Tween:_.Tween,Easings:_.Easings,Context:E.Context,Canvas:S.Canvas}),t.default=t.Konva})(fm);var y0={};Object.defineProperty(y0,"__esModule",{value:!0});y0.Arc=void 0;const w0=Ue,pj=hn,V3=Ve,E0=Ee,gj=Ve;class eo extends pj.Shape{_sceneFunc(e){var n=V3.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,r),e.arc(0,0,this.innerRadius(),n,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),r=this.clockwise(),i=V3.Konva.getAngle(r?360-this.angle():this.angle()),s=Math.cos(Math.min(i,Math.PI)),o=1,u=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),h=s*(s>0?e:n),p=o*n,m=u*(u>0?e:n),_=c*(c>0?n:e);return{x:h,y:r?-1*_:m,width:p-h,height:_-m}}}y0.Arc=eo;eo.prototype._centroid=!0;eo.prototype.className="Arc";eo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,gj._registerNode)(eo);w0.Factory.addGetterSetter(eo,"innerRadius",0,(0,E0.getNumberValidator)());w0.Factory.addGetterSetter(eo,"outerRadius",0,(0,E0.getNumberValidator)());w0.Factory.addGetterSetter(eo,"angle",0,(0,E0.getNumberValidator)());w0.Factory.addGetterSetter(eo,"clockwise",!1,(0,E0.getBooleanValidator)());var S0={},ef={};Object.defineProperty(ef,"__esModule",{value:!0});ef.Line=void 0;const T0=Ue,mj=hn,yR=Ee,_j=Ve;function K1(t,e,n,r,i,s,o){var u=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),c=Math.sqrt(Math.pow(i-n,2)+Math.pow(s-r,2)),h=o*u/(u+c),p=o*c/(u+c),m=n-h*(i-t),_=r-h*(s-e),E=n+p*(i-t),S=r+p*(s-e);return[m,_,E,S]}function U3(t,e){var n=t.length,r=[],i,s;for(i=2;i<n-2;i+=2)s=K1(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e),!isNaN(s[0])&&(r.push(s[0]),r.push(s[1]),r.push(t[i]),r.push(t[i+1]),r.push(s[2]),r.push(s[3]));return r}class aa extends mj.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var n=this.points(),r=n.length,i=this.tension(),s=this.closed(),o=this.bezier(),u,c,h;if(r){if(e.beginPath(),e.moveTo(n[0],n[1]),i!==0&&r>4){for(u=this.getTensionPoints(),c=u.length,h=s?0:4,s||e.quadraticCurveTo(u[0],u[1],u[2],u[3]);h<c-2;)e.bezierCurveTo(u[h++],u[h++],u[h++],u[h++],u[h++],u[h++]);s||e.quadraticCurveTo(u[c-2],u[c-1],n[r-2],n[r-1])}else if(o)for(h=2;h<r;)e.bezierCurveTo(n[h++],n[h++],n[h++],n[h++],n[h++],n[h++]);else for(h=2;h<r;h+=2)e.lineTo(n[h],n[h+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():U3(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),n=e.length,r=this.tension(),i=K1(e[n-2],e[n-1],e[0],e[1],e[2],e[3],r),s=K1(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],r),o=U3(e,r),u=[i[2],i[3]].concat(o).concat([s[0],s[1],e[n-2],e[n-1],s[2],s[3],i[0],i[1],e[0],e[1]]);return u}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();for(var n=e[0],r=e[0],i=e[1],s=e[1],o,u,c=0;c<e.length/2;c++)o=e[c*2],u=e[c*2+1],n=Math.min(n,o),r=Math.max(r,o),i=Math.min(i,u),s=Math.max(s,u);return{x:n,y:i,width:r-n,height:s-i}}}ef.Line=aa;aa.prototype.className="Line";aa.prototype._attrsAffectingSize=["points","bezier","tension"];(0,_j._registerNode)(aa);T0.Factory.addGetterSetter(aa,"closed",!1);T0.Factory.addGetterSetter(aa,"bezier",!1);T0.Factory.addGetterSetter(aa,"tension",0,(0,yR.getNumberValidator)());T0.Factory.addGetterSetter(aa,"points",[],(0,yR.getNumberArrayValidator)());var mc={},wR={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,u,c)=>{let h,p,m;h=c/2,p=0;for(let E=0;E<20;E++)m=h*t.tValues[20][E]+h,p+=t.cValues[20][E]*r(o,u,m);return h*p};t.getCubicArcLength=e;const n=(o,u,c)=>{c===void 0&&(c=1);const h=o[0]-2*o[1]+o[2],p=u[0]-2*u[1]+u[2],m=2*o[1]-2*o[0],_=2*u[1]-2*u[0],E=4*(h*h+p*p),S=4*(h*m+p*_),P=m*m+_*_;if(E===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(u[2]-u[0],2));const N=S/(2*E),R=P/E,k=c+N,w=R-N*N,A=k*k+w>0?Math.sqrt(k*k+w):0,V=N*N+w>0?Math.sqrt(N*N+w):0,U=N+Math.sqrt(N*N+w)!==0?w*Math.log(Math.abs((k+A)/(N+V))):0;return Math.sqrt(E)/2*(k*A-N*V+U)};t.getQuadraticArcLength=n;function r(o,u,c){const h=i(1,c,o),p=i(1,c,u),m=h*h+p*p;return Math.sqrt(m)}const i=(o,u,c)=>{const h=c.length-1;let p,m;if(h===0)return 0;if(o===0){m=0;for(let _=0;_<=h;_++)m+=t.binomialCoefficients[h][_]*Math.pow(1-u,h-_)*Math.pow(u,_)*c[_];return m}else{p=new Array(h);for(let _=0;_<h;_++)p[_]=h*(c[_+1]-c[_]);return i(o-1,u,p)}},s=(o,u,c)=>{let h=1,p=o/u,m=(o-c(p))/u,_=0;for(;h>.001;){const E=c(p+m),S=Math.abs(o-E)/u;if(S<h)h=S,p+=m;else{const P=c(p-m),N=Math.abs(o-P)/u;N<h?(h=N,p-=m):m/=2}if(_++,_>500)break}return p};t.t2length=s})(wR);Object.defineProperty(mc,"__esModule",{value:!0});mc.Path=void 0;const vj=Ue,yj=hn,wj=Ve,Kl=wR;class on extends yj.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=on.parsePathData(this.data()),this.pathLength=on.getPathLength(this.dataArray)}_sceneFunc(e){var n=this.dataArray;e.beginPath();for(var r=!1,i=0;i<n.length;i++){var s=n[i].command,o=n[i].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":var u=o[0],c=o[1],h=o[2],p=o[3],m=o[4],_=o[5],E=o[6],S=o[7],P=h>p?h:p,N=h>p?1:h/p,R=h>p?p/h:1;e.translate(u,c),e.rotate(E),e.scale(N,R),e.arc(0,0,P,m,m+_,1-S),e.scale(1/N,1/R),e.rotate(-E),e.translate(-u,-c);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(h){if(h.command==="A"){var p=h.points[4],m=h.points[5],_=h.points[4]+m,E=Math.PI/180;if(Math.abs(p-_)<E&&(E=Math.abs(p-_)),m<0)for(let S=p-E;S>_;S-=E){const P=on.getPointOnEllipticalArc(h.points[0],h.points[1],h.points[2],h.points[3],S,0);e.push(P.x,P.y)}else for(let S=p+E;S<_;S+=E){const P=on.getPointOnEllipticalArc(h.points[0],h.points[1],h.points[2],h.points[3],S,0);e.push(P.x,P.y)}}else if(h.command==="C")for(let S=0;S<=1;S+=.01){const P=on.getPointOnCubicBezier(S,h.start.x,h.start.y,h.points[0],h.points[1],h.points[2],h.points[3],h.points[4],h.points[5]);e.push(P.x,P.y)}else e=e.concat(h.points)});for(var n=e[0],r=e[0],i=e[1],s=e[1],o,u,c=0;c<e.length/2;c++)o=e[c*2],u=e[c*2+1],isNaN(o)||(n=Math.min(n,o),r=Math.max(r,o)),isNaN(u)||(i=Math.min(i,u),s=Math.max(s,u));return{x:n,y:i,width:r-n,height:s-i}}getLength(){return this.pathLength}getPointAtLength(e){return on.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,r,i){return Math.sqrt((r-e)*(r-e)+(i-n)*(i-n))}static getPathLength(e){let n=0;for(var r=0;r<e.length;++r)n+=e[r].pathLength;return n}static getPointAtLengthOfDataArray(e,n){var r,i=0,s=n.length;if(!s)return null;for(;i<s&&e>n[i].pathLength;)e-=n[i].pathLength,++i;if(i===s)return r=n[i-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return r=n[i].points.slice(0,2),{x:r[0],y:r[1]};var o=n[i],u=o.points;switch(o.command){case"L":return on.getPointOnLine(e,o.start.x,o.start.y,u[0],u[1]);case"C":return on.getPointOnCubicBezier((0,Kl.t2length)(e,on.getPathLength(n),P=>(0,Kl.getCubicArcLength)([o.start.x,u[0],u[2],u[4]],[o.start.y,u[1],u[3],u[5]],P)),o.start.x,o.start.y,u[0],u[1],u[2],u[3],u[4],u[5]);case"Q":return on.getPointOnQuadraticBezier((0,Kl.t2length)(e,on.getPathLength(n),P=>(0,Kl.getQuadraticArcLength)([o.start.x,u[0],u[2]],[o.start.y,u[1],u[3]],P)),o.start.x,o.start.y,u[0],u[1],u[2],u[3]);case"A":var c=u[0],h=u[1],p=u[2],m=u[3],_=u[4],E=u[5],S=u[6];return _+=E*e/o.pathLength,on.getPointOnEllipticalArc(c,h,p,m,_,S)}return null}static getPointOnLine(e,n,r,i,s,o,u){o===void 0&&(o=n),u===void 0&&(u=r);var c=(s-r)/(i-n+1e-8),h=Math.sqrt(e*e/(1+c*c));i<n&&(h*=-1);var p=c*h,m;if(i===n)m={x:o,y:u+p};else if((u-r)/(o-n+1e-8)===c)m={x:o+h,y:u+p};else{var _,E,S=this.getLineLength(n,r,i,s),P=(o-n)*(i-n)+(u-r)*(s-r);P=P/(S*S),_=n+P*(i-n),E=r+P*(s-r);var N=this.getLineLength(o,u,_,E),R=Math.sqrt(e*e-N*N);h=Math.sqrt(R*R/(1+c*c)),i<n&&(h*=-1),p=c*h,m={x:_+h,y:E+p}}return m}static getPointOnCubicBezier(e,n,r,i,s,o,u,c,h){function p(N){return N*N*N}function m(N){return 3*N*N*(1-N)}function _(N){return 3*N*(1-N)*(1-N)}function E(N){return(1-N)*(1-N)*(1-N)}var S=c*p(e)+o*m(e)+i*_(e)+n*E(e),P=h*p(e)+u*m(e)+s*_(e)+r*E(e);return{x:S,y:P}}static getPointOnQuadraticBezier(e,n,r,i,s,o,u){function c(E){return E*E}function h(E){return 2*E*(1-E)}function p(E){return(1-E)*(1-E)}var m=o*c(e)+i*h(e)+n*p(e),_=u*c(e)+s*h(e)+r*p(e);return{x:m,y:_}}static getPointOnEllipticalArc(e,n,r,i,s,o){var u=Math.cos(o),c=Math.sin(o),h={x:r*Math.cos(s),y:i*Math.sin(s)};return{x:e+(h.x*u-h.y*c),y:n+(h.x*c+h.y*u)}}static parsePathData(e){if(!e)return[];var n=e,r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var i=0;i<r.length;i++)n=n.replace(new RegExp(r[i],"g"),"|"+r[i]);var s=n.split("|"),o=[],u=[],c=0,h=0,p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,m;for(i=1;i<s.length;i++){var _=s[i],E=_.charAt(0);for(_=_.slice(1),u.length=0;m=p.exec(_);)u.push(m[0]);for(var S=[],P=0,N=u.length;P<N;P++){if(u[P]==="00"){S.push(0,0);continue}var R=parseFloat(u[P]);isNaN(R)?S.push(0):S.push(R)}for(;S.length>0&&!isNaN(S[0]);){var k="",w=[],A=c,V=h,U,O,C,D,x,M,z,b,oe,ye;switch(E){case"l":c+=S.shift(),h+=S.shift(),k="L",w.push(c,h);break;case"L":c=S.shift(),h=S.shift(),w.push(c,h);break;case"m":var Te=S.shift(),Pe=S.shift();if(c+=Te,h+=Pe,k="M",o.length>2&&o[o.length-1].command==="z"){for(var J=o.length-2;J>=0;J--)if(o[J].command==="M"){c=o[J].points[0]+Te,h=o[J].points[1]+Pe;break}}w.push(c,h),E="l";break;case"M":c=S.shift(),h=S.shift(),k="M",w.push(c,h),E="L";break;case"h":c+=S.shift(),k="L",w.push(c,h);break;case"H":c=S.shift(),k="L",w.push(c,h);break;case"v":h+=S.shift(),k="L",w.push(c,h);break;case"V":h=S.shift(),k="L",w.push(c,h);break;case"C":w.push(S.shift(),S.shift(),S.shift(),S.shift()),c=S.shift(),h=S.shift(),w.push(c,h);break;case"c":w.push(c+S.shift(),h+S.shift(),c+S.shift(),h+S.shift()),c+=S.shift(),h+=S.shift(),k="C",w.push(c,h);break;case"S":O=c,C=h,U=o[o.length-1],U.command==="C"&&(O=c+(c-U.points[2]),C=h+(h-U.points[3])),w.push(O,C,S.shift(),S.shift()),c=S.shift(),h=S.shift(),k="C",w.push(c,h);break;case"s":O=c,C=h,U=o[o.length-1],U.command==="C"&&(O=c+(c-U.points[2]),C=h+(h-U.points[3])),w.push(O,C,c+S.shift(),h+S.shift()),c+=S.shift(),h+=S.shift(),k="C",w.push(c,h);break;case"Q":w.push(S.shift(),S.shift()),c=S.shift(),h=S.shift(),w.push(c,h);break;case"q":w.push(c+S.shift(),h+S.shift()),c+=S.shift(),h+=S.shift(),k="Q",w.push(c,h);break;case"T":O=c,C=h,U=o[o.length-1],U.command==="Q"&&(O=c+(c-U.points[0]),C=h+(h-U.points[1])),c=S.shift(),h=S.shift(),k="Q",w.push(O,C,c,h);break;case"t":O=c,C=h,U=o[o.length-1],U.command==="Q"&&(O=c+(c-U.points[0]),C=h+(h-U.points[1])),c+=S.shift(),h+=S.shift(),k="Q",w.push(O,C,c,h);break;case"A":D=S.shift(),x=S.shift(),M=S.shift(),z=S.shift(),b=S.shift(),oe=c,ye=h,c=S.shift(),h=S.shift(),k="A",w=this.convertEndpointToCenterParameterization(oe,ye,c,h,z,b,D,x,M);break;case"a":D=S.shift(),x=S.shift(),M=S.shift(),z=S.shift(),b=S.shift(),oe=c,ye=h,c+=S.shift(),h+=S.shift(),k="A",w=this.convertEndpointToCenterParameterization(oe,ye,c,h,z,b,D,x,M);break}o.push({command:k||E,points:w,start:{x:A,y:V},pathLength:this.calcLength(A,V,k||E,w)})}(E==="z"||E==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,n,r,i){var s,o,u,c,h=on;switch(r){case"L":return h.getLineLength(e,n,i[0],i[1]);case"C":return(0,Kl.getCubicArcLength)([e,i[0],i[2],i[4]],[n,i[1],i[3],i[5]],1);case"Q":return(0,Kl.getQuadraticArcLength)([e,i[0],i[2]],[n,i[1],i[3]],1);case"A":s=0;var p=i[4],m=i[5],_=i[4]+m,E=Math.PI/180;if(Math.abs(p-_)<E&&(E=Math.abs(p-_)),o=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(c=p-E;c>_;c-=E)u=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=h.getLineLength(o.x,o.y,u.x,u.y),o=u;else for(c=p+E;c<_;c+=E)u=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),s+=h.getLineLength(o.x,o.y,u.x,u.y),o=u;return u=h.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],_,0),s+=h.getLineLength(o.x,o.y,u.x,u.y),s}return 0}static convertEndpointToCenterParameterization(e,n,r,i,s,o,u,c,h){var p=h*(Math.PI/180),m=Math.cos(p)*(e-r)/2+Math.sin(p)*(n-i)/2,_=-1*Math.sin(p)*(e-r)/2+Math.cos(p)*(n-i)/2,E=m*m/(u*u)+_*_/(c*c);E>1&&(u*=Math.sqrt(E),c*=Math.sqrt(E));var S=Math.sqrt((u*u*(c*c)-u*u*(_*_)-c*c*(m*m))/(u*u*(_*_)+c*c*(m*m)));s===o&&(S*=-1),isNaN(S)&&(S=0);var P=S*u*_/c,N=S*-c*m/u,R=(e+r)/2+Math.cos(p)*P-Math.sin(p)*N,k=(n+i)/2+Math.sin(p)*P+Math.cos(p)*N,w=function(x){return Math.sqrt(x[0]*x[0]+x[1]*x[1])},A=function(x,M){return(x[0]*M[0]+x[1]*M[1])/(w(x)*w(M))},V=function(x,M){return(x[0]*M[1]<x[1]*M[0]?-1:1)*Math.acos(A(x,M))},U=V([1,0],[(m-P)/u,(_-N)/c]),O=[(m-P)/u,(_-N)/c],C=[(-1*m-P)/u,(-1*_-N)/c],D=V(O,C);return A(O,C)<=-1&&(D=Math.PI),A(O,C)>=1&&(D=0),o===0&&D>0&&(D=D-2*Math.PI),o===1&&D<0&&(D=D+2*Math.PI),[R,k,u,c,U,D,p,o]}}mc.Path=on;on.prototype.className="Path";on.prototype._attrsAffectingSize=["data"];(0,wj._registerNode)(on);vj.Factory.addGetterSetter(on,"data");Object.defineProperty(S0,"__esModule",{value:!0});S0.Arrow=void 0;const C0=Ue,Ej=ef,ER=Ee,Sj=Ve,z3=mc;class ml extends Ej.Line{_sceneFunc(e){super._sceneFunc(e);var n=Math.PI*2,r=this.points(),i=r,s=this.tension()!==0&&r.length>4;s&&(i=this.getTensionPoints());var o=this.pointerLength(),u=r.length,c,h;if(s){const _=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],r[u-2],r[u-1]],E=z3.Path.calcLength(i[i.length-4],i[i.length-3],"C",_),S=z3.Path.getPointOnQuadraticBezier(Math.min(1,1-o/E),_[0],_[1],_[2],_[3],_[4],_[5]);c=r[u-2]-S.x,h=r[u-1]-S.y}else c=r[u-2]-r[u-4],h=r[u-1]-r[u-3];var p=(Math.atan2(h,c)+n)%n,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[u-2],r[u-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),s?(c=(i[0]+i[2])/2-r[0],h=(i[1]+i[3])/2-r[1]):(c=r[2]-r[0],h=r[3]-r[1]),e.rotate((Math.atan2(-h,-c)+n)%n),e.moveTo(0,0),e.lineTo(-o,m/2),e.lineTo(-o,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x-n,y:e.y-n,width:e.width+n*2,height:e.height+n*2}}}S0.Arrow=ml;ml.prototype.className="Arrow";(0,Sj._registerNode)(ml);C0.Factory.addGetterSetter(ml,"pointerLength",10,(0,ER.getNumberValidator)());C0.Factory.addGetterSetter(ml,"pointerWidth",10,(0,ER.getNumberValidator)());C0.Factory.addGetterSetter(ml,"pointerAtBeginning",!1);C0.Factory.addGetterSetter(ml,"pointerAtEnding",!0);var I0={};Object.defineProperty(I0,"__esModule",{value:!0});I0.Circle=void 0;const Tj=Ue,Cj=hn,Ij=Ee,Pj=Ve;class _c extends Cj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}I0.Circle=_c;_c.prototype._centroid=!0;_c.prototype.className="Circle";_c.prototype._attrsAffectingSize=["radius"];(0,Pj._registerNode)(_c);Tj.Factory.addGetterSetter(_c,"radius",0,(0,Ij.getNumberValidator)());var P0={};Object.defineProperty(P0,"__esModule",{value:!0});P0.Ellipse=void 0;const bE=Ue,Rj=hn,SR=Ee,kj=Ve;class la extends Rj.Shape{_sceneFunc(e){var n=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),n!==r&&e.scale(1,r/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}P0.Ellipse=la;la.prototype.className="Ellipse";la.prototype._centroid=!0;la.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,kj._registerNode)(la);bE.Factory.addComponentsGetterSetter(la,"radius",["x","y"]);bE.Factory.addGetterSetter(la,"radiusX",0,(0,SR.getNumberValidator)());bE.Factory.addGetterSetter(la,"radiusY",0,(0,SR.getNumberValidator)());var R0={};Object.defineProperty(R0,"__esModule",{value:!0});R0.Image=void 0;const ry=Lt,_l=Ue,Aj=hn,xj=Ve,tf=Ee;let is=class TR extends Aj.Shape{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),s=this.attrs.image;let o;if(s){const u=this.attrs.cropWidth,c=this.attrs.cropHeight;u&&c?o=[s,this.cropX(),this.cropY(),u,c,0,0,n,r]:o=[s,0,0,n,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?ry.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),s&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){var n=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?ry.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,r=null){var i=ry.Util.createImageElement();i.onload=function(){var s=new TR({image:i});n(s)},i.onerror=r,i.crossOrigin="Anonymous",i.src=e}};R0.Image=is;is.prototype.className="Image";(0,xj._registerNode)(is);_l.Factory.addGetterSetter(is,"cornerRadius",0,(0,tf.getNumberOrArrayOfNumbersValidator)(4));_l.Factory.addGetterSetter(is,"image");_l.Factory.addComponentsGetterSetter(is,"crop",["x","y","width","height"]);_l.Factory.addGetterSetter(is,"cropX",0,(0,tf.getNumberValidator)());_l.Factory.addGetterSetter(is,"cropY",0,(0,tf.getNumberValidator)());_l.Factory.addGetterSetter(is,"cropWidth",0,(0,tf.getNumberValidator)());_l.Factory.addGetterSetter(is,"cropHeight",0,(0,tf.getNumberValidator)());var qu={};Object.defineProperty(qu,"__esModule",{value:!0});qu.Tag=qu.Label=void 0;const k0=Ue,Nj=hn,Dj=pc,FE=Ee,CR=Ve;var IR=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],Oj="Change.konva",Mj="none",Q1="up",Y1="right",X1="down",J1="left",Lj=IR.length;class VE extends Dj.Group{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var n=this,r,i=function(){n._sync()};for(r=0;r<Lj;r++)e.on(IR[r]+Oj,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var e=this.getText(),n=this.getTag(),r,i,s,o,u,c,h;if(e&&n){switch(r=e.width(),i=e.height(),s=n.pointerDirection(),o=n.pointerWidth(),h=n.pointerHeight(),u=0,c=0,s){case Q1:u=r/2,c=-1*h;break;case Y1:u=r+o,c=i/2;break;case X1:u=r/2,c=i+h;break;case J1:u=-1*o,c=i/2;break}n.setAttrs({x:-1*u,y:-1*c,width:r,height:i}),e.setAttrs({x:-1*u,y:-1*c})}}}qu.Label=VE;VE.prototype.className="Label";(0,CR._registerNode)(VE);class vl extends Nj.Shape{_sceneFunc(e){var n=this.width(),r=this.height(),i=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),u=this.cornerRadius();let c=0,h=0,p=0,m=0;typeof u=="number"?c=h=p=m=Math.min(u,n/2,r/2):(c=Math.min(u[0]||0,n/2,r/2),h=Math.min(u[1]||0,n/2,r/2),m=Math.min(u[2]||0,n/2,r/2),p=Math.min(u[3]||0,n/2,r/2)),e.beginPath(),e.moveTo(c,0),i===Q1&&(e.lineTo((n-s)/2,0),e.lineTo(n/2,-1*o),e.lineTo((n+s)/2,0)),e.lineTo(n-h,0),e.arc(n-h,h,h,Math.PI*3/2,0,!1),i===Y1&&(e.lineTo(n,(r-o)/2),e.lineTo(n+s,r/2),e.lineTo(n,(r+o)/2)),e.lineTo(n,r-m),e.arc(n-m,r-m,m,0,Math.PI/2,!1),i===X1&&(e.lineTo((n+s)/2,r),e.lineTo(n/2,r+o),e.lineTo((n-s)/2,r)),e.lineTo(p,r),e.arc(p,r-p,p,Math.PI/2,Math.PI,!1),i===J1&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*s,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,c),e.arc(c,c,c,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,n=0,r=this.pointerWidth(),i=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),u=this.height();return s===Q1?(n-=i,u+=i):s===X1?u+=i:s===J1?(e-=r*1.5,o+=r):s===Y1&&(o+=r*1.5),{x:e,y:n,width:o,height:u}}}qu.Tag=vl;vl.prototype.className="Tag";(0,CR._registerNode)(vl);k0.Factory.addGetterSetter(vl,"pointerDirection",Mj);k0.Factory.addGetterSetter(vl,"pointerWidth",0,(0,FE.getNumberValidator)());k0.Factory.addGetterSetter(vl,"pointerHeight",0,(0,FE.getNumberValidator)());k0.Factory.addGetterSetter(vl,"cornerRadius",0,(0,FE.getNumberOrArrayOfNumbersValidator)(4));var nf={};Object.defineProperty(nf,"__esModule",{value:!0});nf.Rect=void 0;const bj=Ue,Fj=hn,Vj=Ve,Uj=Lt,zj=Ee;let A0=class extends Fj.Shape{_sceneFunc(e){var n=this.cornerRadius(),r=this.width(),i=this.height();e.beginPath(),n?Uj.Util.drawRoundedRectPath(e,r,i,n):e.rect(0,0,r,i),e.closePath(),e.fillStrokeShape(this)}};nf.Rect=A0;A0.prototype.className="Rect";(0,Vj._registerNode)(A0);bj.Factory.addGetterSetter(A0,"cornerRadius",0,(0,zj.getNumberOrArrayOfNumbersValidator)(4));var x0={};Object.defineProperty(x0,"__esModule",{value:!0});x0.RegularPolygon=void 0;const PR=Ue,Bj=hn,RR=Ee,jj=Ve;class yl extends Bj.Shape{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,r=[];for(var i=0;i<e;i++)r.push({x:n*Math.sin(i*2*Math.PI/e),y:-1*n*Math.cos(i*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();var n=e[0].x,r=e[0].y,i=e[0].x,s=e[0].y;return e.forEach(o=>{n=Math.min(n,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),{x:n,y:i,width:r-n,height:s-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}x0.RegularPolygon=yl;yl.prototype.className="RegularPolygon";yl.prototype._centroid=!0;yl.prototype._attrsAffectingSize=["radius"];(0,jj._registerNode)(yl);PR.Factory.addGetterSetter(yl,"radius",0,(0,RR.getNumberValidator)());PR.Factory.addGetterSetter(yl,"sides",0,(0,RR.getNumberValidator)());var N0={};Object.defineProperty(N0,"__esModule",{value:!0});N0.Ring=void 0;const kR=Ue,Gj=hn,AR=Ee,Wj=Ve;var B3=Math.PI*2;class wl extends Gj.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,B3,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),B3,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}N0.Ring=wl;wl.prototype.className="Ring";wl.prototype._centroid=!0;wl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Wj._registerNode)(wl);kR.Factory.addGetterSetter(wl,"innerRadius",0,(0,AR.getNumberValidator)());kR.Factory.addGetterSetter(wl,"outerRadius",0,(0,AR.getNumberValidator)());var D0={};Object.defineProperty(D0,"__esModule",{value:!0});D0.Sprite=void 0;const El=Ue,Hj=hn,$j=gc,xR=Ee,qj=Ve;class ss extends Hj.Shape{constructor(e){super(e),this._updated=!0,this.anim=new $j.Animation(()=>{var n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],o=this.frameOffsets(),u=s[i+0],c=s[i+1],h=s[i+2],p=s[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,h,p),e.closePath(),e.fillStrokeShape(this)),m)if(o){var _=o[n],E=r*2;e.drawImage(m,u,c,h,p,_[E+0],_[E+1],h,p)}else e.drawImage(m,u,c,h,p,0,0,h,p)}_hitFunc(e){var n=this.animation(),r=this.frameIndex(),i=r*4,s=this.animations()[n],o=this.frameOffsets(),u=s[i+2],c=s[i+3];if(e.beginPath(),o){var h=o[n],p=r*2;e.rect(h[p+0],h[p+1],u,c)}else e.rect(0,0,u,c);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),n=this.animation(),r=this.animations(),i=r[n],s=i.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}D0.Sprite=ss;ss.prototype.className="Sprite";(0,qj._registerNode)(ss);El.Factory.addGetterSetter(ss,"animation");El.Factory.addGetterSetter(ss,"animations");El.Factory.addGetterSetter(ss,"frameOffsets");El.Factory.addGetterSetter(ss,"image");El.Factory.addGetterSetter(ss,"frameIndex",0,(0,xR.getNumberValidator)());El.Factory.addGetterSetter(ss,"frameRate",17,(0,xR.getNumberValidator)());El.Factory.backCompat(ss,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var O0={};Object.defineProperty(O0,"__esModule",{value:!0});O0.Star=void 0;const UE=Ue,Kj=hn,zE=Ee,Qj=Ve;class ua extends Kj.Shape{_sceneFunc(e){var n=this.innerRadius(),r=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(var s=1;s<i*2;s++){var o=s%2===0?r:n,u=o*Math.sin(s*Math.PI/i),c=-1*o*Math.cos(s*Math.PI/i);e.lineTo(u,c)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}O0.Star=ua;ua.prototype.className="Star";ua.prototype._centroid=!0;ua.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Qj._registerNode)(ua);UE.Factory.addGetterSetter(ua,"numPoints",5,(0,zE.getNumberValidator)());UE.Factory.addGetterSetter(ua,"innerRadius",0,(0,zE.getNumberValidator)());UE.Factory.addGetterSetter(ua,"outerRadius",0,(0,zE.getNumberValidator)());var ol={};Object.defineProperty(ol,"__esModule",{value:!0});ol.Text=ol.stringToArray=void 0;const Z1=Lt,sr=Ue,Yj=hn,ca=Ee,Xj=Ve;function NR(t){return Array.from(t)}ol.stringToArray=NR;var Ql="auto",Jj="center",DR="inherit",dh="justify",Zj="Change.konva",eG="2d",j3="-",OR="left",tG="text",nG="Text",rG="top",iG="bottom",G3="middle",MR="normal",sG="px ",Mp=" ",oG="right",W3="rtl",aG="word",lG="char",H3="none",iy="",LR=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],uG=LR.length;function cG(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!r&&(e=`"${e}"`),e}).join(", ")}var Lp;function sy(){return Lp||(Lp=Z1.Util.createCanvasElement().getContext(eG),Lp)}function hG(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function dG(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function fG(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}class zt extends Yj.Shape{constructor(e){super(fG(e)),this._partialTextX=0,this._partialTextY=0;for(var n=0;n<uG;n++)this.on(LR[n]+Zj,this._setTextData);this._setTextData()}_sceneFunc(e){var n=this.textArr,r=n.length;if(this.text()){var i=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,u=this.verticalAlign(),c=this.direction(),h=0,p=this.align(),m=this.getWidth(),_=this.letterSpacing(),E=this.fill(),S=this.textDecoration(),P=S.indexOf("underline")!==-1,N=S.indexOf("line-through")!==-1,R;c=c===DR?e.direction:c;var k=0,k=o/2,w=0,A=0;for(c===W3&&e.setAttr("direction",c),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",G3),e.setAttr("textAlign",OR),u===G3?h=(this.getHeight()-r*o-i*2)/2:u===iG&&(h=this.getHeight()-r*o-i*2),e.translate(i,h+i),R=0;R<r;R++){var w=0,A=0,V=n[R],U=V.text,O=V.width,C=V.lastInParagraph,D,x,M;if(e.save(),p===oG?w+=m-O-i*2:p===Jj&&(w+=(m-O-i*2)/2),P){e.save(),e.beginPath(),e.moveTo(w,k+A+Math.round(s/2)),D=U.split(" ").length-1,x=D===0,M=p===dh&&!C?m-i*2:O,e.lineTo(w+Math.round(M),k+A+Math.round(s/2)),e.lineWidth=s/15;const Pe=this._getLinearGradient();e.strokeStyle=Pe||E,e.stroke(),e.restore()}if(N){e.save(),e.beginPath(),e.moveTo(w,k+A),D=U.split(" ").length-1,x=D===0,M=p===dh&&C&&!x?m-i*2:O,e.lineTo(w+Math.round(M),k+A),e.lineWidth=s/15;const Pe=this._getLinearGradient();e.strokeStyle=Pe||E,e.stroke(),e.restore()}if(c!==W3&&(_!==0||p===dh)){D=U.split(" ").length-1;for(var z=NR(U),b=0;b<z.length;b++){var oe=z[b];oe===" "&&!C&&p===dh&&(w+=(m-i*2-O)/D),this._partialTextX=w,this._partialTextY=k+A,this._partialText=oe,e.fillStrokeShape(this),w+=this.measureSize(oe).width+_}}else _!==0&&e.setAttr("letterSpacing",`${_}px`),this._partialTextX=w,this._partialTextY=k+A,this._partialText=U,e.fillStrokeShape(this);e.restore(),r>1&&(k+=o)}}}_hitFunc(e){var n=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}setText(e){var n=Z1.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(tG,n),this}getWidth(){var e=this.attrs.width===Ql||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var e=this.attrs.height===Ql||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Z1.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n=sy(),r=this.fontSize(),i;return n.save(),n.font=this._getContextFont(),i=n.measureText(e),n.restore(),{width:i.width,height:r}}_getContextFont(){return this.fontStyle()+Mp+this.fontVariant()+Mp+(this.fontSize()+sG)+cG(this.fontFamily())}_addTextLine(e){this.align()===dh&&(e=e.trim());var r=this._getTextWidth(e);return this.textArr.push({text:e,width:r,lastInParagraph:!1})}_getTextWidth(e){var n=this.letterSpacing(),r=e.length;return sy().measureText(e).width+(r?n*(r-1):0)}_setTextData(){var e=this.text().split(`
`),n=+this.fontSize(),r=0,i=this.lineHeight()*n,s=this.attrs.width,o=this.attrs.height,u=s!==Ql&&s!==void 0,c=o!==Ql&&o!==void 0,h=this.padding(),p=s-h*2,m=o-h*2,_=0,E=this.wrap(),S=E!==H3,P=E!==lG&&S,N=this.ellipsis();this.textArr=[],sy().font=this._getContextFont();for(var R=N?this._getTextWidth(iy):0,k=0,w=e.length;k<w;++k){var A=e[k],V=this._getTextWidth(A);if(u&&V>p)for(;A.length>0;){for(var U=0,O=A.length,C="",D=0;U<O;){var x=U+O>>>1,M=A.slice(0,x+1),z=this._getTextWidth(M)+R;z<=p?(U=x+1,C=M,D=z):O=x}if(C){if(P){var b,oe=A[C.length],ye=oe===Mp||oe===j3;ye&&D<=p?b=C.length:b=Math.max(C.lastIndexOf(Mp),C.lastIndexOf(j3))+1,b>0&&(U=b,C=C.slice(0,U),D=this._getTextWidth(C))}C=C.trimRight(),this._addTextLine(C),r=Math.max(r,D),_+=i;var Te=this._shouldHandleEllipsis(_);if(Te){this._tryToAddEllipsisToLastLine();break}if(A=A.slice(U),A=A.trimLeft(),A.length>0&&(V=this._getTextWidth(A),V<=p)){this._addTextLine(A),_+=i,r=Math.max(r,V);break}}else break}else this._addTextLine(A),_+=i,r=Math.max(r,V),this._shouldHandleEllipsis(_)&&k<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),c&&_+i>m)break}this.textHeight=n,this.textWidth=r}_shouldHandleEllipsis(e){var n=+this.fontSize(),r=this.lineHeight()*n,i=this.attrs.height,s=i!==Ql&&i!==void 0,o=this.padding(),u=i-o*2,c=this.wrap(),h=c!==H3;return!h||s&&e+r>u}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,n=e!==Ql&&e!==void 0,r=this.padding(),i=e-r*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];if(!(!o||!s)){if(n){var u=this._getTextWidth(o.text+iy)<i;u||(o.text=o.text.slice(0,o.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+iy)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}}ol.Text=zt;zt.prototype._fillFunc=hG;zt.prototype._strokeFunc=dG;zt.prototype.className=nG;zt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,Xj._registerNode)(zt);sr.Factory.overWriteSetter(zt,"width",(0,ca.getNumberOrAutoValidator)());sr.Factory.overWriteSetter(zt,"height",(0,ca.getNumberOrAutoValidator)());sr.Factory.addGetterSetter(zt,"direction",DR);sr.Factory.addGetterSetter(zt,"fontFamily","Arial");sr.Factory.addGetterSetter(zt,"fontSize",12,(0,ca.getNumberValidator)());sr.Factory.addGetterSetter(zt,"fontStyle",MR);sr.Factory.addGetterSetter(zt,"fontVariant",MR);sr.Factory.addGetterSetter(zt,"padding",0,(0,ca.getNumberValidator)());sr.Factory.addGetterSetter(zt,"align",OR);sr.Factory.addGetterSetter(zt,"verticalAlign",rG);sr.Factory.addGetterSetter(zt,"lineHeight",1,(0,ca.getNumberValidator)());sr.Factory.addGetterSetter(zt,"wrap",aG);sr.Factory.addGetterSetter(zt,"ellipsis",!1,(0,ca.getBooleanValidator)());sr.Factory.addGetterSetter(zt,"letterSpacing",0,(0,ca.getNumberValidator)());sr.Factory.addGetterSetter(zt,"text","",(0,ca.getStringValidator)());sr.Factory.addGetterSetter(zt,"textDecoration","");var M0={};Object.defineProperty(M0,"__esModule",{value:!0});M0.TextPath=void 0;const oy=Lt,xi=Ue,pG=hn,fh=mc,ay=ol,bR=Ee,gG=Ve;var mG="",FR="normal";function VR(t){t.fillText(this.partialText,0,0)}function UR(t){t.strokeText(this.partialText,0,0)}class dn extends pG.Shape{constructor(e){super(e),this.dummyCanvas=oy.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return fh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e-1>n?null:fh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=fh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var n=this.textDecoration(),r=this.fill(),i=this.fontSize(),s=this.glyphInfo;n==="underline"&&e.beginPath();for(var o=0;o<s.length;o++){e.save();var u=s[o].p0;e.translate(u.x,u.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),n==="underline"&&(o===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=r,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var n=this.glyphInfo;if(n.length>=1){var r=n[0].p0;e.moveTo(r.x,r.y)}for(var i=0;i<n.length;i++){var s=n[i].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return oy.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return ay.Text.prototype.setText.call(this,e)}_getContextFont(){return ay.Text.prototype._getContextFont.call(this)}_getTextSize(e){var n=this.dummyCanvas,r=n.getContext("2d");r.save(),r.font=this._getContextFont();var i=r.measureText(e);return r.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),i=this.align(),s=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let u=0;i==="center"&&(u=Math.max(0,this.pathLength/2-o/2)),i==="right"&&(u=Math.max(0,this.pathLength-o));const c=(0,ay.stringToArray)(this.text());let h=u;for(var p=0;p<c.length;p++){const m=this._getPointAtLength(h);if(!m)return;let _=this._getTextSize(c[p]).width+r;if(c[p]===" "&&i==="justify"){const k=this.text().split(" ").length-1;_+=(this.pathLength-o)/k}const E=this._getPointAtLength(h+_);if(!E)return;const S=fh.Path.getLineLength(m.x,m.y,E.x,E.y);let P=0;if(s)try{P=s(c[p-1],c[p])*this.fontSize()}catch{P=0}m.x+=P,E.x+=P,this.textWidth+=P;const N=fh.Path.getPointOnLine(P+S/2,m.x,m.y,E.x,E.y),R=Math.atan2(E.y-m.y,E.x-m.x);this.glyphInfo.push({transposeX:N.x,transposeY:N.y,text:c[p],rotation:R,p0:m,p1:E}),h+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(p){e.push(p.p0.x),e.push(p.p0.y),e.push(p.p1.x),e.push(p.p1.y)});for(var n=e[0]||0,r=e[0]||0,i=e[1]||0,s=e[1]||0,o,u,c=0;c<e.length/2;c++)o=e[c*2],u=e[c*2+1],n=Math.min(n,o),r=Math.max(r,o),i=Math.min(i,u),s=Math.max(s,u);var h=this.fontSize();return{x:n-h/2,y:i-h/2,width:r-n+h,height:s-i+h}}destroy(){return oy.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}M0.TextPath=dn;dn.prototype._fillFunc=VR;dn.prototype._strokeFunc=UR;dn.prototype._fillFuncHit=VR;dn.prototype._strokeFuncHit=UR;dn.prototype.className="TextPath";dn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,gG._registerNode)(dn);xi.Factory.addGetterSetter(dn,"data");xi.Factory.addGetterSetter(dn,"fontFamily","Arial");xi.Factory.addGetterSetter(dn,"fontSize",12,(0,bR.getNumberValidator)());xi.Factory.addGetterSetter(dn,"fontStyle",FR);xi.Factory.addGetterSetter(dn,"align","left");xi.Factory.addGetterSetter(dn,"letterSpacing",0,(0,bR.getNumberValidator)());xi.Factory.addGetterSetter(dn,"textBaseline","middle");xi.Factory.addGetterSetter(dn,"fontVariant",FR);xi.Factory.addGetterSetter(dn,"text",mG);xi.Factory.addGetterSetter(dn,"textDecoration",null);xi.Factory.addGetterSetter(dn,"kerningFunc",null);var L0={};Object.defineProperty(L0,"__esModule",{value:!0});L0.Transformer=void 0;const pt=Lt,lt=Ue,$3=At,_G=hn,vG=nf,q3=pc,gi=Ve,ha=Ee,yG=Ve;var zR="tr-konva",wG=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${zR}`).join(" "),K3="nodesRect",EG=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],SG={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const TG="ontouchstart"in gi.Konva._global;function CG(t,e,n){if(t==="rotater")return n;e+=pt.Util.degToRad(SG[t]||0);var r=(pt.Util.radToDeg(e)%360+360)%360;return pt.Util._inRange(r,315+22.5,360)||pt.Util._inRange(r,0,22.5)?"ns-resize":pt.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":pt.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":pt.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":pt.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":pt.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":pt.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":pt.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(pt.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}var gm=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function IG(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function BR(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),i=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:r,y:i}}function PG(t,e){const n=IG(t);return BR(t,e,n)}function RG(t,e,n){let r=e;for(let i=0;i<t.length;i++){const s=gi.Konva.getAngle(t[i]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<n&&(r=s)}return r}class nt extends q3.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(wG,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return pt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return zR+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const n=e.filter(i=>i.isAncestorOf(this)?(pt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},o=i._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");i.on(o,s),i.on(EG.map(u=>u+`.${this._getEventNamespace()}`).join(" "),s),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(i)}),this._resetTransformCache();var r=!!this.findOne(".top-left");return r&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,r=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(r,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,r=>{if(!n)return;const i=e.getAbsolutePosition(),s=i.x-n.x,o=i.y-n.y;this.nodes().forEach(u=>{if(u===e||u.isDragging())return;const c=u.getAbsolutePosition();u.setAbsolutePosition({x:c.x+s,y:c.y+o}),u.startDrag(r)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(K3),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(K3,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),r){var i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(r),o=e.getAbsolutePosition(r),u=i.x*s.x-e.offsetX()*s.x,c=i.y*s.y-e.offsetY()*s.y;const h=(gi.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:o.x+u*Math.cos(h)+c*Math.sin(-h),y:o.y+c*Math.cos(h)+u*Math.sin(h),width:i.width*s.x,height:i.height*s.y,rotation:h};return BR(p,-gi.Konva.getAngle(n),{x:0,y:0})}__getNodeRect(){var e=this.getNode();if(!e)return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const n=[];this.nodes().map(h=>{const p=h.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],_=h.getAbsoluteTransform();m.forEach(function(E){var S=_.point(E);n.push(S)})});const r=new pt.Transform;r.rotate(-gi.Konva.getAngle(this.rotation()));var i=1/0,s=1/0,o=-1/0,u=-1/0;n.forEach(function(h){var p=r.point(h);i===void 0&&(i=o=p.x,s=u=p.y),i=Math.min(i,p.x),s=Math.min(s,p.y),o=Math.max(o,p.x),u=Math.max(u,p.y)}),r.invert();const c=r.point({x:i,y:s});return{x:c.x,y:c.y,width:o-i,height:u-s,rotation:gi.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),gm.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){var n=new vG.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:TG?10:"auto"}),r=this;n.on("mousedown touchstart",function(i){r._handleMouseDown(i)}),n.on("dragstart",i=>{n.stopDrag(),i.cancelBubble=!0}),n.on("dragend",i=>{i.cancelBubble=!0}),n.on("mouseenter",()=>{var i=gi.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),o=CG(e,i,s);n.getStage().content&&(n.getStage().content.style.cursor=o),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){var e=new _G.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(n,r){var i=r.getParent(),s=i.padding();n.beginPath(),n.rect(-s,-s,r.width()+s*2,r.height()+s*2),n.moveTo(r.width()/2,-s),i.rotateEnabled()&&n.lineTo(r.width()/2,-i.rotateAnchorOffset()*pt.Util._sign(r.height())-s),n.fillStrokeShape(r)},hitFunc:(n,r)=>{if(this.shouldOverdrawWholeArea()){var i=this.padding();n.beginPath(),n.rect(-i,-i,r.width()+i*2,r.height()+i*2),n.fillStrokeShape(r)}}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){this._movingAnchorName=e.target.name().split(" ")[0];var n=this._getNodeRect(),r=n.width,i=n.height,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));this.sin=Math.abs(i/s),this.cos=Math.abs(r/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var o=e.target.getAbsolutePosition(),u=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-o.x,y:u.y-o.y},this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(c=>{c._fire("transformstart",{evt:e.evt,target:c})})}_handleMouseMove(e){var n,r,i,s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const u=o.getPointerPosition();let c={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y};const h=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(h,c,e)),s.setAbsolutePosition(c);const p=s.getAbsolutePosition();if(!(h.x===p.x&&h.y===p.y)){if(this._movingAnchorName==="rotater"){var m=this._getNodeRect();n=s.x()-m.width/2,r=-s.y()+m.height/2;let b=Math.atan2(-r,n)+Math.PI/2;m.height<0&&(b-=Math.PI);var _=gi.Konva.getAngle(this.rotation());const oe=_+b,ye=gi.Konva.getAngle(this.rotationSnapTolerance()),Pe=RG(this.rotationSnaps(),oe,ye)-m.rotation,J=PG(m,Pe);this._fitNodesInto(J,e);return}var E=this.shiftBehavior(),S;E==="inverted"?S=this.keepRatio()&&!e.shiftKey:E==="none"?S=this.keepRatio():S=this.keepRatio()||e.shiftKey;var w=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(S){var P=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(P.x-s.x(),2)+Math.pow(P.y-s.y(),2));var N=this.findOne(".top-left").x()>P.x?-1:1,R=this.findOne(".top-left").y()>P.y?-1:1;n=i*this.cos*N,r=i*this.sin*R,this.findOne(".top-left").x(P.x-n),this.findOne(".top-left").y(P.y-r)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(S){var P=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(s.x()-P.x,2)+Math.pow(P.y-s.y(),2));var N=this.findOne(".top-right").x()<P.x?-1:1,R=this.findOne(".top-right").y()>P.y?-1:1;n=i*this.cos*N,r=i*this.sin*R,this.findOne(".top-right").x(P.x+n),this.findOne(".top-right").y(P.y-r)}var k=s.position();this.findOne(".top-left").y(k.y),this.findOne(".bottom-right").x(k.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(S){var P=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(P.x-s.x(),2)+Math.pow(s.y()-P.y,2));var N=P.x<s.x()?-1:1,R=s.y()<P.y?-1:1;n=i*this.cos*N,r=i*this.sin*R,s.x(P.x-n),s.y(P.y+r)}k=s.position(),this.findOne(".top-left").x(k.x),this.findOne(".bottom-right").y(k.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(S){var P=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(s.x()-P.x,2)+Math.pow(s.y()-P.y,2));var N=this.findOne(".bottom-right").x()<P.x?-1:1,R=this.findOne(".bottom-right").y()<P.y?-1:1;n=i*this.cos*N,r=i*this.sin*R,this.findOne(".bottom-right").x(P.x+n),this.findOne(".bottom-right").y(P.y+r)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var w=this.centeredScaling()||e.altKey;if(w){var A=this.findOne(".top-left"),V=this.findOne(".bottom-right"),U=A.x(),O=A.y(),C=this.getWidth()-V.x(),D=this.getHeight()-V.y();V.move({x:-U,y:-O}),A.move({x:C,y:D})}var x=this.findOne(".top-left").getAbsolutePosition();n=x.x,r=x.y;var M=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),z=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:r,width:M,height:z,rotation:gi.Konva.getAngle(this.rotation())},e)}}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var n=this.getNode();this._fire("transformend",{evt:e,target:n}),n&&this._nodes.forEach(r=>{r._fire("transformend",{evt:e,target:r})}),this._movingAnchorName=null}}_fitNodesInto(e,n){var r=this._getNodeRect();const i=1;if(pt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(pt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}var s=new pt.Transform;if(s.rotate(gi.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const _=s.point({x:-this.padding()*2,y:0});e.x+=_.x,e.y+=_.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const _=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const _=s.point({x:0,y:-this.padding()*2});e.x+=_.x,e.y+=_.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const _=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=_.x,this._anchorDragOffset.y-=_.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const _=this.boundBoxFunc()(r,e);_?e=_:pt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,u=new pt.Transform;u.translate(r.x,r.y),u.rotate(r.rotation),u.scale(r.width/o,r.height/o);const c=new pt.Transform,h=e.width/o,p=e.height/o;this.flipEnabled()===!1?(c.translate(e.x,e.y),c.rotate(e.rotation),c.translate(e.width<0?e.width:0,e.height<0?e.height:0),c.scale(Math.abs(h),Math.abs(p))):(c.translate(e.x,e.y),c.rotate(e.rotation),c.scale(h,p));const m=c.multiply(u.invert());this._nodes.forEach(_=>{var E;const S=_.getParent().getAbsoluteTransform(),P=_.getTransform().copy();P.translate(_.offsetX(),_.offsetY());const N=new pt.Transform;N.multiply(S.copy().invert()).multiply(m).multiply(S).multiply(P);const R=N.decompose();_.setAttrs(R),this._fire("transform",{evt:n,target:_}),_._fire("transform",{evt:n,target:_}),(E=_.getLayer())===null||E===void 0||E.batchDraw()}),this.rotation(pt.Util._getRotation(e.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e,n=this._getNodeRect();this.rotation(pt.Util._getRotation(n.rotation));var r=n.width,i=n.height,s=this.enabledAnchors(),o=this.resizeEnabled(),u=this.padding(),c=this.anchorSize();const h=this.find("._anchor");h.forEach(m=>{m.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+u,offsetY:c/2+u,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+u,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-u,offsetY:c/2+u,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:c/2+u,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:i/2,offsetX:c/2-u,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:c/2+u,offsetY:c/2-u,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:i,offsetY:c/2-u,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:i,offsetX:c/2-u,offsetY:c/2-u,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*pt.Util._sign(i)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const p=this.anchorStyleFunc();p&&h.forEach(m=>{p(m)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),q3.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return $3.Node.prototype.toObject.call(this)}clone(e){var n=$3.Node.prototype.clone.call(this,e);return n}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}L0.Transformer=nt;function kG(t){return t instanceof Array||pt.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){gm.indexOf(e)===-1&&pt.Util.warn("Unknown anchor name: "+e+". Available names are: "+gm.join(", "))}),t||[]}nt.prototype.className="Transformer";(0,yG._registerNode)(nt);lt.Factory.addGetterSetter(nt,"enabledAnchors",gm,kG);lt.Factory.addGetterSetter(nt,"flipEnabled",!0,(0,ha.getBooleanValidator)());lt.Factory.addGetterSetter(nt,"resizeEnabled",!0);lt.Factory.addGetterSetter(nt,"anchorSize",10,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"rotateEnabled",!0);lt.Factory.addGetterSetter(nt,"rotationSnaps",[]);lt.Factory.addGetterSetter(nt,"rotateAnchorOffset",50,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"rotateAnchorCursor","crosshair");lt.Factory.addGetterSetter(nt,"rotationSnapTolerance",5,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"borderEnabled",!0);lt.Factory.addGetterSetter(nt,"anchorStroke","rgb(0, 161, 255)");lt.Factory.addGetterSetter(nt,"anchorStrokeWidth",1,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"anchorFill","white");lt.Factory.addGetterSetter(nt,"anchorCornerRadius",0,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"borderStroke","rgb(0, 161, 255)");lt.Factory.addGetterSetter(nt,"borderStrokeWidth",1,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"borderDash");lt.Factory.addGetterSetter(nt,"keepRatio",!0);lt.Factory.addGetterSetter(nt,"shiftBehavior","default");lt.Factory.addGetterSetter(nt,"centeredScaling",!1);lt.Factory.addGetterSetter(nt,"ignoreStroke",!1);lt.Factory.addGetterSetter(nt,"padding",0,(0,ha.getNumberValidator)());lt.Factory.addGetterSetter(nt,"node");lt.Factory.addGetterSetter(nt,"nodes");lt.Factory.addGetterSetter(nt,"boundBoxFunc");lt.Factory.addGetterSetter(nt,"anchorDragBoundFunc");lt.Factory.addGetterSetter(nt,"anchorStyleFunc");lt.Factory.addGetterSetter(nt,"shouldOverdrawWholeArea",!1);lt.Factory.addGetterSetter(nt,"useSingleNodeRotation",!0);lt.Factory.backCompat(nt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var b0={};Object.defineProperty(b0,"__esModule",{value:!0});b0.Wedge=void 0;const F0=Ue,AG=hn,xG=Ve,jR=Ee,NG=Ve;class to extends AG.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,xG.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}b0.Wedge=to;to.prototype.className="Wedge";to.prototype._centroid=!0;to.prototype._attrsAffectingSize=["radius"];(0,NG._registerNode)(to);F0.Factory.addGetterSetter(to,"radius",0,(0,jR.getNumberValidator)());F0.Factory.addGetterSetter(to,"angle",0,(0,jR.getNumberValidator)());F0.Factory.addGetterSetter(to,"clockwise",!1);F0.Factory.backCompat(to,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var V0={};Object.defineProperty(V0,"__esModule",{value:!0});V0.Blur=void 0;const Q3=Ue,DG=At,OG=Ee;function Y3(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var MG=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],LG=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function bG(t,e){var n=t.data,r=t.width,i=t.height,s,o,u,c,h,p,m,_,E,S,P,N,R,k,w,A,V,U,O,C,D,x,M,z,b=e+e+1,oe=r-1,ye=i-1,Te=e+1,Pe=Te*(Te+1)/2,J=new Y3,ue=null,te=J,le=null,_e=null,Ce=MG[e],Le=LG[e];for(u=1;u<b;u++)te=te.next=new Y3,u===Te&&(ue=te);for(te.next=J,m=p=0,o=0;o<i;o++){for(A=V=U=O=_=E=S=P=0,N=Te*(C=n[p]),R=Te*(D=n[p+1]),k=Te*(x=n[p+2]),w=Te*(M=n[p+3]),_+=Pe*C,E+=Pe*D,S+=Pe*x,P+=Pe*M,te=J,u=0;u<Te;u++)te.r=C,te.g=D,te.b=x,te.a=M,te=te.next;for(u=1;u<Te;u++)c=p+((oe<u?oe:u)<<2),_+=(te.r=C=n[c])*(z=Te-u),E+=(te.g=D=n[c+1])*z,S+=(te.b=x=n[c+2])*z,P+=(te.a=M=n[c+3])*z,A+=C,V+=D,U+=x,O+=M,te=te.next;for(le=J,_e=ue,s=0;s<r;s++)n[p+3]=M=P*Ce>>Le,M!==0?(M=255/M,n[p]=(_*Ce>>Le)*M,n[p+1]=(E*Ce>>Le)*M,n[p+2]=(S*Ce>>Le)*M):n[p]=n[p+1]=n[p+2]=0,_-=N,E-=R,S-=k,P-=w,N-=le.r,R-=le.g,k-=le.b,w-=le.a,c=m+((c=s+e+1)<oe?c:oe)<<2,A+=le.r=n[c],V+=le.g=n[c+1],U+=le.b=n[c+2],O+=le.a=n[c+3],_+=A,E+=V,S+=U,P+=O,le=le.next,N+=C=_e.r,R+=D=_e.g,k+=x=_e.b,w+=M=_e.a,A-=C,V-=D,U-=x,O-=M,_e=_e.next,p+=4;m+=r}for(s=0;s<r;s++){for(V=U=O=A=E=S=P=_=0,p=s<<2,N=Te*(C=n[p]),R=Te*(D=n[p+1]),k=Te*(x=n[p+2]),w=Te*(M=n[p+3]),_+=Pe*C,E+=Pe*D,S+=Pe*x,P+=Pe*M,te=J,u=0;u<Te;u++)te.r=C,te.g=D,te.b=x,te.a=M,te=te.next;for(h=r,u=1;u<=e;u++)p=h+s<<2,_+=(te.r=C=n[p])*(z=Te-u),E+=(te.g=D=n[p+1])*z,S+=(te.b=x=n[p+2])*z,P+=(te.a=M=n[p+3])*z,A+=C,V+=D,U+=x,O+=M,te=te.next,u<ye&&(h+=r);for(p=s,le=J,_e=ue,o=0;o<i;o++)c=p<<2,n[c+3]=M=P*Ce>>Le,M>0?(M=255/M,n[c]=(_*Ce>>Le)*M,n[c+1]=(E*Ce>>Le)*M,n[c+2]=(S*Ce>>Le)*M):n[c]=n[c+1]=n[c+2]=0,_-=N,E-=R,S-=k,P-=w,N-=le.r,R-=le.g,k-=le.b,w-=le.a,c=s+((c=o+Te)<ye?c:ye)*r<<2,_+=A+=le.r=n[c],E+=V+=le.g=n[c+1],S+=U+=le.b=n[c+2],P+=O+=le.a=n[c+3],le=le.next,N+=C=_e.r,R+=D=_e.g,k+=x=_e.b,w+=M=_e.a,A-=C,V-=D,U-=x,O-=M,_e=_e.next,p+=r}}const FG=function(e){var n=Math.round(this.blurRadius());n>0&&bG(e,n)};V0.Blur=FG;Q3.Factory.addGetterSetter(DG.Node,"blurRadius",0,(0,OG.getNumberValidator)(),Q3.Factory.afterSetFilter);var U0={};Object.defineProperty(U0,"__esModule",{value:!0});U0.Brighten=void 0;const X3=Ue,VG=At,UG=Ee,zG=function(t){var e=this.brightness()*255,n=t.data,r=n.length,i;for(i=0;i<r;i+=4)n[i]+=e,n[i+1]+=e,n[i+2]+=e};U0.Brighten=zG;X3.Factory.addGetterSetter(VG.Node,"brightness",0,(0,UG.getNumberValidator)(),X3.Factory.afterSetFilter);var z0={};Object.defineProperty(z0,"__esModule",{value:!0});z0.Contrast=void 0;const J3=Ue,BG=At,jG=Ee,GG=function(t){var e=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length,i=150,s=150,o=150,u;for(u=0;u<r;u+=4)i=n[u],s=n[u+1],o=n[u+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,i=i<0?0:i>255?255:i,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,n[u]=i,n[u+1]=s,n[u+2]=o};z0.Contrast=GG;J3.Factory.addGetterSetter(BG.Node,"contrast",0,(0,jG.getNumberValidator)(),J3.Factory.afterSetFilter);var B0={};Object.defineProperty(B0,"__esModule",{value:!0});B0.Emboss=void 0;const ta=Ue,j0=At,WG=Lt,GR=Ee,HG=function(t){var e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,r=this.embossDirection(),i=this.embossBlend(),s=0,o=0,u=t.data,c=t.width,h=t.height,p=c*4,m=h;switch(r){case"top-left":s=-1,o=-1;break;case"top":s=-1,o=0;break;case"top-right":s=-1,o=1;break;case"right":s=0,o=1;break;case"bottom-right":s=1,o=1;break;case"bottom":s=1,o=0;break;case"bottom-left":s=1,o=-1;break;case"left":s=0,o=-1;break;default:WG.Util.error("Unknown emboss direction: "+r)}do{var _=(m-1)*p,E=s;m+E<1&&(E=0),m+E>h&&(E=0);var S=(m-1+E)*c*4,P=c;do{var N=_+(P-1)*4,R=o;P+R<1&&(R=0),P+R>c&&(R=0);var k=S+(P-1+R)*4,w=u[N]-u[k],A=u[N+1]-u[k+1],V=u[N+2]-u[k+2],U=w,O=U>0?U:-U,C=A>0?A:-A,D=V>0?V:-V;if(C>O&&(U=A),D>O&&(U=V),U*=e,i){var x=u[N]+U,M=u[N+1]+U,z=u[N+2]+U;u[N]=x>255?255:x<0?0:x,u[N+1]=M>255?255:M<0?0:M,u[N+2]=z>255?255:z<0?0:z}else{var b=n-U;b<0?b=0:b>255&&(b=255),u[N]=u[N+1]=u[N+2]=b}}while(--P)}while(--m)};B0.Emboss=HG;ta.Factory.addGetterSetter(j0.Node,"embossStrength",.5,(0,GR.getNumberValidator)(),ta.Factory.afterSetFilter);ta.Factory.addGetterSetter(j0.Node,"embossWhiteLevel",.5,(0,GR.getNumberValidator)(),ta.Factory.afterSetFilter);ta.Factory.addGetterSetter(j0.Node,"embossDirection","top-left",null,ta.Factory.afterSetFilter);ta.Factory.addGetterSetter(j0.Node,"embossBlend",!1,null,ta.Factory.afterSetFilter);var G0={};Object.defineProperty(G0,"__esModule",{value:!0});G0.Enhance=void 0;const Z3=Ue,$G=At,qG=Ee;function ly(t,e,n,r,i){var s=n-e,o=i-r,u;return s===0?r+o/2:o===0?r:(u=(t-e)/s,u=o*u+r,u)}const KG=function(t){var e=t.data,n=e.length,r=e[0],i=r,s,o=e[1],u=o,c,h=e[2],p=h,m,_,E=this.enhance();if(E!==0){for(_=0;_<n;_+=4)s=e[_+0],s<r?r=s:s>i&&(i=s),c=e[_+1],c<o?o=c:c>u&&(u=c),m=e[_+2],m<h?h=m:m>p&&(p=m);i===r&&(i=255,r=0),u===o&&(u=255,o=0),p===h&&(p=255,h=0);var S,P,N,R,k,w,A,V,U;for(E>0?(P=i+E*(255-i),N=r-E*(r-0),k=u+E*(255-u),w=o-E*(o-0),V=p+E*(255-p),U=h-E*(h-0)):(S=(i+r)*.5,P=i+E*(i-S),N=r+E*(r-S),R=(u+o)*.5,k=u+E*(u-R),w=o+E*(o-R),A=(p+h)*.5,V=p+E*(p-A),U=h+E*(h-A)),_=0;_<n;_+=4)e[_+0]=ly(e[_+0],r,i,N,P),e[_+1]=ly(e[_+1],o,u,w,k),e[_+2]=ly(e[_+2],h,p,U,V)}};G0.Enhance=KG;Z3.Factory.addGetterSetter($G.Node,"enhance",0,(0,qG.getNumberValidator)(),Z3.Factory.afterSetFilter);var W0={};Object.defineProperty(W0,"__esModule",{value:!0});W0.Grayscale=void 0;const QG=function(t){var e=t.data,n=e.length,r,i;for(r=0;r<n;r+=4)i=.34*e[r]+.5*e[r+1]+.16*e[r+2],e[r]=i,e[r+1]=i,e[r+2]=i};W0.Grayscale=QG;var H0={};Object.defineProperty(H0,"__esModule",{value:!0});H0.HSL=void 0;const Ku=Ue,BE=At,jE=Ee;Ku.Factory.addGetterSetter(BE.Node,"hue",0,(0,jE.getNumberValidator)(),Ku.Factory.afterSetFilter);Ku.Factory.addGetterSetter(BE.Node,"saturation",0,(0,jE.getNumberValidator)(),Ku.Factory.afterSetFilter);Ku.Factory.addGetterSetter(BE.Node,"luminance",0,(0,jE.getNumberValidator)(),Ku.Factory.afterSetFilter);const YG=function(t){var e=t.data,n=e.length,r=1,i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,u,c=r*i*Math.cos(s*Math.PI/180),h=r*i*Math.sin(s*Math.PI/180),p=.299*r+.701*c+.167*h,m=.587*r-.587*c+.33*h,_=.114*r-.114*c-.497*h,E=.299*r-.299*c-.328*h,S=.587*r+.413*c+.035*h,P=.114*r-.114*c+.293*h,N=.299*r-.3*c+1.25*h,R=.587*r-.586*c-1.05*h,k=.114*r+.886*c-.2*h,w,A,V,U;for(u=0;u<n;u+=4)w=e[u+0],A=e[u+1],V=e[u+2],U=e[u+3],e[u+0]=p*w+m*A+_*V+o,e[u+1]=E*w+S*A+P*V+o,e[u+2]=N*w+R*A+k*V+o,e[u+3]=U};H0.HSL=YG;var $0={};Object.defineProperty($0,"__esModule",{value:!0});$0.HSV=void 0;const Qu=Ue,GE=At,WE=Ee,XG=function(t){var e=t.data,n=e.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o,u=r*i*Math.cos(s*Math.PI/180),c=r*i*Math.sin(s*Math.PI/180),h=.299*r+.701*u+.167*c,p=.587*r-.587*u+.33*c,m=.114*r-.114*u-.497*c,_=.299*r-.299*u-.328*c,E=.587*r+.413*u+.035*c,S=.114*r-.114*u+.293*c,P=.299*r-.3*u+1.25*c,N=.587*r-.586*u-1.05*c,R=.114*r+.886*u-.2*c,k,w,A,V;for(o=0;o<n;o+=4)k=e[o+0],w=e[o+1],A=e[o+2],V=e[o+3],e[o+0]=h*k+p*w+m*A,e[o+1]=_*k+E*w+S*A,e[o+2]=P*k+N*w+R*A,e[o+3]=V};$0.HSV=XG;Qu.Factory.addGetterSetter(GE.Node,"hue",0,(0,WE.getNumberValidator)(),Qu.Factory.afterSetFilter);Qu.Factory.addGetterSetter(GE.Node,"saturation",0,(0,WE.getNumberValidator)(),Qu.Factory.afterSetFilter);Qu.Factory.addGetterSetter(GE.Node,"value",0,(0,WE.getNumberValidator)(),Qu.Factory.afterSetFilter);var q0={};Object.defineProperty(q0,"__esModule",{value:!0});q0.Invert=void 0;const JG=function(t){var e=t.data,n=e.length,r;for(r=0;r<n;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};q0.Invert=JG;var K0={};Object.defineProperty(K0,"__esModule",{value:!0});K0.Kaleidoscope=void 0;const mm=Ue,WR=At,e5=Lt,HR=Ee;var ZG=function(t,e,n){var r=t.data,i=e.data,s=t.width,o=t.height,u=n.polarCenterX||s/2,c=n.polarCenterY||o/2,h,p,m,_=0,E=0,S=0,P=0,N,R=Math.sqrt(u*u+c*c);p=s-u,m=o-c,N=Math.sqrt(p*p+m*m),R=N>R?N:R;var k=o,w=s,A,V,U=360/w*Math.PI/180,O,C;for(V=0;V<w;V+=1)for(O=Math.sin(V*U),C=Math.cos(V*U),A=0;A<k;A+=1)p=Math.floor(u+R*A/k*C),m=Math.floor(c+R*A/k*O),h=(m*s+p)*4,_=r[h+0],E=r[h+1],S=r[h+2],P=r[h+3],h=(V+A*s)*4,i[h+0]=_,i[h+1]=E,i[h+2]=S,i[h+3]=P},eW=function(t,e,n){var r=t.data,i=e.data,s=t.width,o=t.height,u=n.polarCenterX||s/2,c=n.polarCenterY||o/2,h,p,m,_,E,S=0,P=0,N=0,R=0,k,w=Math.sqrt(u*u+c*c);p=s-u,m=o-c,k=Math.sqrt(p*p+m*m),w=k>w?k:w;var A=o,V=s,U,O,C=0,D,x;for(p=0;p<s;p+=1)for(m=0;m<o;m+=1)_=p-u,E=m-c,U=Math.sqrt(_*_+E*E)*A/w,O=(Math.atan2(E,_)*180/Math.PI+360+C)%360,O=O*V/360,D=Math.floor(O),x=Math.floor(U),h=(x*s+D)*4,S=r[h+0],P=r[h+1],N=r[h+2],R=r[h+3],h=(m*s+p)*4,i[h+0]=S,i[h+1]=P,i[h+2]=N,i[h+3]=R};const tW=function(t){var e=t.width,n=t.height,r,i,s,o,u,c,h,p,m,_,E=Math.round(this.kaleidoscopePower()),S=Math.round(this.kaleidoscopeAngle()),P=Math.floor(e*(S%360)/360);if(!(E<1)){var N=e5.Util.createCanvasElement();N.width=e,N.height=n;var R=N.getContext("2d").getImageData(0,0,e,n);e5.Util.releaseCanvas(N),ZG(t,R,{polarCenterX:e/2,polarCenterY:n/2});for(var k=e/Math.pow(2,E);k<=8;)k=k*2,E-=1;k=Math.ceil(k);var w=k,A=0,V=w,U=1;for(P+k>e&&(A=w,V=0,U=-1),i=0;i<n;i+=1)for(r=A;r!==V;r+=U)s=Math.round(r+P)%e,m=(e*i+s)*4,u=R.data[m+0],c=R.data[m+1],h=R.data[m+2],p=R.data[m+3],_=(e*i+r)*4,R.data[_+0]=u,R.data[_+1]=c,R.data[_+2]=h,R.data[_+3]=p;for(i=0;i<n;i+=1)for(w=Math.floor(k),o=0;o<E;o+=1){for(r=0;r<w+1;r+=1)m=(e*i+r)*4,u=R.data[m+0],c=R.data[m+1],h=R.data[m+2],p=R.data[m+3],_=(e*i+w*2-r-1)*4,R.data[_+0]=u,R.data[_+1]=c,R.data[_+2]=h,R.data[_+3]=p;w*=2}eW(R,t,{})}};K0.Kaleidoscope=tW;mm.Factory.addGetterSetter(WR.Node,"kaleidoscopePower",2,(0,HR.getNumberValidator)(),mm.Factory.afterSetFilter);mm.Factory.addGetterSetter(WR.Node,"kaleidoscopeAngle",0,(0,HR.getNumberValidator)(),mm.Factory.afterSetFilter);var Q0={};Object.defineProperty(Q0,"__esModule",{value:!0});Q0.Mask=void 0;const t5=Ue,nW=At,rW=Ee;function bp(t,e,n){var r=(n*t.width+e)*4,i=[];return i.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),i}function ph(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function iW(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function sW(t,e){var n=bp(t,0,0),r=bp(t,t.width-1,0),i=bp(t,0,t.height-1),s=bp(t,t.width-1,t.height-1),o=e||10;if(ph(n,r)<o&&ph(r,s)<o&&ph(s,i)<o&&ph(i,n)<o){for(var u=iW([r,n,s,i]),c=[],h=0;h<t.width*t.height;h++){var p=ph(u,[t.data[h*4],t.data[h*4+1],t.data[h*4+2]]);c[h]=p<o?0:255}return c}}function oW(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function aW(t,e,n){for(var r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[],u=0;u<n;u++)for(var c=0;c<e;c++){for(var h=u*e+c,p=0,m=0;m<i;m++)for(var _=0;_<i;_++){var E=u+m-s,S=c+_-s;if(E>=0&&E<n&&S>=0&&S<e){var P=E*e+S,N=r[m*i+_];p+=t[P]*N}}o[h]=p===255*8?255:0}return o}function lW(t,e,n){for(var r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[],u=0;u<n;u++)for(var c=0;c<e;c++){for(var h=u*e+c,p=0,m=0;m<i;m++)for(var _=0;_<i;_++){var E=u+m-s,S=c+_-s;if(E>=0&&E<n&&S>=0&&S<e){var P=E*e+S,N=r[m*i+_];p+=t[P]*N}}o[h]=p>=255*4?255:0}return o}function uW(t,e,n){for(var r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(r.length)),s=Math.floor(i/2),o=[],u=0;u<n;u++)for(var c=0;c<e;c++){for(var h=u*e+c,p=0,m=0;m<i;m++)for(var _=0;_<i;_++){var E=u+m-s,S=c+_-s;if(E>=0&&E<n&&S>=0&&S<e){var P=E*e+S,N=r[m*i+_];p+=t[P]*N}}o[h]=p}return o}const cW=function(t){var e=this.threshold(),n=sW(t,e);return n&&(n=aW(n,t.width,t.height),n=lW(n,t.width,t.height),n=uW(n,t.width,t.height),oW(t,n)),t};Q0.Mask=cW;t5.Factory.addGetterSetter(nW.Node,"threshold",0,(0,rW.getNumberValidator)(),t5.Factory.afterSetFilter);var Y0={};Object.defineProperty(Y0,"__esModule",{value:!0});Y0.Noise=void 0;const n5=Ue,hW=At,dW=Ee,fW=function(t){var e=this.noise()*255,n=t.data,r=n.length,i=e/2,s;for(s=0;s<r;s+=4)n[s+0]+=i-2*i*Math.random(),n[s+1]+=i-2*i*Math.random(),n[s+2]+=i-2*i*Math.random()};Y0.Noise=fW;n5.Factory.addGetterSetter(hW.Node,"noise",.2,(0,dW.getNumberValidator)(),n5.Factory.afterSetFilter);var X0={};Object.defineProperty(X0,"__esModule",{value:!0});X0.Pixelate=void 0;const r5=Ue,pW=Lt,gW=At,mW=Ee,_W=function(t){var e=Math.ceil(this.pixelSize()),n=t.width,r=t.height,i,s,o,u,c,h,p,m=Math.ceil(n/e),_=Math.ceil(r/e),E,S,P,N,R,k,w,A=t.data;if(e<=0){pW.Util.error("pixelSize value can not be <= 0");return}for(R=0;R<m;R+=1)for(k=0;k<_;k+=1){for(u=0,c=0,h=0,p=0,E=R*e,S=E+e,P=k*e,N=P+e,w=0,i=E;i<S;i+=1)if(!(i>=n))for(s=P;s<N;s+=1)s>=r||(o=(n*s+i)*4,u+=A[o+0],c+=A[o+1],h+=A[o+2],p+=A[o+3],w+=1);for(u=u/w,c=c/w,h=h/w,p=p/w,i=E;i<S;i+=1)if(!(i>=n))for(s=P;s<N;s+=1)s>=r||(o=(n*s+i)*4,A[o+0]=u,A[o+1]=c,A[o+2]=h,A[o+3]=p)}};X0.Pixelate=_W;r5.Factory.addGetterSetter(gW.Node,"pixelSize",8,(0,mW.getNumberValidator)(),r5.Factory.afterSetFilter);var J0={};Object.defineProperty(J0,"__esModule",{value:!0});J0.Posterize=void 0;const i5=Ue,vW=At,yW=Ee,wW=function(t){var e=Math.round(this.levels()*254)+1,n=t.data,r=n.length,i=255/e,s;for(s=0;s<r;s+=1)n[s]=Math.floor(n[s]/i)*i};J0.Posterize=wW;i5.Factory.addGetterSetter(vW.Node,"levels",.5,(0,yW.getNumberValidator)(),i5.Factory.afterSetFilter);var Z0={};Object.defineProperty(Z0,"__esModule",{value:!0});Z0.RGB=void 0;const _m=Ue,HE=At,EW=Ee,SW=function(t){var e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue(),o,u;for(o=0;o<n;o+=4)u=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255,e[o]=u*r,e[o+1]=u*i,e[o+2]=u*s,e[o+3]=e[o+3]};Z0.RGB=SW;_m.Factory.addGetterSetter(HE.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});_m.Factory.addGetterSetter(HE.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});_m.Factory.addGetterSetter(HE.Node,"blue",0,EW.RGBComponent,_m.Factory.afterSetFilter);var e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.RGBA=void 0;const Rd=Ue,t_=At,TW=Ee,CW=function(t){var e=t.data,n=e.length,r=this.red(),i=this.green(),s=this.blue(),o=this.alpha(),u,c;for(u=0;u<n;u+=4)c=1-o,e[u]=r*o+e[u]*c,e[u+1]=i*o+e[u+1]*c,e[u+2]=s*o+e[u+2]*c};e_.RGBA=CW;Rd.Factory.addGetterSetter(t_.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Rd.Factory.addGetterSetter(t_.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Rd.Factory.addGetterSetter(t_.Node,"blue",0,TW.RGBComponent,Rd.Factory.afterSetFilter);Rd.Factory.addGetterSetter(t_.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var n_={};Object.defineProperty(n_,"__esModule",{value:!0});n_.Sepia=void 0;const IW=function(t){var e=t.data,n=e.length,r,i,s,o;for(r=0;r<n;r+=4)i=e[r+0],s=e[r+1],o=e[r+2],e[r+0]=Math.min(255,i*.393+s*.769+o*.189),e[r+1]=Math.min(255,i*.349+s*.686+o*.168),e[r+2]=Math.min(255,i*.272+s*.534+o*.131)};n_.Sepia=IW;var r_={};Object.defineProperty(r_,"__esModule",{value:!0});r_.Solarize=void 0;const PW=function(t){var e=t.data,n=t.width,r=t.height,i=n*4,s=r;do{var o=(s-1)*i,u=n;do{var c=o+(u-1)*4,h=e[c],p=e[c+1],m=e[c+2];h>127&&(h=255-h),p>127&&(p=255-p),m>127&&(m=255-m),e[c]=h,e[c+1]=p,e[c+2]=m}while(--u)}while(--s)};r_.Solarize=PW;var i_={};Object.defineProperty(i_,"__esModule",{value:!0});i_.Threshold=void 0;const s5=Ue,RW=At,kW=Ee,AW=function(t){var e=this.threshold()*255,n=t.data,r=n.length,i;for(i=0;i<r;i+=1)n[i]=n[i]<e?0:255};i_.Threshold=AW;s5.Factory.addGetterSetter(RW.Node,"threshold",.5,(0,kW.getNumberValidator)(),s5.Factory.afterSetFilter);Object.defineProperty(f0,"__esModule",{value:!0});f0.Konva=void 0;const o5=fm,xW=y0,NW=S0,DW=I0,OW=P0,MW=R0,a5=qu,LW=ef,bW=mc,FW=nf,VW=x0,UW=N0,zW=D0,BW=O0,jW=ol,GW=M0,WW=L0,HW=b0,$W=V0,qW=U0,KW=z0,QW=B0,YW=G0,XW=W0,JW=H0,ZW=$0,eH=q0,tH=K0,nH=Q0,rH=Y0,iH=X0,sH=J0,oH=Z0,aH=e_,lH=n_,uH=r_,cH=i_;f0.Konva=o5.Konva.Util._assign(o5.Konva,{Arc:xW.Arc,Arrow:NW.Arrow,Circle:DW.Circle,Ellipse:OW.Ellipse,Image:MW.Image,Label:a5.Label,Tag:a5.Tag,Line:LW.Line,Path:bW.Path,Rect:FW.Rect,RegularPolygon:VW.RegularPolygon,Ring:UW.Ring,Sprite:zW.Sprite,Star:BW.Star,Text:jW.Text,TextPath:GW.TextPath,Transformer:WW.Transformer,Wedge:HW.Wedge,Filters:{Blur:$W.Blur,Brighten:qW.Brighten,Contrast:KW.Contrast,Emboss:QW.Emboss,Enhance:YW.Enhance,Grayscale:XW.Grayscale,HSL:JW.HSL,HSV:ZW.HSV,Invert:eH.Invert,Kaleidoscope:tH.Kaleidoscope,Mask:nH.Mask,Noise:rH.Noise,Pixelate:iH.Pixelate,Posterize:sH.Posterize,RGB:oH.RGB,RGBA:aH.RGBA,Sepia:lH.Sepia,Solarize:uH.Solarize,Threshold:cH.Threshold}});var hH=cR.exports;Object.defineProperty(hH,"__esModule",{value:!0});const dH=f0;cR.exports=dH.Konva;var e2={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=fm;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const r=fm;t.exports=r.Konva})(e2,e2.exports);var fH=e2.exports;const kd=t2(fH);var $R={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pH=function(e){var n={},r=X,i=Ih,s=Object.assign;function o(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),S=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),V=Symbol.iterator;function U(a){return a===null||typeof a!="object"?null:(a=V&&a[V]||a["@@iterator"],typeof a=="function"?a:null)}function O(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case p:return"Fragment";case h:return"Portal";case _:return"Profiler";case m:return"StrictMode";case N:return"Suspense";case R:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Consumer";case E:return(a._context.displayName||"Context")+".Provider";case P:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case k:return l=a.displayName||null,l!==null?l:O(a.type)||"Memo";case w:l=a._payload,a=a._init;try{return O(a(l))}catch{}}return null}function C(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O(l);case 8:return l===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function D(a){var l=a,f=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,l.flags&4098&&(f=l.return),a=l.return;while(a)}return l.tag===3?f:null}function x(a){if(D(a)!==a)throw Error(o(188))}function M(a){var l=a.alternate;if(!l){if(l=D(a),l===null)throw Error(o(188));return l!==a?null:a}for(var f=a,g=l;;){var v=f.return;if(v===null)break;var T=v.alternate;if(T===null){if(g=v.return,g!==null){f=g;continue}break}if(v.child===T.child){for(T=v.child;T;){if(T===f)return x(v),a;if(T===g)return x(v),l;T=T.sibling}throw Error(o(188))}if(f.return!==g.return)f=v,g=T;else{for(var F=!1,j=v.child;j;){if(j===f){F=!0,f=v,g=T;break}if(j===g){F=!0,g=v,f=T;break}j=j.sibling}if(!F){for(j=T.child;j;){if(j===f){F=!0,f=T,g=v;break}if(j===g){F=!0,g=T,f=v;break}j=j.sibling}if(!F)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?a:l}function z(a){return a=M(a),a!==null?b(a):null}function b(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=b(a);if(l!==null)return l;a=a.sibling}return null}function oe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var l=oe(a);if(l!==null)return l}a=a.sibling}return null}var ye=Array.isArray,Te=e.getPublicInstance,Pe=e.getRootHostContext,J=e.getChildHostContext,ue=e.prepareForCommit,te=e.resetAfterCommit,le=e.createInstance,_e=e.appendInitialChild,Ce=e.finalizeInitialChildren,Le=e.prepareUpdate,yt=e.shouldSetTextContent,ut=e.createTextInstance,B=e.scheduleTimeout,Y=e.cancelTimeout,re=e.noTimeout,ve=e.isPrimaryRenderer,de=e.supportsMutation,be=e.supportsPersistence,He=e.supportsHydration,Bt=e.getInstanceFromNode,Xe=e.preparePortalMount,mr=e.getCurrentEventPriority,Pn=e.detachDeletedInstance,Br=e.supportsMicrotasks,rf=e.scheduleMicrotask,os=e.supportsTestSelectors,sf=e.findFiberRoot,o_=e.getBoundingRect,vc=e.getTextContent,as=e.isHiddenSubtree,of=e.matchAccessibilityRole,fn=e.setFocusIfFocusable,Rn=e.setupIntersectionObserver,Tl=e.appendChild,af=e.appendChildToContainer,lf=e.commitTextUpdate,a_=e.commitMount,fa=e.commitUpdate,uf=e.insertBefore,cf=e.insertInContainerBefore,yc=e.removeChild,l_=e.removeChildFromContainer,hf=e.resetTextContent,wc=e.hideInstance,df=e.hideTextInstance,ff=e.unhideInstance,pa=e.unhideTextInstance,Ec=e.clearContainer,Sc=e.cloneInstance,Ni=e.createContainerChildSet,Tc=e.appendChildToContainerChildSet,Cl=e.finalizeContainerChildren,Il=e.replaceContainerChildren,no=e.cloneHiddenInstance,Cc=e.cloneHiddenTextInstance,kn=e.canHydrateInstance,pf=e.canHydrateTextInstance,ga=e.canHydrateSuspenseInstance,ro=e.isSuspenseInstancePending,Ic=e.isSuspenseInstanceFallback,u_=e.getSuspenseInstanceFallbackErrorDetails,io=e.registerSuspenseInstanceRetry,Pl=e.getNextHydratableSibling,c_=e.getFirstHydratableChild,Rl=e.getFirstHydratableChildWithinContainer,gf=e.getFirstHydratableChildWithinSuspenseInstance,Pc=e.hydrateInstance,kl=e.hydrateTextInstance,Di=e.hydrateSuspenseInstance,mf=e.getNextHydratableInstanceAfterSuspenseInstance,_f=e.commitHydratedContainer,Rc=e.commitHydratedSuspenseInstance,kc=e.clearSuspenseBoundary,vf=e.clearSuspenseBoundaryFromContainer,yf=e.shouldDeleteUnhydratedTailInstances,h_=e.didNotMatchHydratedContainerTextInstance,Al=e.didNotMatchHydratedTextInstance,xl;function ls(a){if(xl===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);xl=l&&l[1]||""}return`
`+xl+a}var us=!1;function si(a,l){if(!a||us)return"";us=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ie){var g=ie}Reflect.construct(a,[],l)}else{try{l.call()}catch(ie){g=ie}a.call(l.prototype)}else{try{throw Error()}catch(ie){g=ie}a()}}catch(ie){if(ie&&g&&typeof ie.stack=="string"){for(var v=ie.stack.split(`
`),T=g.stack.split(`
`),F=v.length-1,j=T.length-1;1<=F&&0<=j&&v[F]!==T[j];)j--;for(;1<=F&&0<=j;F--,j--)if(v[F]!==T[j]){if(F!==1||j!==1)do if(F--,j--,0>j||v[F]!==T[j]){var $=`
`+v[F].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=F&&0<=j);break}}}finally{us=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?ls(a):""}var Ac=Object.prototype.hasOwnProperty,xc=[],cs=-1;function oi(a){return{current:a}}function dt(a){0>cs||(a.current=xc[cs],xc[cs]=null,cs--)}function at(a,l){cs++,xc[cs]=a.current,a.current=l}var jr={},tn=oi(jr),An=oi(!1),hs=jr;function so(a,l){var f=a.type.contextTypes;if(!f)return jr;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var v={},T;for(T in f)v[T]=l[T];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=v),v}function xn(a){return a=a.childContextTypes,a!=null}function ma(){dt(An),dt(tn)}function wf(a,l,f){if(tn.current!==jr)throw Error(o(168));at(tn,l),at(An,f)}function Oi(a,l,f){var g=a.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var v in g)if(!(v in l))throw Error(o(108,C(a)||"Unknown",v));return s({},f,g)}function _r(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||jr,hs=tn.current,at(tn,a),at(An,An.current),!0}function _a(a,l,f){var g=a.stateNode;if(!g)throw Error(o(169));f?(a=Oi(a,l,hs),g.__reactInternalMemoizedMergedChildContext=a,dt(An),dt(tn),at(tn,a)):dt(An),at(An,f)}var Gn=Math.clz32?Math.clz32:Nl,Ef=Math.log,mt=Math.LN2;function Nl(a){return a>>>=0,a===0?32:31-(Ef(a)/mt|0)|0}var Mi=64,Li=4194304;function va(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ya(a,l){var f=a.pendingLanes;if(f===0)return 0;var g=0,v=a.suspendedLanes,T=a.pingedLanes,F=f&268435455;if(F!==0){var j=F&~v;j!==0?g=va(j):(T&=F,T!==0&&(g=va(T)))}else F=f&~v,F!==0?g=va(F):T!==0&&(g=va(T));if(g===0)return 0;if(l!==0&&l!==g&&!(l&v)&&(v=g&-g,T=l&-l,v>=T||v===16&&(T&4194240)!==0))return l;if(g&4&&(g|=f&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=g;0<l;)f=31-Gn(l),v=1<<f,g|=a[f],l&=~v;return g}function d_(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function f_(a,l){for(var f=a.suspendedLanes,g=a.pingedLanes,v=a.expirationTimes,T=a.pendingLanes;0<T;){var F=31-Gn(T),j=1<<F,$=v[F];$===-1?(!(j&f)||j&g)&&(v[F]=d_(j,l)):$<=l&&(a.expiredLanes|=j),T&=~j}}function Nc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Sf(){var a=Mi;return Mi<<=1,!(Mi&4194240)&&(Mi=64),a}function ds(a){for(var l=[],f=0;31>f;f++)l.push(a);return l}function vr(a,l,f){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Gn(l),a[l]=f}function Tf(a,l){var f=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var v=31-Gn(f),T=1<<v;l[v]=0,g[v]=-1,a[v]=-1,f&=~T}}function Dl(a,l){var f=a.entangledLanes|=l;for(a=a.entanglements;f;){var g=31-Gn(f),v=1<<g;v&l|a[g]&l&&(a[g]|=l),f&=~v}}var Ye=0;function fs(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var Dc=i.unstable_scheduleCallback,Cf=i.unstable_cancelCallback,p_=i.unstable_shouldYield,bi=i.unstable_requestPaint,Kt=i.unstable_now,Oc=i.unstable_ImmediatePriority,Ol=i.unstable_UserBlockingPriority,oo=i.unstable_NormalPriority,If=i.unstable_IdlePriority,Fi=null,Wn=null;function Pf(a){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(Fi,a,void 0,(a.current.flags&128)===128)}catch{}}function Mc(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Je=typeof Object.is=="function"?Object.is:Mc,ai=null,Ml=!1,Ll=!1;function Lc(a){ai===null?ai=[a]:ai.push(a)}function Rf(a){Ml=!0,Lc(a)}function or(){if(!Ll&&ai!==null){Ll=!0;var a=0,l=Ye;try{var f=ai;for(Ye=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}ai=null,Ml=!1}catch(v){throw ai!==null&&(ai=ai.slice(a+1)),Dc(Oc,or),v}finally{Ye=l,Ll=!1}}return null}var ps=[],Hn=0,wa=null,bl=0,pn=[],ar=0,li=null,yr=1,Gr="";function Wr(a,l){ps[Hn++]=bl,ps[Hn++]=wa,wa=a,bl=l}function kf(a,l,f){pn[ar++]=yr,pn[ar++]=Gr,pn[ar++]=li,li=a;var g=yr;a=Gr;var v=32-Gn(g)-1;g&=~(1<<v),f+=1;var T=32-Gn(l)+v;if(30<T){var F=v-v%5;T=(g&(1<<F)-1).toString(32),g>>=F,v-=F,yr=1<<32-Gn(l)+v|f<<v|g,Gr=T+a}else yr=1<<T|f<<v|g,Gr=a}function Fl(a){a.return!==null&&(Wr(a,1),kf(a,1,0))}function gs(a){for(;a===wa;)wa=ps[--Hn],ps[Hn]=null,bl=ps[--Hn],ps[Hn]=null;for(;a===li;)li=pn[--ar],pn[ar]=null,Gr=pn[--ar],pn[ar]=null,yr=pn[--ar],pn[ar]=null}var $n=null,lr=null,ft=!1,ms=!1,wr=null;function Ea(a,l){var f=Qr(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=a,l=a.deletions,l===null?(a.deletions=[f],a.flags|=16):l.push(f)}function bc(a,l){switch(a.tag){case 5:return l=kn(l,a.type,a.pendingProps),l!==null?(a.stateNode=l,$n=a,lr=c_(l),!0):!1;case 6:return l=pf(l,a.pendingProps),l!==null?(a.stateNode=l,$n=a,lr=null,!0):!1;case 13:if(l=ga(l),l!==null){var f=li!==null?{id:yr,overflow:Gr}:null;return a.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=Qr(18,null,null,0),f.stateNode=l,f.return=a,a.child=f,$n=a,lr=null,!0}return!1;default:return!1}}function Vl(a){return(a.mode&1)!==0&&(a.flags&128)===0}function ui(a){if(ft){var l=lr;if(l){var f=l;if(!bc(a,l)){if(Vl(a))throw Error(o(418));l=Pl(f);var g=$n;l&&bc(a,l)?Ea(g,f):(a.flags=a.flags&-4097|2,ft=!1,$n=a)}}else{if(Vl(a))throw Error(o(418));a.flags=a.flags&-4097|2,ft=!1,$n=a}}}function Fc(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;$n=a}function Sa(a){if(!He||a!==$n)return!1;if(!ft)return Fc(a),ft=!0,!1;if(a.tag!==3&&(a.tag!==5||yf(a.type)&&!yt(a.type,a.memoizedProps))){var l=lr;if(l){if(Vl(a))throw Vc(),Error(o(418));for(;l;)Ea(a,l),l=Pl(l)}}if(Fc(a),a.tag===13){if(!He)throw Error(o(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(o(317));lr=mf(a)}else lr=$n?Pl(a.stateNode):null;return!0}function Vc(){for(var a=lr;a;)a=Pl(a)}function _s(){He&&(lr=$n=null,ms=ft=!1)}function ao(a){wr===null?wr=[a]:wr.push(a)}var ur=u.ReactCurrentBatchConfig;function Ta(a,l){if(Je(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var f=Object.keys(a),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var v=f[g];if(!Ac.call(l,v)||!Je(a[v],l[v]))return!1}return!0}function Af(a){switch(a.tag){case 5:return ls(a.type);case 16:return ls("Lazy");case 13:return ls("Suspense");case 19:return ls("SuspenseList");case 0:case 2:case 15:return a=si(a.type,!1),a;case 11:return a=si(a.type.render,!1),a;case 1:return a=si(a.type,!0),a;default:return""}}function Hr(a,l,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,a));var v=g,T=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===T?l.ref:(l=function(F){var j=v.refs;F===null?delete j[T]:j[T]=F},l._stringRef=T,l)}if(typeof a!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,a))}return a}function d(a,l){throw a=Object.prototype.toString.call(l),Error(o(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function y(a){var l=a._init;return l(a._payload)}function I(a){function l(H,G){if(a){var Q=H.deletions;Q===null?(H.deletions=[G],H.flags|=16):Q.push(G)}}function f(H,G){if(!a)return null;for(;G!==null;)l(H,G),G=G.sibling;return null}function g(H,G){for(H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function v(H,G){return H=go(H,G),H.index=0,H.sibling=null,H}function T(H,G,Q){return H.index=Q,a?(Q=H.alternate,Q!==null?(Q=Q.index,Q<G?(H.flags|=2,G):Q):(H.flags|=2,G)):(H.flags|=1048576,G)}function F(H){return a&&H.alternate===null&&(H.flags|=2),H}function j(H,G,Q,he){return G===null||G.tag!==6?(G=sv(Q,H.mode,he),G.return=H,G):(G=v(G,Q),G.return=H,G)}function $(H,G,Q,he){var Ie=Q.type;return Ie===p?me(H,G,Q.props.children,he,Q.key):G!==null&&(G.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===w&&y(Ie)===G.type)?(he=v(G,Q.props),he.ref=Hr(H,G,Q),he.return=H,he):(he=ip(Q.type,Q.key,Q.props,null,H.mode,he),he.ref=Hr(H,G,Q),he.return=H,he)}function ie(H,G,Q,he){return G===null||G.tag!==4||G.stateNode.containerInfo!==Q.containerInfo||G.stateNode.implementation!==Q.implementation?(G=ov(Q,H.mode,he),G.return=H,G):(G=v(G,Q.children||[]),G.return=H,G)}function me(H,G,Q,he,Ie){return G===null||G.tag!==7?(G=Aa(Q,H.mode,he,Ie),G.return=H,G):(G=v(G,Q),G.return=H,G)}function Oe(H,G,Q){if(typeof G=="string"&&G!==""||typeof G=="number")return G=sv(""+G,H.mode,Q),G.return=H,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case c:return Q=ip(G.type,G.key,G.props,null,H.mode,Q),Q.ref=Hr(H,null,G),Q.return=H,Q;case h:return G=ov(G,H.mode,Q),G.return=H,G;case w:var he=G._init;return Oe(H,he(G._payload),Q)}if(ye(G)||U(G))return G=Aa(G,H.mode,Q,null),G.return=H,G;d(H,G)}return null}function ce(H,G,Q,he){var Ie=G!==null?G.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Ie!==null?null:j(H,G,""+Q,he);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:return Q.key===Ie?$(H,G,Q,he):null;case h:return Q.key===Ie?ie(H,G,Q,he):null;case w:return Ie=Q._init,ce(H,G,Ie(Q._payload),he)}if(ye(Q)||U(Q))return Ie!==null?null:me(H,G,Q,he,null);d(H,Q)}return null}function Tt(H,G,Q,he,Ie){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Q)||null,j(G,H,""+he,Ie);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case c:return H=H.get(he.key===null?Q:he.key)||null,$(G,H,he,Ie);case h:return H=H.get(he.key===null?Q:he.key)||null,ie(G,H,he,Ie);case w:var Fe=he._init;return Tt(H,G,Q,Fe(he._payload),Ie)}if(ye(he)||U(he))return H=H.get(Q)||null,me(G,H,he,Ie,null);d(G,he)}return null}function _t(H,G,Q,he){for(var Ie=null,Fe=null,Me=G,rt=G=0,vn=null;Me!==null&&rt<Q.length;rt++){Me.index>rt?(vn=Me,Me=null):vn=Me.sibling;var it=ce(H,Me,Q[rt],he);if(it===null){Me===null&&(Me=vn);break}a&&Me&&it.alternate===null&&l(H,Me),G=T(it,G,rt),Fe===null?Ie=it:Fe.sibling=it,Fe=it,Me=vn}if(rt===Q.length)return f(H,Me),ft&&Wr(H,rt),Ie;if(Me===null){for(;rt<Q.length;rt++)Me=Oe(H,Q[rt],he),Me!==null&&(G=T(Me,G,rt),Fe===null?Ie=Me:Fe.sibling=Me,Fe=Me);return ft&&Wr(H,rt),Ie}for(Me=g(H,Me);rt<Q.length;rt++)vn=Tt(Me,H,rt,Q[rt],he),vn!==null&&(a&&vn.alternate!==null&&Me.delete(vn.key===null?rt:vn.key),G=T(vn,G,rt),Fe===null?Ie=vn:Fe.sibling=vn,Fe=vn);return a&&Me.forEach(function(mo){return l(H,mo)}),ft&&Wr(H,rt),Ie}function Cr(H,G,Q,he){var Ie=U(Q);if(typeof Ie!="function")throw Error(o(150));if(Q=Ie.call(Q),Q==null)throw Error(o(151));for(var Fe=Ie=null,Me=G,rt=G=0,vn=null,it=Q.next();Me!==null&&!it.done;rt++,it=Q.next()){Me.index>rt?(vn=Me,Me=null):vn=Me.sibling;var mo=ce(H,Me,it.value,he);if(mo===null){Me===null&&(Me=vn);break}a&&Me&&mo.alternate===null&&l(H,Me),G=T(mo,G,rt),Fe===null?Ie=mo:Fe.sibling=mo,Fe=mo,Me=vn}if(it.done)return f(H,Me),ft&&Wr(H,rt),Ie;if(Me===null){for(;!it.done;rt++,it=Q.next())it=Oe(H,it.value,he),it!==null&&(G=T(it,G,rt),Fe===null?Ie=it:Fe.sibling=it,Fe=it);return ft&&Wr(H,rt),Ie}for(Me=g(H,Me);!it.done;rt++,it=Q.next())it=Tt(Me,H,rt,it.value,he),it!==null&&(a&&it.alternate!==null&&Me.delete(it.key===null?rt:it.key),G=T(it,G,rt),Fe===null?Ie=it:Fe.sibling=it,Fe=it);return a&&Me.forEach(function(Ak){return l(H,Ak)}),ft&&Wr(H,rt),Ie}function Es(H,G,Q,he){if(typeof Q=="object"&&Q!==null&&Q.type===p&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case c:e:{for(var Ie=Q.key,Fe=G;Fe!==null;){if(Fe.key===Ie){if(Ie=Q.type,Ie===p){if(Fe.tag===7){f(H,Fe.sibling),G=v(Fe,Q.props.children),G.return=H,H=G;break e}}else if(Fe.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===w&&y(Ie)===Fe.type){f(H,Fe.sibling),G=v(Fe,Q.props),G.ref=Hr(H,Fe,Q),G.return=H,H=G;break e}f(H,Fe);break}else l(H,Fe);Fe=Fe.sibling}Q.type===p?(G=Aa(Q.props.children,H.mode,he,Q.key),G.return=H,H=G):(he=ip(Q.type,Q.key,Q.props,null,H.mode,he),he.ref=Hr(H,G,Q),he.return=H,H=he)}return F(H);case h:e:{for(Fe=Q.key;G!==null;){if(G.key===Fe)if(G.tag===4&&G.stateNode.containerInfo===Q.containerInfo&&G.stateNode.implementation===Q.implementation){f(H,G.sibling),G=v(G,Q.children||[]),G.return=H,H=G;break e}else{f(H,G);break}else l(H,G);G=G.sibling}G=ov(Q,H.mode,he),G.return=H,H=G}return F(H);case w:return Fe=Q._init,Es(H,G,Fe(Q._payload),he)}if(ye(Q))return _t(H,G,Q,he);if(U(Q))return Cr(H,G,Q,he);d(H,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,G!==null&&G.tag===6?(f(H,G.sibling),G=v(G,Q),G.return=H,H=G):(f(H,G),G=sv(Q,H.mode,he),G.return=H,H=G),F(H)):f(H,G)}return Es}var L=I(!0),W=I(!1),q=oi(null),se=null,Ze=null,jt=null;function $e(){jt=Ze=se=null}function nn(a,l,f){ve?(at(q,l._currentValue),l._currentValue=f):(at(q,l._currentValue2),l._currentValue2=f)}function Qt(a){var l=q.current;dt(q),ve?a._currentValue=l:a._currentValue2=l}function Vi(a,l,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===f)break;a=a.return}}function gn(a,l){se=a,jt=Ze=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&l&&(Er=!0),a.firstContext=null)}function Nn(a){var l=ve?a._currentValue:a._currentValue2;if(jt!==a)if(a={context:a,memoizedValue:l,next:null},Ze===null){if(se===null)throw Error(o(308));Ze=a,se.dependencies={lanes:0,firstContext:a}}else Ze=Ze.next=a;return l}var ci=null;function g_(a){ci===null?ci=[a]:ci.push(a)}function KE(a,l,f,g){var v=l.interleaved;return v===null?(f.next=f,g_(l)):(f.next=v.next,v.next=f),l.interleaved=f,Ui(a,g)}function Ui(a,l){a.lanes|=l;var f=a.alternate;for(f!==null&&(f.lanes|=l),f=a,a=a.return;a!==null;)a.childLanes|=l,f=a.alternate,f!==null&&(f.childLanes|=l),f=a,a=a.return;return f.tag===3?f.stateNode:null}var lo=!1;function m_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QE(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function vs(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function uo(a,l,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,ze&2){var v=g.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),g.pending=l,Ui(a,f)}return v=g.interleaved,v===null?(l.next=l,g_(g)):(l.next=v.next,v.next=l),g.interleaved=l,Ui(a,f)}function xf(a,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var g=l.lanes;g&=a.pendingLanes,f|=g,l.lanes=f,Dl(a,f)}}function YE(a,l){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var v=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var F={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?v=T=F:T=T.next=F,f=f.next}while(f!==null);T===null?v=T=l:T=T.next=l}else v=T=l;f={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:T,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=l:a.next=l,f.lastBaseUpdate=l}function Nf(a,l,f,g){var v=a.updateQueue;lo=!1;var T=v.firstBaseUpdate,F=v.lastBaseUpdate,j=v.shared.pending;if(j!==null){v.shared.pending=null;var $=j,ie=$.next;$.next=null,F===null?T=ie:F.next=ie,F=$;var me=a.alternate;me!==null&&(me=me.updateQueue,j=me.lastBaseUpdate,j!==F&&(j===null?me.firstBaseUpdate=ie:j.next=ie,me.lastBaseUpdate=$))}if(T!==null){var Oe=v.baseState;F=0,me=ie=$=null,j=T;do{var ce=j.lane,Tt=j.eventTime;if((g&ce)===ce){me!==null&&(me=me.next={eventTime:Tt,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var _t=a,Cr=j;switch(ce=l,Tt=f,Cr.tag){case 1:if(_t=Cr.payload,typeof _t=="function"){Oe=_t.call(Tt,Oe,ce);break e}Oe=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=Cr.payload,ce=typeof _t=="function"?_t.call(Tt,Oe,ce):_t,ce==null)break e;Oe=s({},Oe,ce);break e;case 2:lo=!0}}j.callback!==null&&j.lane!==0&&(a.flags|=64,ce=v.effects,ce===null?v.effects=[j]:ce.push(j))}else Tt={eventTime:Tt,lane:ce,tag:j.tag,payload:j.payload,callback:j.callback,next:null},me===null?(ie=me=Tt,$=Oe):me=me.next=Tt,F|=ce;if(j=j.next,j===null){if(j=v.shared.pending,j===null)break;ce=j,j=ce.next,ce.next=null,v.lastBaseUpdate=ce,v.shared.pending=null}}while(!0);if(me===null&&($=Oe),v.baseState=$,v.firstBaseUpdate=ie,v.lastBaseUpdate=me,l=v.shared.interleaved,l!==null){v=l;do F|=v.lane,v=v.next;while(v!==l)}else T===null&&(v.shared.lanes=0);Ia|=F,a.lanes=F,a.memoizedState=Oe}}function XE(a,l,f){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var g=a[l],v=g.callback;if(v!==null){if(g.callback=null,g=f,typeof v!="function")throw Error(o(191,v));v.call(g)}}}var Uc={},$r=oi(Uc),zc=oi(Uc),Ul=oi(Uc);function zi(a){if(a===Uc)throw Error(o(174));return a}function __(a,l){at(Ul,l),at(zc,a),at($r,Uc),a=Pe(l),dt($r),at($r,a)}function zl(){dt($r),dt(zc),dt(Ul)}function JE(a){var l=zi(Ul.current),f=zi($r.current);l=J(f,a.type,l),f!==l&&(at(zc,a),at($r,l))}function v_(a){zc.current===a&&(dt($r),dt(zc))}var xt=oi(0);function Df(a){for(var l=a;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||ro(f)||Ic(f)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var y_=[];function w_(){for(var a=0;a<y_.length;a++){var l=y_[a];ve?l._workInProgressVersionPrimary=null:l._workInProgressVersionSecondary=null}y_.length=0}var Of=u.ReactCurrentDispatcher,E_=u.ReactCurrentBatchConfig,Ca=0,Nt=null,rn=null,mn=null,Mf=!1,Bc=!1,jc=0,ek=0;function qn(){throw Error(o(321))}function S_(a,l){if(l===null)return!1;for(var f=0;f<l.length&&f<a.length;f++)if(!Je(a[f],l[f]))return!1;return!0}function T_(a,l,f,g,v,T){if(Ca=T,Nt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Of.current=a===null||a.memoizedState===null?ik:sk,a=f(g,v),Bc){T=0;do{if(Bc=!1,jc=0,25<=T)throw Error(o(301));T+=1,mn=rn=null,l.updateQueue=null,Of.current=ok,a=f(g,v)}while(Bc)}if(Of.current=Ff,l=rn!==null&&rn.next!==null,Ca=0,mn=rn=Nt=null,Mf=!1,l)throw Error(o(300));return a}function C_(){var a=jc!==0;return jc=0,a}function Bi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?Nt.memoizedState=mn=a:mn=mn.next=a,mn}function qr(){if(rn===null){var a=Nt.alternate;a=a!==null?a.memoizedState:null}else a=rn.next;var l=mn===null?Nt.memoizedState:mn.next;if(l!==null)mn=l,rn=a;else{if(a===null)throw Error(o(310));rn=a,a={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},mn===null?Nt.memoizedState=mn=a:mn=mn.next=a}return mn}function Gc(a,l){return typeof l=="function"?l(a):l}function I_(a){var l=qr(),f=l.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=rn,v=g.baseQueue,T=f.pending;if(T!==null){if(v!==null){var F=v.next;v.next=T.next,T.next=F}g.baseQueue=v=T,f.pending=null}if(v!==null){T=v.next,g=g.baseState;var j=F=null,$=null,ie=T;do{var me=ie.lane;if((Ca&me)===me)$!==null&&($=$.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),g=ie.hasEagerState?ie.eagerState:a(g,ie.action);else{var Oe={lane:me,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};$===null?(j=$=Oe,F=g):$=$.next=Oe,Nt.lanes|=me,Ia|=me}ie=ie.next}while(ie!==null&&ie!==T);$===null?F=g:$.next=j,Je(g,l.memoizedState)||(Er=!0),l.memoizedState=g,l.baseState=F,l.baseQueue=$,f.lastRenderedState=g}if(a=f.interleaved,a!==null){v=a;do T=v.lane,Nt.lanes|=T,Ia|=T,v=v.next;while(v!==a)}else v===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function P_(a){var l=qr(),f=l.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=a;var g=f.dispatch,v=f.pending,T=l.memoizedState;if(v!==null){f.pending=null;var F=v=v.next;do T=a(T,F.action),F=F.next;while(F!==v);Je(T,l.memoizedState)||(Er=!0),l.memoizedState=T,l.baseQueue===null&&(l.baseState=T),f.lastRenderedState=T}return[T,g]}function ZE(){}function eS(a,l){var f=Nt,g=qr(),v=l(),T=!Je(g.memoizedState,v);if(T&&(g.memoizedState=v,Er=!0),g=g.queue,R_(rS.bind(null,f,g,a),[a]),g.getSnapshot!==l||T||mn!==null&&mn.memoizedState.tag&1){if(f.flags|=2048,Wc(9,nS.bind(null,f,g,v,l),void 0,null),_n===null)throw Error(o(349));Ca&30||tS(f,l,v)}return v}function tS(a,l,f){a.flags|=16384,a={getSnapshot:l,value:f},l=Nt.updateQueue,l===null?(l={lastEffect:null,stores:null},Nt.updateQueue=l,l.stores=[a]):(f=l.stores,f===null?l.stores=[a]:f.push(a))}function nS(a,l,f,g){l.value=f,l.getSnapshot=g,iS(l)&&sS(a)}function rS(a,l,f){return f(function(){iS(l)&&sS(a)})}function iS(a){var l=a.getSnapshot;a=a.value;try{var f=l();return!Je(a,f)}catch{return!0}}function sS(a){var l=Ui(a,1);l!==null&&Kr(l,a,1,-1)}function oS(a){var l=Bi();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gc,lastRenderedState:a},l.queue=a,a=a.dispatch=rk.bind(null,Nt,a),[l.memoizedState,a]}function Wc(a,l,f,g){return a={tag:a,create:l,destroy:f,deps:g,next:null},l=Nt.updateQueue,l===null?(l={lastEffect:null,stores:null},Nt.updateQueue=l,l.lastEffect=a.next=a):(f=l.lastEffect,f===null?l.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,l.lastEffect=a)),a}function aS(){return qr().memoizedState}function Lf(a,l,f,g){var v=Bi();Nt.flags|=a,v.memoizedState=Wc(1|l,f,void 0,g===void 0?null:g)}function bf(a,l,f,g){var v=qr();g=g===void 0?null:g;var T=void 0;if(rn!==null){var F=rn.memoizedState;if(T=F.destroy,g!==null&&S_(g,F.deps)){v.memoizedState=Wc(l,f,T,g);return}}Nt.flags|=a,v.memoizedState=Wc(1|l,f,T,g)}function lS(a,l){return Lf(8390656,8,a,l)}function R_(a,l){return bf(2048,8,a,l)}function uS(a,l){return bf(4,2,a,l)}function cS(a,l){return bf(4,4,a,l)}function hS(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function dS(a,l,f){return f=f!=null?f.concat([a]):null,bf(4,4,hS.bind(null,l,a),f)}function k_(){}function fS(a,l){var f=qr();l=l===void 0?null:l;var g=f.memoizedState;return g!==null&&l!==null&&S_(l,g[1])?g[0]:(f.memoizedState=[a,l],a)}function pS(a,l){var f=qr();l=l===void 0?null:l;var g=f.memoizedState;return g!==null&&l!==null&&S_(l,g[1])?g[0]:(a=a(),f.memoizedState=[a,l],a)}function gS(a,l,f){return Ca&21?(Je(f,l)||(f=Sf(),Nt.lanes|=f,Ia|=f,a.baseState=!0),l):(a.baseState&&(a.baseState=!1,Er=!0),a.memoizedState=f)}function tk(a,l){var f=Ye;Ye=f!==0&&4>f?f:4,a(!0);var g=E_.transition;E_.transition={};try{a(!1),l()}finally{Ye=f,E_.transition=g}}function mS(){return qr().memoizedState}function nk(a,l,f){var g=fo(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},_S(a))vS(l,f);else if(f=KE(a,l,f,g),f!==null){var v=Yn();Kr(f,a,g,v),yS(f,l,g)}}function rk(a,l,f){var g=fo(a),v={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(_S(a))vS(l,v);else{var T=a.alternate;if(a.lanes===0&&(T===null||T.lanes===0)&&(T=l.lastRenderedReducer,T!==null))try{var F=l.lastRenderedState,j=T(F,f);if(v.hasEagerState=!0,v.eagerState=j,Je(j,F)){var $=l.interleaved;$===null?(v.next=v,g_(l)):(v.next=$.next,$.next=v),l.interleaved=v;return}}catch{}finally{}f=KE(a,l,v,g),f!==null&&(v=Yn(),Kr(f,a,g,v),yS(f,l,g))}}function _S(a){var l=a.alternate;return a===Nt||l!==null&&l===Nt}function vS(a,l){Bc=Mf=!0;var f=a.pending;f===null?l.next=l:(l.next=f.next,f.next=l),a.pending=l}function yS(a,l,f){if(f&4194240){var g=l.lanes;g&=a.pendingLanes,f|=g,l.lanes=f,Dl(a,f)}}var Ff={readContext:Nn,useCallback:qn,useContext:qn,useEffect:qn,useImperativeHandle:qn,useInsertionEffect:qn,useLayoutEffect:qn,useMemo:qn,useReducer:qn,useRef:qn,useState:qn,useDebugValue:qn,useDeferredValue:qn,useTransition:qn,useMutableSource:qn,useSyncExternalStore:qn,useId:qn,unstable_isNewReconciler:!1},ik={readContext:Nn,useCallback:function(a,l){return Bi().memoizedState=[a,l===void 0?null:l],a},useContext:Nn,useEffect:lS,useImperativeHandle:function(a,l,f){return f=f!=null?f.concat([a]):null,Lf(4194308,4,hS.bind(null,l,a),f)},useLayoutEffect:function(a,l){return Lf(4194308,4,a,l)},useInsertionEffect:function(a,l){return Lf(4,2,a,l)},useMemo:function(a,l){var f=Bi();return l=l===void 0?null:l,a=a(),f.memoizedState=[a,l],a},useReducer:function(a,l,f){var g=Bi();return l=f!==void 0?f(l):l,g.memoizedState=g.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},g.queue=a,a=a.dispatch=nk.bind(null,Nt,a),[g.memoizedState,a]},useRef:function(a){var l=Bi();return a={current:a},l.memoizedState=a},useState:oS,useDebugValue:k_,useDeferredValue:function(a){return Bi().memoizedState=a},useTransition:function(){var a=oS(!1),l=a[0];return a=tk.bind(null,a[1]),Bi().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,f){var g=Nt,v=Bi();if(ft){if(f===void 0)throw Error(o(407));f=f()}else{if(f=l(),_n===null)throw Error(o(349));Ca&30||tS(g,l,f)}v.memoizedState=f;var T={value:f,getSnapshot:l};return v.queue=T,lS(rS.bind(null,g,T,a),[a]),g.flags|=2048,Wc(9,nS.bind(null,g,T,f,l),void 0,null),f},useId:function(){var a=Bi(),l=_n.identifierPrefix;if(ft){var f=Gr,g=yr;f=(g&~(1<<32-Gn(g)-1)).toString(32)+f,l=":"+l+"R"+f,f=jc++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=ek++,l=":"+l+"r"+f.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},sk={readContext:Nn,useCallback:fS,useContext:Nn,useEffect:R_,useImperativeHandle:dS,useInsertionEffect:uS,useLayoutEffect:cS,useMemo:pS,useReducer:I_,useRef:aS,useState:function(){return I_(Gc)},useDebugValue:k_,useDeferredValue:function(a){var l=qr();return gS(l,rn.memoizedState,a)},useTransition:function(){var a=I_(Gc)[0],l=qr().memoizedState;return[a,l]},useMutableSource:ZE,useSyncExternalStore:eS,useId:mS,unstable_isNewReconciler:!1},ok={readContext:Nn,useCallback:fS,useContext:Nn,useEffect:R_,useImperativeHandle:dS,useInsertionEffect:uS,useLayoutEffect:cS,useMemo:pS,useReducer:P_,useRef:aS,useState:function(){return P_(Gc)},useDebugValue:k_,useDeferredValue:function(a){var l=qr();return rn===null?l.memoizedState=a:gS(l,rn.memoizedState,a)},useTransition:function(){var a=P_(Gc)[0],l=qr().memoizedState;return[a,l]},useMutableSource:ZE,useSyncExternalStore:eS,useId:mS,unstable_isNewReconciler:!1};function hi(a,l){if(a&&a.defaultProps){l=s({},l),a=a.defaultProps;for(var f in a)l[f]===void 0&&(l[f]=a[f]);return l}return l}function A_(a,l,f,g){l=a.memoizedState,f=f(g,l),f=f==null?l:s({},l,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var Vf={isMounted:function(a){return(a=a._reactInternals)?D(a)===a:!1},enqueueSetState:function(a,l,f){a=a._reactInternals;var g=Yn(),v=fo(a),T=vs(g,v);T.payload=l,f!=null&&(T.callback=f),l=uo(a,T,v),l!==null&&(Kr(l,a,v,g),xf(l,a,v))},enqueueReplaceState:function(a,l,f){a=a._reactInternals;var g=Yn(),v=fo(a),T=vs(g,v);T.tag=1,T.payload=l,f!=null&&(T.callback=f),l=uo(a,T,v),l!==null&&(Kr(l,a,v,g),xf(l,a,v))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var f=Yn(),g=fo(a),v=vs(f,g);v.tag=2,l!=null&&(v.callback=l),l=uo(a,v,g),l!==null&&(Kr(l,a,g,f),xf(l,a,g))}};function wS(a,l,f,g,v,T,F){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,T,F):l.prototype&&l.prototype.isPureReactComponent?!Ta(f,g)||!Ta(v,T):!0}function ES(a,l,f){var g=!1,v=jr,T=l.contextType;return typeof T=="object"&&T!==null?T=Nn(T):(v=xn(l)?hs:tn.current,g=l.contextTypes,T=(g=g!=null)?so(a,v):jr),l=new l(f,T),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Vf,a.stateNode=l,l._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=T),l}function SS(a,l,f,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==a&&Vf.enqueueReplaceState(l,l.state,null)}function x_(a,l,f,g){var v=a.stateNode;v.props=f,v.state=a.memoizedState,v.refs={},m_(a);var T=l.contextType;typeof T=="object"&&T!==null?v.context=Nn(T):(T=xn(l)?hs:tn.current,v.context=so(a,T)),v.state=a.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(A_(a,l,T,f),v.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&Vf.enqueueReplaceState(v,v.state,null),Nf(a,f,v,g),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function Bl(a,l){try{var f="",g=l;do f+=Af(g),g=g.return;while(g);var v=f}catch(T){v=`
Error generating stack: `+T.message+`
`+T.stack}return{value:a,source:l,stack:v,digest:null}}function N_(a,l,f){return{value:a,source:null,stack:f??null,digest:l??null}}function D_(a,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var ak=typeof WeakMap=="function"?WeakMap:Map;function TS(a,l,f){f=vs(-1,f),f.tag=3,f.payload={element:null};var g=l.value;return f.callback=function(){Jf||(Jf=!0,J_=g),D_(a,l)},f}function CS(a,l,f){f=vs(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var v=l.value;f.payload=function(){return g(v)},f.callback=function(){D_(a,l)}}var T=a.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){D_(a,l),typeof g!="function"&&(co===null?co=new Set([this]):co.add(this));var F=l.stack;this.componentDidCatch(l.value,{componentStack:F!==null?F:""})}),f}function IS(a,l,f){var g=a.pingCache;if(g===null){g=a.pingCache=new ak;var v=new Set;g.set(l,v)}else v=g.get(l),v===void 0&&(v=new Set,g.set(l,v));v.has(f)||(v.add(f),a=Ek.bind(null,a,l,f),l.then(a,a))}function PS(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function RS(a,l,f,g,v){return a.mode&1?(a.flags|=65536,a.lanes=v,a):(a===l?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=vs(-1,1),l.tag=2,uo(f,l,1))),f.lanes|=1),a)}var lk=u.ReactCurrentOwner,Er=!1;function cr(a,l,f,g){l.child=a===null?W(l,null,f,g):L(l,a.child,f,g)}function kS(a,l,f,g,v){f=f.render;var T=l.ref;return gn(l,v),g=T_(a,l,f,g,T,v),f=C_(),a!==null&&!Er?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ys(a,l,v)):(ft&&f&&Fl(l),l.flags|=1,cr(a,l,g,v),l.child)}function AS(a,l,f,g,v){if(a===null){var T=f.type;return typeof T=="function"&&!iv(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=T,xS(a,l,T,g,v)):(a=ip(f.type,null,g,l,l.mode,v),a.ref=l.ref,a.return=l,l.child=a)}if(T=a.child,!(a.lanes&v)){var F=T.memoizedProps;if(f=f.compare,f=f!==null?f:Ta,f(F,g)&&a.ref===l.ref)return ys(a,l,v)}return l.flags|=1,a=go(T,g),a.ref=l.ref,a.return=l,l.child=a}function xS(a,l,f,g,v){if(a!==null){var T=a.memoizedProps;if(Ta(T,g)&&a.ref===l.ref)if(Er=!1,l.pendingProps=g=T,(a.lanes&v)!==0)a.flags&131072&&(Er=!0);else return l.lanes=a.lanes,ys(a,l,v)}return O_(a,l,f,g,v)}function NS(a,l,f){var g=l.pendingProps,v=g.children,T=a!==null?a.memoizedState:null;if(g.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Gl,Dr),Dr|=f;else{if(!(f&1073741824))return a=T!==null?T.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,at(Gl,Dr),Dr|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:f,at(Gl,Dr),Dr|=g}else T!==null?(g=T.baseLanes|f,l.memoizedState=null):g=f,at(Gl,Dr),Dr|=g;return cr(a,l,v,f),l.child}function DS(a,l){var f=l.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function O_(a,l,f,g,v){var T=xn(f)?hs:tn.current;return T=so(l,T),gn(l,v),f=T_(a,l,f,g,T,v),g=C_(),a!==null&&!Er?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ys(a,l,v)):(ft&&g&&Fl(l),l.flags|=1,cr(a,l,f,v),l.child)}function OS(a,l,f,g,v){if(xn(f)){var T=!0;_r(l)}else T=!1;if(gn(l,v),l.stateNode===null)zf(a,l),ES(l,f,g),x_(l,f,g,v),g=!0;else if(a===null){var F=l.stateNode,j=l.memoizedProps;F.props=j;var $=F.context,ie=f.contextType;typeof ie=="object"&&ie!==null?ie=Nn(ie):(ie=xn(f)?hs:tn.current,ie=so(l,ie));var me=f.getDerivedStateFromProps,Oe=typeof me=="function"||typeof F.getSnapshotBeforeUpdate=="function";Oe||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(j!==g||$!==ie)&&SS(l,F,g,ie),lo=!1;var ce=l.memoizedState;F.state=ce,Nf(l,g,F,v),$=l.memoizedState,j!==g||ce!==$||An.current||lo?(typeof me=="function"&&(A_(l,f,me,g),$=l.memoizedState),(j=lo||wS(l,f,j,g,ce,$,ie))?(Oe||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(l.flags|=4194308)):(typeof F.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=$),F.props=g,F.state=$,F.context=ie,g=j):(typeof F.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{F=l.stateNode,QE(a,l),j=l.memoizedProps,ie=l.type===l.elementType?j:hi(l.type,j),F.props=ie,Oe=l.pendingProps,ce=F.context,$=f.contextType,typeof $=="object"&&$!==null?$=Nn($):($=xn(f)?hs:tn.current,$=so(l,$));var Tt=f.getDerivedStateFromProps;(me=typeof Tt=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(j!==Oe||ce!==$)&&SS(l,F,g,$),lo=!1,ce=l.memoizedState,F.state=ce,Nf(l,g,F,v);var _t=l.memoizedState;j!==Oe||ce!==_t||An.current||lo?(typeof Tt=="function"&&(A_(l,f,Tt,g),_t=l.memoizedState),(ie=lo||wS(l,f,ie,g,ce,_t,$)||!1)?(me||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(g,_t,$),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(g,_t,$)),typeof F.componentDidUpdate=="function"&&(l.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof F.componentDidUpdate!="function"||j===a.memoizedProps&&ce===a.memoizedState||(l.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&ce===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=_t),F.props=g,F.state=_t,F.context=$,g=ie):(typeof F.componentDidUpdate!="function"||j===a.memoizedProps&&ce===a.memoizedState||(l.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&ce===a.memoizedState||(l.flags|=1024),g=!1)}return M_(a,l,f,g,T,v)}function M_(a,l,f,g,v,T){DS(a,l);var F=(l.flags&128)!==0;if(!g&&!F)return v&&_a(l,f,!1),ys(a,l,T);g=l.stateNode,lk.current=l;var j=F&&typeof f.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,a!==null&&F?(l.child=L(l,a.child,null,T),l.child=L(l,null,j,T)):cr(a,l,j,T),l.memoizedState=g.state,v&&_a(l,f,!0),l.child}function MS(a){var l=a.stateNode;l.pendingContext?wf(a,l.pendingContext,l.pendingContext!==l.context):l.context&&wf(a,l.context,!1),__(a,l.containerInfo)}function LS(a,l,f,g,v){return _s(),ao(v),l.flags|=256,cr(a,l,f,g),l.child}var L_={dehydrated:null,treeContext:null,retryLane:0};function b_(a){return{baseLanes:a,cachePool:null,transitions:null}}function bS(a,l,f){var g=l.pendingProps,v=xt.current,T=!1,F=(l.flags&128)!==0,j;if((j=F)||(j=a!==null&&a.memoizedState===null?!1:(v&2)!==0),j?(T=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),at(xt,v&1),a===null)return ui(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(l.mode&1?Ic(a)?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(F=g.children,a=g.fallback,T?(g=l.mode,T=l.child,F={mode:"hidden",children:F},!(g&1)&&T!==null?(T.childLanes=0,T.pendingProps=F):T=sp(F,g,0,null),a=Aa(a,g,f,null),T.return=l,a.return=l,T.sibling=a,l.child=T,l.child.memoizedState=b_(f),l.memoizedState=L_,a):F_(l,F));if(v=a.memoizedState,v!==null&&(j=v.dehydrated,j!==null))return uk(a,l,F,g,j,v,f);if(T){T=g.fallback,F=l.mode,v=a.child,j=v.sibling;var $={mode:"hidden",children:g.children};return!(F&1)&&l.child!==v?(g=l.child,g.childLanes=0,g.pendingProps=$,l.deletions=null):(g=go(v,$),g.subtreeFlags=v.subtreeFlags&14680064),j!==null?T=go(j,T):(T=Aa(T,F,f,null),T.flags|=2),T.return=l,g.return=l,g.sibling=T,l.child=g,g=T,T=l.child,F=a.child.memoizedState,F=F===null?b_(f):{baseLanes:F.baseLanes|f,cachePool:null,transitions:F.transitions},T.memoizedState=F,T.childLanes=a.childLanes&~f,l.memoizedState=L_,g}return T=a.child,a=T.sibling,g=go(T,{mode:"visible",children:g.children}),!(l.mode&1)&&(g.lanes=f),g.return=l,g.sibling=null,a!==null&&(f=l.deletions,f===null?(l.deletions=[a],l.flags|=16):f.push(a)),l.child=g,l.memoizedState=null,g}function F_(a,l){return l=sp({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Uf(a,l,f,g){return g!==null&&ao(g),L(l,a.child,null,f),a=F_(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function uk(a,l,f,g,v,T,F){if(f)return l.flags&256?(l.flags&=-257,g=N_(Error(o(422))),Uf(a,l,F,g)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(T=g.fallback,v=l.mode,g=sp({mode:"visible",children:g.children},v,0,null),T=Aa(T,v,F,null),T.flags|=2,g.return=l,T.return=l,g.sibling=T,l.child=g,l.mode&1&&L(l,a.child,null,F),l.child.memoizedState=b_(F),l.memoizedState=L_,T);if(!(l.mode&1))return Uf(a,l,F,null);if(Ic(v))return g=u_(v).digest,T=Error(o(419)),g=N_(T,g,void 0),Uf(a,l,F,g);if(f=(F&a.childLanes)!==0,Er||f){if(g=_n,g!==null){switch(F&-F){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=v&(g.suspendedLanes|F)?0:v,v!==0&&v!==T.retryLane&&(T.retryLane=v,Ui(a,v),Kr(g,a,v,-1))}return rv(),g=N_(Error(o(421))),Uf(a,l,F,g)}return ro(v)?(l.flags|=128,l.child=a.child,l=Sk.bind(null,a),io(v,l),null):(a=T.treeContext,He&&(lr=gf(v),$n=l,ft=!0,wr=null,ms=!1,a!==null&&(pn[ar++]=yr,pn[ar++]=Gr,pn[ar++]=li,yr=a.id,Gr=a.overflow,li=l)),l=F_(l,g.children),l.flags|=4096,l)}function FS(a,l,f){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),Vi(a.return,l,f)}function V_(a,l,f,g,v){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:v}:(T.isBackwards=l,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=f,T.tailMode=v)}function VS(a,l,f){var g=l.pendingProps,v=g.revealOrder,T=g.tail;if(cr(a,l,g.children,f),g=xt.current,g&2)g=g&1|2,l.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&FS(a,f,l);else if(a.tag===19)FS(a,f,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(at(xt,g),!(l.mode&1))l.memoizedState=null;else switch(v){case"forwards":for(f=l.child,v=null;f!==null;)a=f.alternate,a!==null&&Df(a)===null&&(v=f),f=f.sibling;f=v,f===null?(v=l.child,l.child=null):(v=f.sibling,f.sibling=null),V_(l,!1,v,f,T);break;case"backwards":for(f=null,v=l.child,l.child=null;v!==null;){if(a=v.alternate,a!==null&&Df(a)===null){l.child=v;break}a=v.sibling,v.sibling=f,f=v,v=a}V_(l,!0,f,null,T);break;case"together":V_(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function zf(a,l){!(l.mode&1)&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ys(a,l,f){if(a!==null&&(l.dependencies=a.dependencies),Ia|=l.lanes,!(f&l.childLanes))return null;if(a!==null&&l.child!==a.child)throw Error(o(153));if(l.child!==null){for(a=l.child,f=go(a,a.pendingProps),l.child=f,f.return=l;a.sibling!==null;)a=a.sibling,f=f.sibling=go(a,a.pendingProps),f.return=l;f.sibling=null}return l.child}function ck(a,l,f){switch(l.tag){case 3:MS(l),_s();break;case 5:JE(l);break;case 1:xn(l.type)&&_r(l);break;case 4:__(l,l.stateNode.containerInfo);break;case 10:nn(l,l.type._context,l.memoizedProps.value);break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(at(xt,xt.current&1),l.flags|=128,null):f&l.child.childLanes?bS(a,l,f):(at(xt,xt.current&1),a=ys(a,l,f),a!==null?a.sibling:null);at(xt,xt.current&1);break;case 19:if(g=(f&l.childLanes)!==0,a.flags&128){if(g)return VS(a,l,f);l.flags|=128}var v=l.memoizedState;if(v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),at(xt,xt.current),g)break;return null;case 22:case 23:return l.lanes=0,NS(a,l,f)}return ys(a,l,f)}function ji(a){a.flags|=4}function US(a,l){if(a!==null&&a.child===l.child)return!0;if(l.flags&16)return!1;for(a=l.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var Hc,$c,Bf,jf;if(de)Hc=function(a,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)_e(a,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},$c=function(){},Bf=function(a,l,f,g,v){if(a=a.memoizedProps,a!==g){var T=l.stateNode,F=zi($r.current);f=Le(T,f,a,g,v,F),(l.updateQueue=f)&&ji(l)}},jf=function(a,l,f,g){f!==g&&ji(l)};else if(be){Hc=function(a,l,f,g){for(var v=l.child;v!==null;){if(v.tag===5){var T=v.stateNode;f&&g&&(T=no(T,v.type,v.memoizedProps,v)),_e(a,T)}else if(v.tag===6)T=v.stateNode,f&&g&&(T=Cc(T,v.memoizedProps,v)),_e(a,T);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)T=v.child,T!==null&&(T.return=v),Hc(a,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===l)break;for(;v.sibling===null;){if(v.return===null||v.return===l)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};var zS=function(a,l,f,g){for(var v=l.child;v!==null;){if(v.tag===5){var T=v.stateNode;f&&g&&(T=no(T,v.type,v.memoizedProps,v)),Tc(a,T)}else if(v.tag===6)T=v.stateNode,f&&g&&(T=Cc(T,v.memoizedProps,v)),Tc(a,T);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)T=v.child,T!==null&&(T.return=v),zS(a,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===l)break;for(;v.sibling===null;){if(v.return===null||v.return===l)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};$c=function(a,l){var f=l.stateNode;if(!US(a,l)){a=f.containerInfo;var g=Ni(a);zS(g,l,!1,!1),f.pendingChildren=g,ji(l),Cl(a,g)}},Bf=function(a,l,f,g,v){var T=a.stateNode,F=a.memoizedProps;if((a=US(a,l))&&F===g)l.stateNode=T;else{var j=l.stateNode,$=zi($r.current),ie=null;F!==g&&(ie=Le(j,f,F,g,v,$)),a&&ie===null?l.stateNode=T:(T=Sc(T,ie,f,F,g,l,a,j),Ce(T,f,g,v,$)&&ji(l),l.stateNode=T,a?ji(l):Hc(T,l,!1,!1))}},jf=function(a,l,f,g){f!==g?(a=zi(Ul.current),f=zi($r.current),l.stateNode=ut(g,a,f,l),ji(l)):l.stateNode=a.stateNode}}else $c=function(){},Bf=function(){},jf=function(){};function qc(a,l){if(!ft)switch(a.tailMode){case"hidden":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Kn(a){var l=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(l)for(var v=a.child;v!==null;)f|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)f|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=g,a.childLanes=f,l}function hk(a,l,f){var g=l.pendingProps;switch(gs(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(l),null;case 1:return xn(l.type)&&ma(),Kn(l),null;case 3:return f=l.stateNode,zl(),dt(An),dt(tn),w_(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Sa(l)?ji(l):a===null||a.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,wr!==null&&(tv(wr),wr=null))),$c(a,l),Kn(l),null;case 5:v_(l),f=zi(Ul.current);var v=l.type;if(a!==null&&l.stateNode!=null)Bf(a,l,v,g,f),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(o(166));return Kn(l),null}if(a=zi($r.current),Sa(l)){if(!He)throw Error(o(175));a=Pc(l.stateNode,l.type,l.memoizedProps,f,a,l,!ms),l.updateQueue=a,a!==null&&ji(l)}else{var T=le(v,g,f,a,l);Hc(T,l,!1,!1),l.stateNode=T,Ce(T,v,g,f,a)&&ji(l)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Kn(l),null;case 6:if(a&&l.stateNode!=null)jf(a,l,a.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(o(166));if(a=zi(Ul.current),f=zi($r.current),Sa(l)){if(!He)throw Error(o(176));if(a=l.stateNode,f=l.memoizedProps,(g=kl(a,f,l,!ms))&&(v=$n,v!==null))switch(v.tag){case 3:h_(v.stateNode.containerInfo,a,f,(v.mode&1)!==0);break;case 5:Al(v.type,v.memoizedProps,v.stateNode,a,f,(v.mode&1)!==0)}g&&ji(l)}else l.stateNode=ut(g,a,f,l)}return Kn(l),null;case 13:if(dt(xt),g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(ft&&lr!==null&&l.mode&1&&!(l.flags&128))Vc(),_s(),l.flags|=98560,v=!1;else if(v=Sa(l),g!==null&&g.dehydrated!==null){if(a===null){if(!v)throw Error(o(318));if(!He)throw Error(o(344));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(o(317));Di(v,l)}else _s(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;Kn(l),v=!1}else wr!==null&&(tv(wr),wr=null),v=!0;if(!v)return l.flags&65536?l:null}return l.flags&128?(l.lanes=f,l):(f=g!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(l.child.flags|=8192,l.mode&1&&(a===null||xt.current&1?sn===0&&(sn=3):rv())),l.updateQueue!==null&&(l.flags|=4),Kn(l),null);case 4:return zl(),$c(a,l),a===null&&Xe(l.stateNode.containerInfo),Kn(l),null;case 10:return Qt(l.type._context),Kn(l),null;case 17:return xn(l.type)&&ma(),Kn(l),null;case 19:if(dt(xt),v=l.memoizedState,v===null)return Kn(l),null;if(g=(l.flags&128)!==0,T=v.rendering,T===null)if(g)qc(v,!1);else{if(sn!==0||a!==null&&a.flags&128)for(a=l.child;a!==null;){if(T=Df(a),T!==null){for(l.flags|=128,qc(v,!1),a=T.updateQueue,a!==null&&(l.updateQueue=a,l.flags|=4),l.subtreeFlags=0,a=f,f=l.child;f!==null;)g=f,v=a,g.flags&=14680066,T=g.alternate,T===null?(g.childLanes=0,g.lanes=v,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=T.childLanes,g.lanes=T.lanes,g.child=T.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=T.memoizedProps,g.memoizedState=T.memoizedState,g.updateQueue=T.updateQueue,g.type=T.type,v=T.dependencies,g.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),f=f.sibling;return at(xt,xt.current&1|2),l.child}a=a.sibling}v.tail!==null&&Kt()>X_&&(l.flags|=128,g=!0,qc(v,!1),l.lanes=4194304)}else{if(!g)if(a=Df(T),a!==null){if(l.flags|=128,g=!0,a=a.updateQueue,a!==null&&(l.updateQueue=a,l.flags|=4),qc(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!ft)return Kn(l),null}else 2*Kt()-v.renderingStartTime>X_&&f!==1073741824&&(l.flags|=128,g=!0,qc(v,!1),l.lanes=4194304);v.isBackwards?(T.sibling=l.child,l.child=T):(a=v.last,a!==null?a.sibling=T:l.child=T,v.last=T)}return v.tail!==null?(l=v.tail,v.rendering=l,v.tail=l.sibling,v.renderingStartTime=Kt(),l.sibling=null,a=xt.current,at(xt,g?a&1|2:a&1),l):(Kn(l),null);case 22:case 23:return nv(),f=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(l.flags|=8192),f&&l.mode&1?Dr&1073741824&&(Kn(l),de&&l.subtreeFlags&6&&(l.flags|=8192)):Kn(l),null;case 24:return null;case 25:return null}throw Error(o(156,l.tag))}function dk(a,l){switch(gs(l),l.tag){case 1:return xn(l.type)&&ma(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return zl(),dt(An),dt(tn),w_(),a=l.flags,a&65536&&!(a&128)?(l.flags=a&-65537|128,l):null;case 5:return v_(l),null;case 13:if(dt(xt),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(o(340));_s()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return dt(xt),null;case 4:return zl(),null;case 10:return Qt(l.type._context),null;case 22:case 23:return nv(),null;case 24:return null;default:return null}}var Gf=!1,Qn=!1,fk=typeof WeakSet=="function"?WeakSet:Set,fe=null;function jl(a,l){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Rt(a,l,g)}else f.current=null}function U_(a,l,f){try{f()}catch(g){Rt(a,l,g)}}var BS=!1;function pk(a,l){for(ue(a.containerInfo),fe=l;fe!==null;)if(a=fe,l=a.child,(a.subtreeFlags&1028)!==0&&l!==null)l.return=a,fe=l;else for(;fe!==null;){a=fe;try{var f=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,v=f.memoizedState,T=a.stateNode,F=T.getSnapshotBeforeUpdate(a.elementType===a.type?g:hi(a.type,g),v);T.__reactInternalSnapshotBeforeUpdate=F}break;case 3:de&&Ec(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(j){Rt(a,a.return,j)}if(l=a.sibling,l!==null){l.return=a.return,fe=l;break}fe=a.return}return f=BS,BS=!1,f}function Kc(a,l,f){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&a)===a){var T=v.destroy;v.destroy=void 0,T!==void 0&&U_(l,f,T)}v=v.next}while(v!==g)}}function Wf(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==l)}}function z_(a){var l=a.ref;if(l!==null){var f=a.stateNode;switch(a.tag){case 5:a=Te(f);break;default:a=f}typeof l=="function"?l(a):l.current=a}}function jS(a){var l=a.alternate;l!==null&&(a.alternate=null,jS(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&Pn(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function GS(a){return a.tag===5||a.tag===3||a.tag===4}function WS(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||GS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function B_(a,l,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?cf(f,a,l):af(f,a);else if(g!==4&&(a=a.child,a!==null))for(B_(a,l,f),a=a.sibling;a!==null;)B_(a,l,f),a=a.sibling}function j_(a,l,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?uf(f,a,l):Tl(f,a);else if(g!==4&&(a=a.child,a!==null))for(j_(a,l,f),a=a.sibling;a!==null;)j_(a,l,f),a=a.sibling}var Dn=null,di=!1;function Gi(a,l,f){for(f=f.child;f!==null;)G_(a,l,f),f=f.sibling}function G_(a,l,f){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(Fi,f)}catch{}switch(f.tag){case 5:Qn||jl(f,l);case 6:if(de){var g=Dn,v=di;Dn=null,Gi(a,l,f),Dn=g,di=v,Dn!==null&&(di?l_(Dn,f.stateNode):yc(Dn,f.stateNode))}else Gi(a,l,f);break;case 18:de&&Dn!==null&&(di?vf(Dn,f.stateNode):kc(Dn,f.stateNode));break;case 4:de?(g=Dn,v=di,Dn=f.stateNode.containerInfo,di=!0,Gi(a,l,f),Dn=g,di=v):(be&&(g=f.stateNode.containerInfo,v=Ni(g),Il(g,v)),Gi(a,l,f));break;case 0:case 11:case 14:case 15:if(!Qn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var T=v,F=T.destroy;T=T.tag,F!==void 0&&(T&2||T&4)&&U_(f,l,F),v=v.next}while(v!==g)}Gi(a,l,f);break;case 1:if(!Qn&&(jl(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(j){Rt(f,l,j)}Gi(a,l,f);break;case 21:Gi(a,l,f);break;case 22:f.mode&1?(Qn=(g=Qn)||f.memoizedState!==null,Gi(a,l,f),Qn=g):Gi(a,l,f);break;default:Gi(a,l,f)}}function HS(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new fk),l.forEach(function(g){var v=Tk.bind(null,a,g);f.has(g)||(f.add(g),g.then(v,v))})}}function fi(a,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var v=f[g];try{var T=a,F=l;if(de){var j=F;e:for(;j!==null;){switch(j.tag){case 5:Dn=j.stateNode,di=!1;break e;case 3:Dn=j.stateNode.containerInfo,di=!0;break e;case 4:Dn=j.stateNode.containerInfo,di=!0;break e}j=j.return}if(Dn===null)throw Error(o(160));G_(T,F,v),Dn=null,di=!1}else G_(T,F,v);var $=v.alternate;$!==null&&($.return=null),v.return=null}catch(ie){Rt(v,l,ie)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)$S(l,a),l=l.sibling}function $S(a,l){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(fi(l,a),Wi(a),g&4){try{Kc(3,a,a.return),Wf(3,a)}catch(ce){Rt(a,a.return,ce)}try{Kc(5,a,a.return)}catch(ce){Rt(a,a.return,ce)}}break;case 1:fi(l,a),Wi(a),g&512&&f!==null&&jl(f,f.return);break;case 5:if(fi(l,a),Wi(a),g&512&&f!==null&&jl(f,f.return),de){if(a.flags&32){var v=a.stateNode;try{hf(v)}catch(ce){Rt(a,a.return,ce)}}if(g&4&&(v=a.stateNode,v!=null)){var T=a.memoizedProps;if(f=f!==null?f.memoizedProps:T,g=a.type,l=a.updateQueue,a.updateQueue=null,l!==null)try{fa(v,l,g,f,T,a)}catch(ce){Rt(a,a.return,ce)}}}break;case 6:if(fi(l,a),Wi(a),g&4&&de){if(a.stateNode===null)throw Error(o(162));v=a.stateNode,T=a.memoizedProps,f=f!==null?f.memoizedProps:T;try{lf(v,f,T)}catch(ce){Rt(a,a.return,ce)}}break;case 3:if(fi(l,a),Wi(a),g&4){if(de&&He&&f!==null&&f.memoizedState.isDehydrated)try{_f(l.containerInfo)}catch(ce){Rt(a,a.return,ce)}if(be){v=l.containerInfo,T=l.pendingChildren;try{Il(v,T)}catch(ce){Rt(a,a.return,ce)}}}break;case 4:if(fi(l,a),Wi(a),g&4&&be){T=a.stateNode,v=T.containerInfo,T=T.pendingChildren;try{Il(v,T)}catch(ce){Rt(a,a.return,ce)}}break;case 13:fi(l,a),Wi(a),v=a.child,v.flags&8192&&(T=v.memoizedState!==null,v.stateNode.isHidden=T,!T||v.alternate!==null&&v.alternate.memoizedState!==null||(Y_=Kt())),g&4&&HS(a);break;case 22:var F=f!==null&&f.memoizedState!==null;if(a.mode&1?(Qn=(f=Qn)||F,fi(l,a),Qn=f):fi(l,a),Wi(a),g&8192){if(f=a.memoizedState!==null,(a.stateNode.isHidden=f)&&!F&&a.mode&1)for(fe=a,g=a.child;g!==null;){for(l=fe=g;fe!==null;){F=fe;var j=F.child;switch(F.tag){case 0:case 11:case 14:case 15:Kc(4,F,F.return);break;case 1:jl(F,F.return);var $=F.stateNode;if(typeof $.componentWillUnmount=="function"){var ie=F,me=F.return;try{var Oe=ie;$.props=Oe.memoizedProps,$.state=Oe.memoizedState,$.componentWillUnmount()}catch(ce){Rt(ie,me,ce)}}break;case 5:jl(F,F.return);break;case 22:if(F.memoizedState!==null){QS(l);continue}}j!==null?(j.return=F,fe=j):QS(l)}g=g.sibling}if(de){e:if(g=null,de)for(l=a;;){if(l.tag===5){if(g===null){g=l;try{v=l.stateNode,f?wc(v):ff(l.stateNode,l.memoizedProps)}catch(ce){Rt(a,a.return,ce)}}}else if(l.tag===6){if(g===null)try{T=l.stateNode,f?df(T):pa(T,l.memoizedProps)}catch(ce){Rt(a,a.return,ce)}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;g===l&&(g=null),l=l.return}g===l&&(g=null),l.sibling.return=l.return,l=l.sibling}}}break;case 19:fi(l,a),Wi(a),g&4&&HS(a);break;case 21:break;default:fi(l,a),Wi(a)}}function Wi(a){var l=a.flags;if(l&2){try{if(de){e:{for(var f=a.return;f!==null;){if(GS(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(hf(v),g.flags&=-33);var T=WS(a);j_(a,T,v);break;case 3:case 4:var F=g.stateNode.containerInfo,j=WS(a);B_(a,j,F);break;default:throw Error(o(161))}}}catch($){Rt(a,a.return,$)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function gk(a,l,f){fe=a,qS(a)}function qS(a,l,f){for(var g=(a.mode&1)!==0;fe!==null;){var v=fe,T=v.child;if(v.tag===22&&g){var F=v.memoizedState!==null||Gf;if(!F){var j=v.alternate,$=j!==null&&j.memoizedState!==null||Qn;j=Gf;var ie=Qn;if(Gf=F,(Qn=$)&&!ie)for(fe=v;fe!==null;)F=fe,$=F.child,F.tag===22&&F.memoizedState!==null?YS(v):$!==null?($.return=F,fe=$):YS(v);for(;T!==null;)fe=T,qS(T),T=T.sibling;fe=v,Gf=j,Qn=ie}KS(a)}else v.subtreeFlags&8772&&T!==null?(T.return=v,fe=T):KS(a)}}function KS(a){for(;fe!==null;){var l=fe;if(l.flags&8772){var f=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:Qn||Wf(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!Qn)if(f===null)g.componentDidMount();else{var v=l.elementType===l.type?f.memoizedProps:hi(l.type,f.memoizedProps);g.componentDidUpdate(v,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=l.updateQueue;T!==null&&XE(l,T,g);break;case 3:var F=l.updateQueue;if(F!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=Te(l.child.stateNode);break;case 1:f=l.child.stateNode}XE(l,F,f)}break;case 5:var j=l.stateNode;f===null&&l.flags&4&&a_(j,l.type,l.memoizedProps,l);break;case 6:break;case 4:break;case 12:break;case 13:if(He&&l.memoizedState===null){var $=l.alternate;if($!==null){var ie=$.memoizedState;if(ie!==null){var me=ie.dehydrated;me!==null&&Rc(me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}Qn||l.flags&512&&z_(l)}catch(Oe){Rt(l,l.return,Oe)}}if(l===a){fe=null;break}if(f=l.sibling,f!==null){f.return=l.return,fe=f;break}fe=l.return}}function QS(a){for(;fe!==null;){var l=fe;if(l===a){fe=null;break}var f=l.sibling;if(f!==null){f.return=l.return,fe=f;break}fe=l.return}}function YS(a){for(;fe!==null;){var l=fe;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{Wf(4,l)}catch($){Rt(l,f,$)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var v=l.return;try{g.componentDidMount()}catch($){Rt(l,v,$)}}var T=l.return;try{z_(l)}catch($){Rt(l,T,$)}break;case 5:var F=l.return;try{z_(l)}catch($){Rt(l,F,$)}}}catch($){Rt(l,l.return,$)}if(l===a){fe=null;break}var j=l.sibling;if(j!==null){j.return=l.return,fe=j;break}fe=l.return}}var Hf=0,$f=1,qf=2,Kf=3,Qf=4;if(typeof Symbol=="function"&&Symbol.for){var Qc=Symbol.for;Hf=Qc("selector.component"),$f=Qc("selector.has_pseudo_class"),qf=Qc("selector.role"),Kf=Qc("selector.test_id"),Qf=Qc("selector.text")}function W_(a){var l=Bt(a);if(l!=null){if(typeof l.memoizedProps["data-testname"]!="string")throw Error(o(364));return l}if(a=sf(a),a===null)throw Error(o(362));return a.stateNode.current}function H_(a,l){switch(l.$$typeof){case Hf:if(a.type===l.value)return!0;break;case $f:e:{l=l.value,a=[a,0];for(var f=0;f<a.length;){var g=a[f++],v=a[f++],T=l[v];if(g.tag!==5||!as(g)){for(;T!=null&&H_(g,T);)v++,T=l[v];if(v===l.length){l=!0;break e}else for(g=g.child;g!==null;)a.push(g,v),g=g.sibling}}l=!1}return l;case qf:if(a.tag===5&&of(a.stateNode,l.value))return!0;break;case Qf:if((a.tag===5||a.tag===6)&&(a=vc(a),a!==null&&0<=a.indexOf(l.value)))return!0;break;case Kf:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===l.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function $_(a){switch(a.$$typeof){case Hf:return"<"+(O(a.value)||"Unknown")+">";case $f:return":has("+($_(a)||"")+")";case qf:return'[role="'+a.value+'"]';case Qf:return'"'+a.value+'"';case Kf:return'[data-testname="'+a.value+'"]';default:throw Error(o(365))}}function XS(a,l){var f=[];a=[a,0];for(var g=0;g<a.length;){var v=a[g++],T=a[g++],F=l[T];if(v.tag!==5||!as(v)){for(;F!=null&&H_(v,F);)T++,F=l[T];if(T===l.length)f.push(v);else for(v=v.child;v!==null;)a.push(v,T),v=v.sibling}}return f}function q_(a,l){if(!os)throw Error(o(363));a=W_(a),a=XS(a,l),l=[],a=Array.from(a);for(var f=0;f<a.length;){var g=a[f++];if(g.tag===5)as(g)||l.push(g.stateNode);else for(g=g.child;g!==null;)a.push(g),g=g.sibling}return l}var mk=Math.ceil,Yf=u.ReactCurrentDispatcher,K_=u.ReactCurrentOwner,Gt=u.ReactCurrentBatchConfig,ze=0,_n=null,Yt=null,On=0,Dr=0,Gl=oi(0),sn=0,Yc=null,Ia=0,Xf=0,Q_=0,Xc=null,Sr=null,Y_=0,X_=1/0,ws=null;function Wl(){X_=Kt()+500}var Jf=!1,J_=null,co=null,Zf=!1,ho=null,ep=0,Jc=0,Z_=null,tp=-1,np=0;function Yn(){return ze&6?Kt():tp!==-1?tp:tp=Kt()}function fo(a){return a.mode&1?ze&2&&On!==0?On&-On:ur.transition!==null?(np===0&&(np=Sf()),np):(a=Ye,a!==0?a:mr()):1}function Kr(a,l,f,g){if(50<Jc)throw Jc=0,Z_=null,Error(o(185));vr(a,f,g),(!(ze&2)||a!==_n)&&(a===_n&&(!(ze&2)&&(Xf|=f),sn===4&&po(a,On)),Tr(a,g),f===1&&ze===0&&!(l.mode&1)&&(Wl(),Ml&&or()))}function Tr(a,l){var f=a.callbackNode;f_(a,l);var g=ya(a,a===_n?On:0);if(g===0)f!==null&&Cf(f),a.callbackNode=null,a.callbackPriority=0;else if(l=g&-g,a.callbackPriority!==l){if(f!=null&&Cf(f),l===1)a.tag===0?Rf(ZS.bind(null,a)):Lc(ZS.bind(null,a)),Br?rf(function(){!(ze&6)&&or()}):Dc(Oc,or),f=null;else{switch(fs(g)){case 1:f=Oc;break;case 4:f=Ol;break;case 16:f=oo;break;case 536870912:f=If;break;default:f=oo}f=l4(f,JS.bind(null,a))}a.callbackPriority=l,a.callbackNode=f}}function JS(a,l){if(tp=-1,np=0,ze&6)throw Error(o(327));var f=a.callbackNode;if(ka()&&a.callbackNode!==f)return null;var g=ya(a,a===_n?On:0);if(g===0)return null;if(g&30||g&a.expiredLanes||l)l=rp(a,g);else{l=g;var v=ze;ze|=2;var T=n4();(_n!==a||On!==l)&&(ws=null,Wl(),Pa(a,l));do try{yk();break}catch(j){t4(a,j)}while(!0);$e(),Yf.current=T,ze=v,Yt!==null?l=0:(_n=null,On=0,l=sn)}if(l!==0){if(l===2&&(v=Nc(a),v!==0&&(g=v,l=ev(a,v))),l===1)throw f=Yc,Pa(a,0),po(a,g),Tr(a,Kt()),f;if(l===6)po(a,g);else{if(v=a.current.alternate,!(g&30)&&!_k(v)&&(l=rp(a,g),l===2&&(T=Nc(a),T!==0&&(g=T,l=ev(a,T))),l===1))throw f=Yc,Pa(a,0),po(a,g),Tr(a,Kt()),f;switch(a.finishedWork=v,a.finishedLanes=g,l){case 0:case 1:throw Error(o(345));case 2:Ra(a,Sr,ws);break;case 3:if(po(a,g),(g&130023424)===g&&(l=Y_+500-Kt(),10<l)){if(ya(a,0)!==0)break;if(v=a.suspendedLanes,(v&g)!==g){Yn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=B(Ra.bind(null,a,Sr,ws),l);break}Ra(a,Sr,ws);break;case 4:if(po(a,g),(g&4194240)===g)break;for(l=a.eventTimes,v=-1;0<g;){var F=31-Gn(g);T=1<<F,F=l[F],F>v&&(v=F),g&=~T}if(g=v,g=Kt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*mk(g/1960))-g,10<g){a.timeoutHandle=B(Ra.bind(null,a,Sr,ws),g);break}Ra(a,Sr,ws);break;case 5:Ra(a,Sr,ws);break;default:throw Error(o(329))}}}return Tr(a,Kt()),a.callbackNode===f?JS.bind(null,a):null}function ev(a,l){var f=Xc;return a.current.memoizedState.isDehydrated&&(Pa(a,l).flags|=256),a=rp(a,l),a!==2&&(l=Sr,Sr=f,l!==null&&tv(l)),a}function tv(a){Sr===null?Sr=a:Sr.push.apply(Sr,a)}function _k(a){for(var l=a;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var v=f[g],T=v.getSnapshot;v=v.value;try{if(!Je(T(),v))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function po(a,l){for(l&=~Q_,l&=~Xf,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var f=31-Gn(l),g=1<<f;a[f]=-1,l&=~g}}function ZS(a){if(ze&6)throw Error(o(327));ka();var l=ya(a,0);if(!(l&1))return Tr(a,Kt()),null;var f=rp(a,l);if(a.tag!==0&&f===2){var g=Nc(a);g!==0&&(l=g,f=ev(a,g))}if(f===1)throw f=Yc,Pa(a,0),po(a,l),Tr(a,Kt()),f;if(f===6)throw Error(o(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Ra(a,Sr,ws),Tr(a,Kt()),null}function e4(a){ho!==null&&ho.tag===0&&!(ze&6)&&ka();var l=ze;ze|=1;var f=Gt.transition,g=Ye;try{if(Gt.transition=null,Ye=1,a)return a()}finally{Ye=g,Gt.transition=f,ze=l,!(ze&6)&&or()}}function nv(){Dr=Gl.current,dt(Gl)}function Pa(a,l){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==re&&(a.timeoutHandle=re,Y(f)),Yt!==null)for(f=Yt.return;f!==null;){var g=f;switch(gs(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&ma();break;case 3:zl(),dt(An),dt(tn),w_();break;case 5:v_(g);break;case 4:zl();break;case 13:dt(xt);break;case 19:dt(xt);break;case 10:Qt(g.type._context);break;case 22:case 23:nv()}f=f.return}if(_n=a,Yt=a=go(a.current,null),On=Dr=l,sn=0,Yc=null,Q_=Xf=Ia=0,Sr=Xc=null,ci!==null){for(l=0;l<ci.length;l++)if(f=ci[l],g=f.interleaved,g!==null){f.interleaved=null;var v=g.next,T=f.pending;if(T!==null){var F=T.next;T.next=v,g.next=F}f.pending=g}ci=null}return a}function t4(a,l){do{var f=Yt;try{if($e(),Of.current=Ff,Mf){for(var g=Nt.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}Mf=!1}if(Ca=0,mn=rn=Nt=null,Bc=!1,jc=0,K_.current=null,f===null||f.return===null){sn=1,Yc=l,Yt=null;break}e:{var T=a,F=f.return,j=f,$=l;if(l=On,j.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var ie=$,me=j,Oe=me.tag;if(!(me.mode&1)&&(Oe===0||Oe===11||Oe===15)){var ce=me.alternate;ce?(me.updateQueue=ce.updateQueue,me.memoizedState=ce.memoizedState,me.lanes=ce.lanes):(me.updateQueue=null,me.memoizedState=null)}var Tt=PS(F);if(Tt!==null){Tt.flags&=-257,RS(Tt,F,j,T,l),Tt.mode&1&&IS(T,ie,l),l=Tt,$=ie;var _t=l.updateQueue;if(_t===null){var Cr=new Set;Cr.add($),l.updateQueue=Cr}else _t.add($);break e}else{if(!(l&1)){IS(T,ie,l),rv();break e}$=Error(o(426))}}else if(ft&&j.mode&1){var Es=PS(F);if(Es!==null){!(Es.flags&65536)&&(Es.flags|=256),RS(Es,F,j,T,l),ao(Bl($,j));break e}}T=$=Bl($,j),sn!==4&&(sn=2),Xc===null?Xc=[T]:Xc.push(T),T=F;do{switch(T.tag){case 3:T.flags|=65536,l&=-l,T.lanes|=l;var H=TS(T,$,l);YE(T,H);break e;case 1:j=$;var G=T.type,Q=T.stateNode;if(!(T.flags&128)&&(typeof G.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(co===null||!co.has(Q)))){T.flags|=65536,l&=-l,T.lanes|=l;var he=CS(T,j,l);YE(T,he);break e}}T=T.return}while(T!==null)}i4(f)}catch(Ie){l=Ie,Yt===f&&f!==null&&(Yt=f=f.return);continue}break}while(!0)}function n4(){var a=Yf.current;return Yf.current=Ff,a===null?Ff:a}function rv(){(sn===0||sn===3||sn===2)&&(sn=4),_n===null||!(Ia&268435455)&&!(Xf&268435455)||po(_n,On)}function rp(a,l){var f=ze;ze|=2;var g=n4();(_n!==a||On!==l)&&(ws=null,Pa(a,l));do try{vk();break}catch(v){t4(a,v)}while(!0);if($e(),ze=f,Yf.current=g,Yt!==null)throw Error(o(261));return _n=null,On=0,sn}function vk(){for(;Yt!==null;)r4(Yt)}function yk(){for(;Yt!==null&&!p_();)r4(Yt)}function r4(a){var l=a4(a.alternate,a,Dr);a.memoizedProps=a.pendingProps,l===null?i4(a):Yt=l,K_.current=null}function i4(a){var l=a;do{var f=l.alternate;if(a=l.return,l.flags&32768){if(f=dk(f,l),f!==null){f.flags&=32767,Yt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{sn=6,Yt=null;return}}else if(f=hk(f,l,Dr),f!==null){Yt=f;return}if(l=l.sibling,l!==null){Yt=l;return}Yt=l=a}while(l!==null);sn===0&&(sn=5)}function Ra(a,l,f){var g=Ye,v=Gt.transition;try{Gt.transition=null,Ye=1,wk(a,l,f,g)}finally{Gt.transition=v,Ye=g}return null}function wk(a,l,f,g){do ka();while(ho!==null);if(ze&6)throw Error(o(327));f=a.finishedWork;var v=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(o(177));a.callbackNode=null,a.callbackPriority=0;var T=f.lanes|f.childLanes;if(Tf(a,T),a===_n&&(Yt=_n=null,On=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||Zf||(Zf=!0,l4(oo,function(){return ka(),null})),T=(f.flags&15990)!==0,f.subtreeFlags&15990||T){T=Gt.transition,Gt.transition=null;var F=Ye;Ye=1;var j=ze;ze|=4,K_.current=null,pk(a,f),$S(f,a),te(a.containerInfo),a.current=f,gk(f),bi(),ze=j,Ye=F,Gt.transition=T}else a.current=f;if(Zf&&(Zf=!1,ho=a,ep=v),T=a.pendingLanes,T===0&&(co=null),Pf(f.stateNode),Tr(a,Kt()),l!==null)for(g=a.onRecoverableError,f=0;f<l.length;f++)v=l[f],g(v.value,{componentStack:v.stack,digest:v.digest});if(Jf)throw Jf=!1,a=J_,J_=null,a;return ep&1&&a.tag!==0&&ka(),T=a.pendingLanes,T&1?a===Z_?Jc++:(Jc=0,Z_=a):Jc=0,or(),null}function ka(){if(ho!==null){var a=fs(ep),l=Gt.transition,f=Ye;try{if(Gt.transition=null,Ye=16>a?16:a,ho===null)var g=!1;else{if(a=ho,ho=null,ep=0,ze&6)throw Error(o(331));var v=ze;for(ze|=4,fe=a.current;fe!==null;){var T=fe,F=T.child;if(fe.flags&16){var j=T.deletions;if(j!==null){for(var $=0;$<j.length;$++){var ie=j[$];for(fe=ie;fe!==null;){var me=fe;switch(me.tag){case 0:case 11:case 15:Kc(8,me,T)}var Oe=me.child;if(Oe!==null)Oe.return=me,fe=Oe;else for(;fe!==null;){me=fe;var ce=me.sibling,Tt=me.return;if(jS(me),me===ie){fe=null;break}if(ce!==null){ce.return=Tt,fe=ce;break}fe=Tt}}}var _t=T.alternate;if(_t!==null){var Cr=_t.child;if(Cr!==null){_t.child=null;do{var Es=Cr.sibling;Cr.sibling=null,Cr=Es}while(Cr!==null)}}fe=T}}if(T.subtreeFlags&2064&&F!==null)F.return=T,fe=F;else e:for(;fe!==null;){if(T=fe,T.flags&2048)switch(T.tag){case 0:case 11:case 15:Kc(9,T,T.return)}var H=T.sibling;if(H!==null){H.return=T.return,fe=H;break e}fe=T.return}}var G=a.current;for(fe=G;fe!==null;){F=fe;var Q=F.child;if(F.subtreeFlags&2064&&Q!==null)Q.return=F,fe=Q;else e:for(F=G;fe!==null;){if(j=fe,j.flags&2048)try{switch(j.tag){case 0:case 11:case 15:Wf(9,j)}}catch(Ie){Rt(j,j.return,Ie)}if(j===F){fe=null;break e}var he=j.sibling;if(he!==null){he.return=j.return,fe=he;break e}fe=j.return}}if(ze=v,or(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(Fi,a)}catch{}g=!0}return g}finally{Ye=f,Gt.transition=l}}return!1}function s4(a,l,f){l=Bl(f,l),l=TS(a,l,1),a=uo(a,l,1),l=Yn(),a!==null&&(vr(a,1,l),Tr(a,l))}function Rt(a,l,f){if(a.tag===3)s4(a,a,f);else for(;l!==null;){if(l.tag===3){s4(l,a,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(co===null||!co.has(g))){a=Bl(f,a),a=CS(l,a,1),l=uo(l,a,1),a=Yn(),l!==null&&(vr(l,1,a),Tr(l,a));break}}l=l.return}}function Ek(a,l,f){var g=a.pingCache;g!==null&&g.delete(l),l=Yn(),a.pingedLanes|=a.suspendedLanes&f,_n===a&&(On&f)===f&&(sn===4||sn===3&&(On&130023424)===On&&500>Kt()-Y_?Pa(a,0):Q_|=f),Tr(a,l)}function o4(a,l){l===0&&(a.mode&1?(l=Li,Li<<=1,!(Li&130023424)&&(Li=4194304)):l=1);var f=Yn();a=Ui(a,l),a!==null&&(vr(a,l,f),Tr(a,f))}function Sk(a){var l=a.memoizedState,f=0;l!==null&&(f=l.retryLane),o4(a,f)}function Tk(a,l){var f=0;switch(a.tag){case 13:var g=a.stateNode,v=a.memoizedState;v!==null&&(f=v.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(l),o4(a,f)}var a4;a4=function(a,l,f){if(a!==null)if(a.memoizedProps!==l.pendingProps||An.current)Er=!0;else{if(!(a.lanes&f)&&!(l.flags&128))return Er=!1,ck(a,l,f);Er=!!(a.flags&131072)}else Er=!1,ft&&l.flags&1048576&&kf(l,bl,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;zf(a,l),a=l.pendingProps;var v=so(l,tn.current);gn(l,f),v=T_(null,l,g,a,v,f);var T=C_();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,xn(g)?(T=!0,_r(l)):T=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,m_(l),v.updater=Vf,l.stateNode=v,v._reactInternals=l,x_(l,g,a,f),l=M_(null,l,g,!0,T,f)):(l.tag=0,ft&&T&&Fl(l),cr(null,l,v,f),l=l.child),l;case 16:g=l.elementType;e:{switch(zf(a,l),a=l.pendingProps,v=g._init,g=v(g._payload),l.type=g,v=l.tag=Ik(g),a=hi(g,a),v){case 0:l=O_(null,l,g,a,f);break e;case 1:l=OS(null,l,g,a,f);break e;case 11:l=kS(null,l,g,a,f);break e;case 14:l=AS(null,l,g,hi(g.type,a),f);break e}throw Error(o(306,g,""))}return l;case 0:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:hi(g,v),O_(a,l,g,v,f);case 1:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:hi(g,v),OS(a,l,g,v,f);case 3:e:{if(MS(l),a===null)throw Error(o(387));g=l.pendingProps,T=l.memoizedState,v=T.element,QE(a,l),Nf(l,g,null,f);var F=l.memoizedState;if(g=F.element,He&&T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},l.updateQueue.baseState=T,l.memoizedState=T,l.flags&256){v=Bl(Error(o(423)),l),l=LS(a,l,g,f,v);break e}else if(g!==v){v=Bl(Error(o(424)),l),l=LS(a,l,g,f,v);break e}else for(He&&(lr=Rl(l.stateNode.containerInfo),$n=l,ft=!0,wr=null,ms=!1),f=W(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(_s(),g===v){l=ys(a,l,f);break e}cr(a,l,g,f)}l=l.child}return l;case 5:return JE(l),a===null&&ui(l),g=l.type,v=l.pendingProps,T=a!==null?a.memoizedProps:null,F=v.children,yt(g,v)?F=null:T!==null&&yt(g,T)&&(l.flags|=32),DS(a,l),cr(a,l,F,f),l.child;case 6:return a===null&&ui(l),null;case 13:return bS(a,l,f);case 4:return __(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=L(l,null,g,f):cr(a,l,g,f),l.child;case 11:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:hi(g,v),kS(a,l,g,v,f);case 7:return cr(a,l,l.pendingProps,f),l.child;case 8:return cr(a,l,l.pendingProps.children,f),l.child;case 12:return cr(a,l,l.pendingProps.children,f),l.child;case 10:e:{if(g=l.type._context,v=l.pendingProps,T=l.memoizedProps,F=v.value,nn(l,g,F),T!==null)if(Je(T.value,F)){if(T.children===v.children&&!An.current){l=ys(a,l,f);break e}}else for(T=l.child,T!==null&&(T.return=l);T!==null;){var j=T.dependencies;if(j!==null){F=T.child;for(var $=j.firstContext;$!==null;){if($.context===g){if(T.tag===1){$=vs(-1,f&-f),$.tag=2;var ie=T.updateQueue;if(ie!==null){ie=ie.shared;var me=ie.pending;me===null?$.next=$:($.next=me.next,me.next=$),ie.pending=$}}T.lanes|=f,$=T.alternate,$!==null&&($.lanes|=f),Vi(T.return,f,l),j.lanes|=f;break}$=$.next}}else if(T.tag===10)F=T.type===l.type?null:T.child;else if(T.tag===18){if(F=T.return,F===null)throw Error(o(341));F.lanes|=f,j=F.alternate,j!==null&&(j.lanes|=f),Vi(F,f,l),F=T.sibling}else F=T.child;if(F!==null)F.return=T;else for(F=T;F!==null;){if(F===l){F=null;break}if(T=F.sibling,T!==null){T.return=F.return,F=T;break}F=F.return}T=F}cr(a,l,v.children,f),l=l.child}return l;case 9:return v=l.type,g=l.pendingProps.children,gn(l,f),v=Nn(v),g=g(v),l.flags|=1,cr(a,l,g,f),l.child;case 14:return g=l.type,v=hi(g,l.pendingProps),v=hi(g.type,v),AS(a,l,g,v,f);case 15:return xS(a,l,l.type,l.pendingProps,f);case 17:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:hi(g,v),zf(a,l),l.tag=1,xn(g)?(a=!0,_r(l)):a=!1,gn(l,f),ES(l,g,v),x_(l,g,v,f),M_(null,l,g,!0,a,f);case 19:return VS(a,l,f);case 22:return NS(a,l,f)}throw Error(o(156,l.tag))};function l4(a,l){return Dc(a,l)}function Ck(a,l,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(a,l,f,g){return new Ck(a,l,f,g)}function iv(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ik(a){if(typeof a=="function")return iv(a)?1:0;if(a!=null){if(a=a.$$typeof,a===P)return 11;if(a===k)return 14}return 2}function go(a,l){var f=a.alternate;return f===null?(f=Qr(a.tag,l,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=l,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,l=a.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function ip(a,l,f,g,v,T){var F=2;if(g=a,typeof a=="function")iv(a)&&(F=1);else if(typeof a=="string")F=5;else e:switch(a){case p:return Aa(f.children,v,T,l);case m:F=8,v|=8;break;case _:return a=Qr(12,f,l,v|2),a.elementType=_,a.lanes=T,a;case N:return a=Qr(13,f,l,v),a.elementType=N,a.lanes=T,a;case R:return a=Qr(19,f,l,v),a.elementType=R,a.lanes=T,a;case A:return sp(f,v,T,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:F=10;break e;case S:F=9;break e;case P:F=11;break e;case k:F=14;break e;case w:F=16,g=null;break e}throw Error(o(130,a==null?a:typeof a,""))}return l=Qr(F,f,l,v),l.elementType=a,l.type=g,l.lanes=T,l}function Aa(a,l,f,g){return a=Qr(7,a,g,l),a.lanes=f,a}function sp(a,l,f,g){return a=Qr(22,a,g,l),a.elementType=A,a.lanes=f,a.stateNode={isHidden:!1},a}function sv(a,l,f){return a=Qr(6,a,null,l),a.lanes=f,a}function ov(a,l,f){return l=Qr(4,a.children!==null?a.children:[],a.key,l),l.lanes=f,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function Pk(a,l,f,g,v){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=re,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ds(0),this.expirationTimes=ds(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ds(0),this.identifierPrefix=g,this.onRecoverableError=v,He&&(this.mutableSourceEagerHydrationData=null)}function u4(a,l,f,g,v,T,F,j,$){return a=new Pk(a,l,f,j,$),l===1?(l=1,T===!0&&(l|=8)):l=0,T=Qr(3,null,null,l),a.current=T,T.stateNode=a,T.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},m_(T),a}function c4(a){if(!a)return jr;a=a._reactInternals;e:{if(D(a)!==a||a.tag!==1)throw Error(o(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(xn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(o(171))}if(a.tag===1){var f=a.type;if(xn(f))return Oi(a,f,l)}return l}function h4(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(o(188)):(a=Object.keys(a).join(","),Error(o(268,a)));return a=z(l),a===null?null:a.stateNode}function d4(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<l?f:l}}function op(a,l){d4(a,l),(a=a.alternate)&&d4(a,l)}function Rk(a){return a=z(a),a===null?null:a.stateNode}function kk(){return null}return n.attemptContinuousHydration=function(a){if(a.tag===13){var l=Ui(a,134217728);if(l!==null){var f=Yn();Kr(l,a,134217728,f)}op(a,134217728)}},n.attemptDiscreteHydration=function(a){if(a.tag===13){var l=Ui(a,1);if(l!==null){var f=Yn();Kr(l,a,1,f)}op(a,1)}},n.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var l=fo(a),f=Ui(a,l);if(f!==null){var g=Yn();Kr(f,a,l,g)}op(a,l)}},n.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var f=va(l.pendingLanes);f!==0&&(Dl(l,f|1),Tr(l,Kt()),!(ze&6)&&(Wl(),or()))}break;case 13:e4(function(){var g=Ui(a,1);if(g!==null){var v=Yn();Kr(g,a,1,v)}}),op(a,1)}},n.batchedUpdates=function(a,l){var f=ze;ze|=1;try{return a(l)}finally{ze=f,ze===0&&(Wl(),Ml&&or())}},n.createComponentSelector=function(a){return{$$typeof:Hf,value:a}},n.createContainer=function(a,l,f,g,v,T,F){return u4(a,l,!1,null,f,g,v,T,F)},n.createHasPseudoClassSelector=function(a){return{$$typeof:$f,value:a}},n.createHydrationContainer=function(a,l,f,g,v,T,F,j,$){return a=u4(f,g,!0,a,v,T,F,j,$),a.context=c4(null),f=a.current,g=Yn(),v=fo(f),T=vs(g,v),T.callback=l??null,uo(f,T,v),a.current.lanes=v,vr(a,v,g),Tr(a,g),a},n.createPortal=function(a,l,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:g==null?null:""+g,children:a,containerInfo:l,implementation:f}},n.createRoleSelector=function(a){return{$$typeof:qf,value:a}},n.createTestNameSelector=function(a){return{$$typeof:Kf,value:a}},n.createTextSelector=function(a){return{$$typeof:Qf,value:a}},n.deferredUpdates=function(a){var l=Ye,f=Gt.transition;try{return Gt.transition=null,Ye=16,a()}finally{Ye=l,Gt.transition=f}},n.discreteUpdates=function(a,l,f,g,v){var T=Ye,F=Gt.transition;try{return Gt.transition=null,Ye=1,a(l,f,g,v)}finally{Ye=T,Gt.transition=F,ze===0&&Wl()}},n.findAllNodes=q_,n.findBoundingRects=function(a,l){if(!os)throw Error(o(363));l=q_(a,l),a=[];for(var f=0;f<l.length;f++)a.push(o_(l[f]));for(l=a.length-1;0<l;l--){f=a[l];for(var g=f.x,v=g+f.width,T=f.y,F=T+f.height,j=l-1;0<=j;j--)if(l!==j){var $=a[j],ie=$.x,me=ie+$.width,Oe=$.y,ce=Oe+$.height;if(g>=ie&&T>=Oe&&v<=me&&F<=ce){a.splice(l,1);break}else if(g!==ie||f.width!==$.width||ce<T||Oe>F){if(!(T!==Oe||f.height!==$.height||me<g||ie>v)){ie>g&&($.width+=ie-g,$.x=g),me<v&&($.width=v-ie),a.splice(l,1);break}}else{Oe>T&&($.height+=Oe-T,$.y=T),ce<F&&($.height=F-Oe),a.splice(l,1);break}}}return a},n.findHostInstance=h4,n.findHostInstanceWithNoPortals=function(a){return a=M(a),a=a!==null?oe(a):null,a===null?null:a.stateNode},n.findHostInstanceWithWarning=function(a){return h4(a)},n.flushControlled=function(a){var l=ze;ze|=1;var f=Gt.transition,g=Ye;try{Gt.transition=null,Ye=1,a()}finally{Ye=g,Gt.transition=f,ze=l,ze===0&&(Wl(),or())}},n.flushPassiveEffects=ka,n.flushSync=e4,n.focusWithin=function(a,l){if(!os)throw Error(o(363));for(a=W_(a),l=XS(a,l),l=Array.from(l),a=0;a<l.length;){var f=l[a++];if(!as(f)){if(f.tag===5&&fn(f.stateNode))return!0;for(f=f.child;f!==null;)l.push(f),f=f.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Ye},n.getFindAllNodesFailureDescription=function(a,l){if(!os)throw Error(o(363));var f=0,g=[];a=[W_(a),0];for(var v=0;v<a.length;){var T=a[v++],F=a[v++],j=l[F];if((T.tag!==5||!as(T))&&(H_(T,j)&&(g.push($_(j)),F++,F>f&&(f=F)),F<l.length))for(T=T.child;T!==null;)a.push(T,F),T=T.sibling}if(f<l.length){for(a=[];f<l.length;f++)a.push($_(l[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},n.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return Te(a.child.stateNode);default:return a.child.stateNode}},n.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Rk,findFiberByHostInstance:a.findFiberByHostInstance||kk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(l.isDisabled||!l.supportsFiber)a=!0;else{try{Fi=l.inject(a),Wn=l}catch{}a=!!l.checkDCE}}return a},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(a,l,f,g){if(!os)throw Error(o(363));a=q_(a,l);var v=Rn(a,f,g).disconnect;return{disconnect:function(){v()}}},n.registerMutableSourceForHydration=function(a,l){var f=l._getVersion;f=f(l._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[l,f]:a.mutableSourceEagerHydrationData.push(l,f)},n.runWithPriority=function(a,l){var f=Ye;try{return Ye=a,l()}finally{Ye=f}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(a,l,f,g){var v=l.current,T=Yn(),F=fo(v);return f=c4(f),l.context===null?l.context=f:l.pendingContext=f,l=vs(T,F),l.payload={element:a},g=g===void 0?null:g,g!==null&&(l.callback=g),a=uo(v,l,F),a!==null&&(Kr(a,v,F,T),xf(a,v,F)),F},n};$R.exports=pH;var gH=$R.exports;const mH=t2(gH);var qR={exports:{}},Sl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Sl.ConcurrentRoot=1;Sl.ContinuousEventPriority=4;Sl.DefaultEventPriority=16;Sl.DiscreteEventPriority=1;Sl.IdleEventPriority=536870912;Sl.LegacyRoot=0;qR.exports=Sl;var KR=qR.exports;const l5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let u5=!1,c5=!1;const $E=".react-konva-event",_H=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,vH=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,yH={};function s_(t,e,n=yH){if(!u5&&"zIndex"in e&&(console.warn(vH),u5=!0),!c5&&e.draggable){var r=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;r&&!i&&(console.warn(_H),c5=!0)}for(var s in n)if(!l5[s]){var o=s.slice(0,2)==="on",u=n[s]!==e[s];if(o&&u){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t.off(c,n[s])}var h=!e.hasOwnProperty(s);h&&t.setAttr(s,void 0)}var p=e._useStrictMode,m={},_=!1;const E={};for(var s in e)if(!l5[s]){var o=s.slice(0,2)==="on",S=n[s]!==e[s];if(o&&S){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(E[c]=e[s])}!o&&(e[s]!==n[s]||p&&e[s]!==t.getAttr(s))&&(_=!0,m[s]=e[s])}_&&(t.setAttrs(m),da(t));for(var c in E)t.on(c+$E,E[c])}function da(t){if(!Ve.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const QR={},wH={};kd.Node.prototype._applyProps=s_;function EH(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),da(t)}function SH(t,e,n){let r=kd[t];r||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=kd.Group);const i={},s={};for(var o in e){var u=o.slice(0,2)==="on";u?s[o]=e[o]:i[o]=e[o]}const c=new r(i);return s_(c,s),c}function TH(t,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function CH(t,e,n){return!1}function IH(t){return t}function PH(){return null}function RH(){return null}function kH(t,e,n,r){return wH}function AH(){}function xH(t){}function NH(t,e){return!1}function DH(){return QR}function OH(){return QR}const MH=setTimeout,LH=clearTimeout,bH=-1;function FH(t,e){return!1}const VH=!1,UH=!0,zH=!0;function BH(t,e){e.parent===t?e.moveToTop():t.add(e),da(t)}function jH(t,e){e.parent===t?e.moveToTop():t.add(e),da(t)}function YR(t,e,n){e._remove(),t.add(e),e.setZIndex(n.getZIndex()),da(t)}function GH(t,e,n){YR(t,e,n)}function WH(t,e){e.destroy(),e.off($E),da(t)}function HH(t,e){e.destroy(),e.off($E),da(t)}function $H(t,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function qH(t,e,n){}function KH(t,e,n,r,i){s_(t,i,r)}function QH(t){t.hide(),da(t)}function YH(t){}function XH(t,e){(e.visible==null||e.visible)&&t.show()}function JH(t,e){}function ZH(t){}function e$(){}const t$=()=>KR.DefaultEventPriority,n$=Object.freeze(Object.defineProperty({__proto__:null,appendChild:BH,appendChildToContainer:jH,appendInitialChild:EH,cancelTimeout:LH,clearContainer:ZH,commitMount:qH,commitTextUpdate:$H,commitUpdate:KH,createInstance:SH,createTextInstance:TH,detachDeletedInstance:e$,finalizeInitialChildren:CH,getChildHostContext:OH,getCurrentEventPriority:t$,getPublicInstance:IH,getRootHostContext:DH,hideInstance:QH,hideTextInstance:YH,idlePriority:Ih.unstable_IdlePriority,insertBefore:YR,insertInContainerBefore:GH,isPrimaryRenderer:VH,noTimeout:bH,now:Ih.unstable_now,prepareForCommit:PH,preparePortalMount:RH,prepareUpdate:kH,removeChild:WH,removeChildFromContainer:HH,resetAfterCommit:AH,resetTextContent:xH,run:Ih.unstable_runWithPriority,scheduleTimeout:MH,shouldDeprioritizeSubtree:NH,shouldSetTextContent:FH,supportsMutation:zH,unhideInstance:XH,unhideTextInstance:JH,warnsIfNotActing:UH},Symbol.toStringTag,{value:"Module"}));var r$=Object.defineProperty,i$=Object.defineProperties,s$=Object.getOwnPropertyDescriptors,h5=Object.getOwnPropertySymbols,o$=Object.prototype.hasOwnProperty,a$=Object.prototype.propertyIsEnumerable,d5=(t,e,n)=>e in t?r$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,f5=(t,e)=>{for(var n in e||(e={}))o$.call(e,n)&&d5(t,n,e[n]);if(h5)for(var n of h5(e))a$.call(e,n)&&d5(t,n,e[n]);return t},l$=(t,e)=>i$(t,s$(e)),p5,g5;typeof window<"u"&&((p5=window.document)!=null&&p5.createElement||((g5=window.navigator)==null?void 0:g5.product)==="ReactNative")?X.useLayoutEffect:X.useEffect;function XR(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=t.child;for(;r;){const i=XR(r,e,n);if(i)return i;r=r.sibling}}function JR(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const m5=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=m5;return}return m5.apply(this,arguments)};const qE=JR(X.createContext(null));class ZR extends X.Component{render(){return X.createElement(qE.Provider,{value:this._reactInternals},this.props.children)}}function u$(){const t=X.useContext(qE);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=X.useId();return X.useMemo(()=>{for(const r of[t,t==null?void 0:t.alternate]){if(!r)continue;const i=XR(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[t,e])}function c$(){const t=u$(),[e]=X.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const i=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;i&&i!==qE&&!e.has(i)&&e.set(i,X.useContext(JR(i)))}n=n.return}return e}function h$(){const t=c$();return X.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>X.createElement(e,null,X.createElement(n.Provider,l$(f5({},r),{value:t.get(n)}))),e=>X.createElement(ZR,f5({},e))),[t])}function d$(t){const e=Ln.useRef({});return Ln.useLayoutEffect(()=>{e.current=t}),Ln.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const f$=t=>{const e=Ln.useRef(),n=Ln.useRef(),r=Ln.useRef(),i=d$(t),s=h$(),o=u=>{const{forwardedRef:c}=t;c&&(typeof c=="function"?c(u):c.current=u)};return Ln.useLayoutEffect(()=>(n.current=new kd.Stage({width:t.width,height:t.height,container:e.current}),o(n.current),r.current=Ch.createContainer(n.current,KR.LegacyRoot,!1,null),Ch.updateContainer(Ln.createElement(s,{},t.children),r.current),()=>{kd.isBrowser&&(o(null),Ch.updateContainer(null,r.current,null),n.current.destroy())}),[]),Ln.useLayoutEffect(()=>{o(n.current),s_(n.current,t,i),Ch.updateContainer(Ln.createElement(s,{},t.children),r.current,null)}),Ln.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},p$="Layer",Fp="Rect",Ch=mH(n$);Ch.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Ln.version,rendererPackageName:"react-konva"});const g$=Ln.forwardRef((t,e)=>Ln.createElement(ZR,{},Ln.createElement(f$,{...t,forwardedRef:e}))),m$=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#800000","#008080","#808000","#FFC0CB","#A52A2A","#808080","#C0C0C0","#ADD8E6","#98FB98"],_$=({user:t})=>{var yt,ut;const{id:e}=D7(),n=Ld(),[r,i]=X.useState(null),[s,o]=X.useState({}),[u,c]=X.useState("#000000"),[h,p]=X.useState(!0),[m,_]=X.useState(null),[E,S]=X.useState(0),[P,N]=X.useState(0),[R,k]=X.useState(4),[w,A]=X.useState({x:0,y:0}),V=X.useRef(null),U=X.useRef(null),[O,C]=X.useState(!1),[D,x]=X.useState(0),[M,z]=X.useState(!0),[b,oe]=X.useState({x:-1,y:-1});X.useEffect(()=>{(async()=>{try{const Y=await jF(HP(hm,"canvases",e));if(!Y.exists()){_("Canvas not found");return}const re={id:Y.id,...Y.data()};if(i(re),!re.public&&(!t||t.uid!==re.createdBy)){_("You do not have permission to view this canvas");return}const ve=cm(dm,`canvases/${e}/pixels`);uR(ve,de=>{const be=de.val()||{};o(be),p(!1)})}catch(Y){console.error("Error fetching canvas:",Y),_("Failed to load canvas"),p(!1)}})()},[e,t]),X.useEffect(()=>{if(!r||!U.current)return;const B=U.current.offsetWidth,Y=U.current.offsetHeight,[re,ve]=r.size;A({x:B/2-re*R/2,y:Y/2-ve*R/2})},[r,R,U.current]),X.useEffect(()=>{if(E<=0)return;const B=setTimeout(()=>{S(Y=>Math.max(0,Y-1))},1e3);return()=>clearTimeout(B)},[E]),X.useEffect(()=>{const B=()=>{if(V.current&&U.current&&(V.current.width(U.current.offsetWidth),V.current.height(U.current.offsetHeight),r)){const Y=U.current.offsetWidth,re=U.current.offsetHeight,[ve,de]=r.size;A({x:Y/2-ve*R/2,y:re/2-de*R/2})}};return window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[r,R]);const ye=()=>{k(B=>Math.min(B*1.5,40))},Te=()=>{k(B=>Math.max(B/1.5,1))},Pe=()=>{if(k(4),r&&U.current){const B=U.current.offsetWidth,Y=U.current.offsetHeight,[re,ve]=r.size;A({x:B/2-re*4/2,y:Y/2-ve*4/2})}},J=B=>{B.evt.preventDefault();const Y=1.1,re=V.current,ve=re.getPointerPosition();if(!ve)return;const de={x:(ve.x-re.x())/re.scaleX(),y:(ve.y-re.y())/re.scaleY()},He=(B.evt.deltaY<0?1:-1)>0?Math.min(R*Y,40):Math.max(R/Y,1);k(He);const Bt={x:ve.x-de.x*He,y:ve.y-de.y*He};A(Bt)},ue=B=>{A({x:B.target.x(),y:B.target.y()})},te=()=>{z(B=>!B)},le=B=>{if(!r||!V.current)return;const Y=V.current,re=Y.getPointerPosition();if(!re)return;const ve=Math.floor((re.x-Y.x())/R),de=Math.floor((re.y-Y.y())/R);ve>=0&&ve<r.size[0]&&de>=0&&de<r.size[1]?oe({x:ve,y:de}):oe({x:-1,y:-1})},_e=B=>{const Y=B.evt;if(Y.touches.length===2){Y.preventDefault(),C(!0);const re=Y.touches[0],ve=Y.touches[1],de=Math.sqrt(Math.pow(re.clientX-ve.clientX,2)+Math.pow(re.clientY-ve.clientY,2));if(D===0){x(de);return}const be=V.current,He={x:(re.clientX+ve.clientX)/2,y:(re.clientY+ve.clientY)/2},Bt={x:He.x-be.container().offsetLeft,y:He.y-be.container().offsetTop},Xe={x:(Bt.x-be.x())/be.scaleX(),y:(Bt.y-be.y())/be.scaleY()},mr=1.01,Pn=de>D?Math.min(R*mr,40):Math.max(R/mr,1);k(Pn);const Br={x:Bt.x-Xe.x*Pn,y:Bt.y-Xe.y*Pn};A(Br),x(de)}},Ce=()=>{C(!1),x(0)},Le=B=>{if(!r||!t||E>0||!M)return;const Y=V.current,re=Y.getPointerPosition();if(!re)return;const ve=Math.floor((re.x-Y.x())/R),de=Math.floor((re.y-Y.y())/R);if(ve<0||ve>=r.size[0]||de<0||de>=r.size[1])return;const be=`${ve},${de}`;Xz(cm(dm,`canvases/${e}`),{[`pixels/${be}`]:u,updatedAt:cB()}),S(5),N(Date.now())};return h?K.jsx("div",{className:"reddit-loading h-screen",children:"Loading canvas..."}):m?K.jsxs("div",{className:"reddit-loading h-screen flex flex-col",children:[K.jsx("p",{className:"reddit-error mb-3",children:m}),K.jsx("button",{onClick:()=>n("/"),className:"reddit-btn",children:"Back to Home"})]}):K.jsxs("div",{className:"canvas-page dark-mode",children:[K.jsxs("div",{className:"reddit-canvas-info",children:[K.jsx("h1",{className:"reddit-title text-xl",children:r.name}),K.jsxs("div",{className:"reddit-canvas-data",children:[K.jsxs("p",{children:[r.size[0],"  ",r.size[1]," pixels"]}),t?E>0?K.jsxs("p",{className:"reddit-cooldown",children:["Cooldown: ",E,"s before you can place another pixel"]}):K.jsx("p",{className:"reddit-ready",children:"You can place a pixel now!"}):K.jsxs("p",{className:"text-reddit-muted",children:[K.jsx(xo,{to:"/login",className:"text-reddit-blue hover:underline",children:"Login"})," to place pixels"]})]})]}),K.jsx("div",{ref:U,className:`canvas-area ${M?"draw-cursor":"move-cursor"}`,style:{touchAction:"none"},children:K.jsx(g$,{ref:V,width:((yt=U.current)==null?void 0:yt.offsetWidth)||window.innerWidth,height:((ut=U.current)==null?void 0:ut.offsetHeight)||window.innerHeight-90,onWheel:J,onTap:Le,onClick:Le,draggable:!M||!t,onDragEnd:ue,x:w.x,y:w.y,scale:{x:R,y:R},onTouchMove:_e,onTouchEnd:Ce,onMouseMove:le,children:K.jsxs(p$,{children:[K.jsx(Fp,{x:0,y:0,width:r.size[0],height:r.size[1],fill:"#FFFFFF",stroke:"#343536",strokeWidth:.5/R}),R>8&&Array.from({length:r.size[0]+1}).map((B,Y)=>K.jsx(Fp,{x:Y,y:0,width:.02,height:r.size[1],fill:"#2a2a2b"},`vl-${Y}`)),R>8&&Array.from({length:r.size[1]+1}).map((B,Y)=>K.jsx(Fp,{x:0,y:Y,width:r.size[0],height:.02,fill:"#2a2a2b"},`hl-${Y}`)),Object.entries(s).map(([B,Y])=>{const[re,ve]=B.split(",").map(Number);return K.jsx(Fp,{x:re,y:ve,width:1,height:1,fill:Y},B)})]})})}),b.x>=0&&K.jsxs("div",{className:"pixel-info",children:[K.jsxs("p",{children:["X: ",b.x,", Y: ",b.y]}),K.jsxs("p",{children:["Zoom: ",Math.round(R*100)/100,"x"]}),K.jsx("p",{children:M?"Draw Mode":"Move Mode"})]}),K.jsxs("div",{className:"controls-container",children:[t&&K.jsxs("div",{className:"mb-3",children:[K.jsx("h3",{className:"font-bold mb-2 text-center text-reddit-text",children:"Select a color:"}),K.jsx("div",{className:"color-picker",children:m$.map(B=>K.jsx("div",{className:`color-option ${B===u?"selected":""}`,style:{backgroundColor:B},onClick:()=>c(B),title:B},B))})]}),K.jsxs("div",{className:"flex justify-between items-center",children:[K.jsxs("div",{className:"zoom-controls",children:[K.jsx("button",{onClick:Te,title:"Zoom Out","aria-label":"Zoom Out",children:""}),K.jsx("button",{onClick:Pe,title:"Reset Zoom","aria-label":"Reset Zoom",children:""}),K.jsx("button",{onClick:ye,title:"Zoom In","aria-label":"Zoom In",children:"+"})]}),t&&K.jsx("button",{onClick:te,className:`mode-button ${M?"bg-reddit-orange hover:bg-reddit-orangeHover text-white":"bg-reddit-blue hover:bg-reddit-blueHover text-white"}`,title:M?"Switch to Move Mode":"Switch to Draw Mode",children:M?"Draw Mode":"Move Mode"})]})]}),K.jsxs("div",{className:"reddit-tooltip hidden sm:block",children:[K.jsx("p",{children:"Click to place a pixel"}),K.jsx("p",{children:"Use the mode button to toggle between draw/move"}),K.jsx("p",{children:"Pinch or scroll to zoom"})]})]})},v$=({user:t})=>{const e=Ld(),[n,r]=X.useState(""),[i,s]=X.useState(100),[o,u]=X.useState(100),[c,h]=X.useState(!0),[p,m]=X.useState(!1),[_,E]=X.useState(null),S=async P=>{if(P.preventDefault(),!t){e("/login");return}try{if(m(!0),E(null),n.trim()==="")throw new Error("Canvas name is required");if(i<10||i>1e3)throw new Error("Width must be between 10 and 1000");if(o<10||o>1e3)throw new Error("Height must be between 10 and 1000");const N=await GF(x1(hm,"canvases"),{name:n.trim(),size:[i,o],public:c,createdBy:t.uid,createdAt:qC()});await Yz(cm(dm,`canvases/${N.id}`),{pixels:{},updatedAt:qC()}),e(`/canvas/${N.id}`)}catch(N){console.error("Error creating canvas:",N),E(N.message||"Failed to create canvas"),m(!1)}};return K.jsxs("div",{className:"container mx-auto p-4 max-w-lg dark-mode min-h-screen",children:[K.jsx("h1",{className:"text-2xl font-bold mb-6 reddit-title",children:"Create New Canvas"}),_&&K.jsx("div",{className:"bg-reddit-red/20 border border-reddit-red text-reddit-red px-4 py-3 rounded mb-4",children:_}),K.jsxs("form",{onSubmit:S,className:"reddit-card px-8 pt-6 pb-8 mb-4",children:[K.jsxs("div",{className:"mb-4",children:[K.jsx("label",{className:"block text-reddit-text text-sm font-bold mb-2",htmlFor:"name",children:"Canvas Name"}),K.jsx("input",{id:"name",type:"text",value:n,onChange:P=>r(P.target.value),className:"reddit-input w-full",placeholder:"My Awesome Canvas",required:!0})]}),K.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx("label",{className:"block text-reddit-text text-sm font-bold mb-2",htmlFor:"width",children:"Width (pixels)"}),K.jsx("input",{id:"width",type:"number",value:i,onChange:P=>s(parseInt(P.target.value)),className:"reddit-input w-full",min:"10",max:"1000",required:!0})]}),K.jsxs("div",{children:[K.jsx("label",{className:"block text-reddit-text text-sm font-bold mb-2",htmlFor:"height",children:"Height (pixels)"}),K.jsx("input",{id:"height",type:"number",value:o,onChange:P=>u(parseInt(P.target.value)),className:"reddit-input w-full",min:"10",max:"1000",required:!0})]})]}),K.jsx("div",{className:"mb-6",children:K.jsxs("label",{className:"flex items-center",children:[K.jsx("input",{type:"checkbox",checked:c,onChange:P=>h(P.target.checked),className:"mr-2 accent-reddit-orange"}),K.jsx("span",{className:"text-reddit-text text-sm",children:"Make this canvas public"})]})}),K.jsxs("div",{className:"flex items-center justify-between",children:[K.jsx("button",{type:"button",onClick:()=>e("/"),className:"reddit-btn-outline",children:"Cancel"}),K.jsx("button",{type:"submit",disabled:p,className:"reddit-btn disabled:opacity-50",children:p?"Creating...":"Create Canvas"})]})]}),K.jsxs("div",{className:"mt-4 text-sm text-reddit-muted",children:[K.jsx("h3",{className:"font-bold text-reddit-text",children:"Tips:"}),K.jsxs("ul",{className:"list-disc list-inside mt-2",children:[K.jsx("li",{children:"Smaller canvases (e.g., 100100) are easier to fill with active users"}),K.jsx("li",{children:"Public canvases can be edited by any signed-in user"}),K.jsx("li",{children:"Private canvases can only be edited by you"})]})]})]})},y$=()=>{const[t,e]=X.useState(null),[n,r]=X.useState(!1),i=Ld(),s=async()=>{try{r(!0),e(null),await HO(NE,dB),i("/")}catch(o){console.error("Login error:",o),e("Failed to sign in with Google. Please try again.")}finally{r(!1)}};return K.jsx("div",{className:"flex justify-center items-center min-h-screen dark-mode",children:K.jsxs("div",{className:"reddit-card p-8 rounded-lg shadow-md w-full max-w-md",children:[K.jsx("h1",{className:"text-2xl font-bold text-center mb-6 text-reddit-orange",children:"Welcome to r/Place Clone"}),K.jsx("p",{className:"text-reddit-muted mb-6 text-center",children:"Sign in to create and edit pixel art canvases"}),t&&K.jsx("div",{className:"bg-reddit-red/20 border border-reddit-red text-reddit-red px-4 py-3 rounded mb-4",children:t}),K.jsxs("button",{onClick:s,disabled:n,className:"w-full flex justify-center items-center gap-2 bg-reddit-highlight border border-reddit-border rounded-lg shadow-md px-6 py-3 text-sm font-medium text-reddit-text hover:bg-reddit-border focus:outline-none disabled:opacity-50 transition-colors",children:[K.jsxs("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[K.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),K.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),K.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),K.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),K.jsx("span",{children:n?"Signing in...":"Sign in with Google"})]}),K.jsx("div",{className:"mt-8 text-center",children:K.jsx("button",{onClick:()=>i("/"),className:"text-reddit-blue hover:underline text-sm",children:"Continue as Guest"})}),K.jsx("div",{className:"mt-6 text-center text-xs text-reddit-muted",children:K.jsx("p",{children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})};function w$(){const[t,e]=X.useState(null),[n,r]=X.useState(!0);return X.useEffect(()=>{const i=CO(NE,s=>{e(s),r(!1)});return()=>i()},[]),n?K.jsx("div",{className:"reddit-loading h-screen",children:"Loading..."}):K.jsxs("div",{className:"h-screen max-h-screen overflow-hidden dark-mode",children:[K.jsx(fB,{user:t}),K.jsx("main",{className:"h-[calc(100vh-56px)]",children:K.jsxs(K7,{children:[K.jsx(yh,{path:"/",element:K.jsx(gB,{user:t})}),K.jsx(yh,{path:"/canvas/:id",element:K.jsx(_$,{user:t})}),K.jsx(yh,{path:"/create",element:t?K.jsx(v$,{user:t}):K.jsx(kT,{to:"/login"})}),K.jsx(yh,{path:"/login",element:t?K.jsx(kT,{to:"/"}):K.jsx(y$,{})})]})})]})}uy.createRoot(document.getElementById("root")).render(K.jsx(Ln.StrictMode,{children:K.jsx(tN,{children:K.jsx(w$,{})})}));
